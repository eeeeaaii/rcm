v2:~(|template @Grid (|#<`width`>30 #<`height`>20 (|<`data`>|) &(|<`:init`>~(_let @makerow &(|~(_let @row (||)_) ~(_loop-over &"n"(|~(_let @row ~(_cons #0 @row_)_)|) ~(_range @self.width_)_) @row|)_) ~(_loop-over &"n"(|~(_set @self.data ~(_cons ~(_makerow _) @self.data_)_)|) ~(_range @self.height_)_)|)|)|)v2:~(|package @animation ~(_import @style-functions_) ~(_import @util-functions_) ~(_bind @FPS #20_) ~(_bind @reactivate-nested-animations &"() list()"(|~(|util:traverse-nexes-satisfying-and-do @list &"! item"(|~(_is-expectation @item_)|) &"* item*"(|@item|)|)|)_) ~(_bind @do-on-every &"* f& nex interval#"(|[doc](|[line](_[word](_[letter]"R" [letter]"u" [letter]"n" [letter]"s"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"F"_) [separator]" " [word](_[letter]"f" [letter]"u" [letter]"n" [letter]"c" [letter]"t" [letter]"i" [letter]"o" [letter]"n"_) [separator]" " [word](_[letter]"o" [letter]"n"_) [separator]" " [word](_[letter]"N" [letter]"E" [letter]"X"_) [separator]" " [word](_[letter]"e" [letter]"v" [letter]"e" [letter]"r" [letter]"y"_) [separator]" " [word](_[letter]"I" [letter]"N" [letter]"T" [letter]"E" [letter]"R" [letter]"V" [letter]"A" [letter]"L"_) [separator]" " [word](_[letter]"m" [letter]"i" [letter]"l" [letter]"l" [letter]"i" [letter]"s" [letter]"e" [letter]"c" [letter]"o" [letter]"n" [letter]"d" [letter]"s"_) [separator]"."_)|) ~(_let @exp ~(_cons @nex *(__)_)_) ~(_set-delay ~(_ff-with @exp &" _n"(|~(_reset @exp_) ~(_f @n_)|)_) @interval_)|)_) ~(_bind @do-on-every-with-param &"* f& nex interval#"(|~(_let @p #0_) ~(_let @exp ~(_cons @nex *(__)_)_) ~(_set-delay ~(_ff-with @exp &" _n"(|~(_reset @exp_) ~(_set @p ~(_::pl:: @p #1_)_) ~(_f @nex @p_)|)_) @interval_)|)_) ~(_bind @do-on-every-for &"* f& nex interval# iterations#"(|~(_let @its #0_) ~(_let @exp ~(_cons @nex *(__)_)_) ~(_set-delay ~(_ff-with @exp &" _n"(|~(_set @its ~(_::pl:: @its #1_)_) ~(|if ~(_::lt:: @its @iterations_) ~(_reset @exp_) [nil]|) ~(_f @n_)|)_) @interval_)|)_) ~(_bind @animate-with-for-duration-of &"* nex animatefunc& duration%"(|~(_let @delay-ms ~(_to-integer ~(_::ov:: %1000 @FPS_)_)_) ~(_let @num-frames ~(_::ti:: @duration @FPS_)_) ~(_let @increment ~(_::ov:: %1 @num-frames_)_) ~(_let @val %0_) ~(_do-on-every-for &" n"(|~(_set @val ~(_::pl:: @val @increment_)_) ~(_animatefunc @n @val_)|) @nex @delay-ms ~(_to-integer @num-frames_)_)|)_) ~(_bind @loop &" exp-generator&"(|~(|ff-with ~(_make-expectation ~(_exp-generator _)_) &" n"(|~(_eval ~(_exp-generator _)_)|)|)|)_) ~(_bind @loop2 &" exp*"(|~(_let @gen &(|~(_copy @exp_)|)_) ~(_let @r ~(|ff-with ~(_make-expectation ~(_gen _)_) &" exp"(|~(_reset @r_) ~(_gen _)|)|)_) @r|)_) ~(_bind @osc-pfont &"* nex pfontgen& from% to%"(|~(|do-on-every-with-param &" nex p"(|~(_let @sval ~(_::pl:: ~(_::ov:: ~(_sin ~(_::ov:: ~(_to-float @p_) %10_)_) %2_) %0.5_)_) ~(_let @val ~(_::pl:: ~(_::ti:: ~(_- @to @from_) @sval_) @from_)_) ~(_apply-pfont-to ~(_pfontgen @val_) @nex_)|) @nex #40|)|)_) ~(_bind @fade-in-for-seconds &"* nex duration%"(|~(|animate-with-for-duration-of ~(_style:with-alpha-of @nex %0_) &" nex val"(|~(_style:with-alpha-of @nex @val_)|) @duration|)|)_) ~(_bind @seq &" exps*..."(|~(_let @seq-holder ~(|ff-with ~(_make-expectation [nil]_) &" exp"(|~(|if ~(_is-empty @exps_) @exp ~(|begin ~(_let @r ~(_car @exps_)_) ~(_set @exps ~(_cdr @exps_)_) ~(_reset @seq-holder_) @r|)|)|)|)_) @seq-holder|)_) ~(_bind @fade-out-for-seconds &"* nex duration%"(|~(|animate-with-for-duration-of ~(_style:with-alpha-of @nex %1_) &" nex val"(|~(_style:with-alpha-of @nex ~(_- %1 @val_)_)|) @duration|)|)_) ~(_bind @hold-for-seconds &"* nex duration%"(|~(_set-delay ~(_make-expectation @nex_) ~(_to-integer ~(_::ti:: @duration %1000_)_)_)|)_) ~(_bind @fudge-interval &" interval#"(|~(_to-integer ~(_::ti:: ~(_to-float @interval_) ~(_::pl:: %0.9 ~(_::ti:: %0.2 ~(_random _)_)_)_)_)|)_) ~(_bind @fade-between &"* thing1 thing2 fadetime% holdtime%"(|~(_loop &(_~(|seq ~(_fade-in-for-seconds @thing1 @fadetime_) ~(_hold-for-seconds @thing1 @holdtime_) ~(_fade-out-for-seconds @thing1 @fadetime_) ~(_fade-in-for-seconds @thing2 @fadetime_) ~(_hold-for-seconds @thing2 @holdtime_) ~(_fade-out-for-seconds @thing2 @fadetime_)|)_)_)|)_)|)v2:~(|package @apple ~(|begin ~(_bind @ap [word](_[letter]"h" [letter]"e" [letter]"l" [letter]"l" [letter]"o"_)_)|)|)v2:~(|with-imports @util-functions @style-functions ~(|begin ~(_bind @sing &(|~(_bind @thepoem ~(_util:process @poemsrc_)_) @thepoem|)_) ~(_bind @poemsrc [doc](|[line](_[word](_[letter]"L" [letter]"i" [letter]"g" [letter]"h" [letter]"t" [letter]"s"_) [separator]"," [separator]" " [word](_[letter]"d" [letter]"r" [letter]"u" [letter]"g" [letter]"s"_) ~(_comma _) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"c" [letter]"a" [letter]"r"_) [separator]"." [separator]" " [word](_[letter]"B" [letter]"l" [letter]"o" [letter]"o" [letter]"d"_) [separator]"," [separator]" " [word](_[letter]"s" [letter]"p" [letter]"e" [letter]"e" [letter]"d"_) ~(_comma _) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"r" [letter]"a" [letter]"n" [letter]"g" [letter]"e" [letter]"r" [letter]"s"_) [separator]"." [separator]" " [word](_[letter]"I" [letter]"m" [letter]"a" [letter]"g" [letter]"i" [letter]"n" [letter]"e" [letter]"d"_) [separator]" " [word](_[letter]"s" [letter]"e" [letter]"x"_) [separator]"," [separator]" " [word](_[letter]"r" [letter]"e" [letter]"a" [letter]"l"_) [separator]" " [word](_[letter]"s" [letter]"h" [letter]"i" [letter]"t"_) ~(_comma _) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"B" [letter]"a" [letter]"l" [letter]"z" [letter]"a" [letter]"c"_) [separator]"." [separator]" " [word](_[letter]"R" [letter]"a" [letter]"n" [letter]"c" [letter]"h"_) [separator]" " [word](_[letter]"d" [letter]"r" [letter]"e" [letter]"s" [letter]"s" [letter]"i" [letter]"n" [letter]"g"_) [separator]"," [separator]" " [word](_[letter]"g" [letter]"r" [letter]"u" [letter]"n" [letter]"g" [letter]"e"_) [separator]" " [word](_[letter]"m" [letter]"u" [letter]"s" [letter]"i" [letter]"c"_) ~(_comma _) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"g" [letter]"o" [letter]"o" [letter]"d" [letter]"b" [letter]"y" [letter]"e"_) [separator]"." [separator]" " [word](_[letter]"M" [letter]"i" [letter]"s" [letter]"s" [letter]"e" [letter]"d"_) [separator]" " [word](_[letter]"o" [letter]"p" [letter]"p" [letter]"o" [letter]"r" [letter]"t" [letter]"u" [letter]"n" [letter]"i" [letter]"t" [letter]"i" [letter]"e" [letter]"s"_) [separator]"," [separator]" " [word](_[letter]"C"_) [separator]"+" [separator]"+" ~(_comma _) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"p" [letter]"a" [letter]"r" [letter]"t" [letter]"y"_) [separator]" " [word](_[letter]"w" [letter]"h" [letter]"e" [letter]"r" [letter]"e"_) [separator]" " [word](_[letter]"I"_) [separator]" " [word](_[letter]"d" [letter]"i" [letter]"d" [letter]"n" [letter]"'" [letter]"t"_) [separator]" " [word](_[letter]"k" [letter]"n" [letter]"o" [letter]"w"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"y" [letter]"o" [letter]"n" [letter]"e"_) [separator]"." [separator]" " [word](_[letter]"A"_) [separator]" " [word](_[letter]"s" [letter]"h" [letter]"i" [letter]"t" [letter]"t" [letter]"y"_) [separator]" " [word](_[letter]"j" [letter]"o" [letter]"b"_) [separator]"," [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"p" [letter]"a" [letter]"r" [letter]"k" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"g" [letter]"a" [letter]"r" [letter]"a" [letter]"g" [letter]"e"_) ~(_comma _) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"a" [letter]"n"_) [separator]" " [word](_[letter]"a" [letter]"w" [letter]"k" [letter]"w" [letter]"a" [letter]"r" [letter]"d"_) [separator]" " [word](_[letter]"v" [letter]"i" [letter]"s" [letter]"i" [letter]"t"_) [separator]" " [word](_[letter]"t" [letter]"o"_) [separator]" " [word](_[letter]"m" [letter]"y"_) [separator]" " [word](_[letter]"p" [letter]"a" [letter]"r" [letter]"e" [letter]"n" [letter]"t" [letter]"s"_) [separator]"." [separator]" " [word](_[letter]"V" [letter]"o" [letter]"l" [letter]"l" [letter]"e" [letter]"y" [letter]"b" [letter]"a" [letter]"l" [letter]"l"_) [separator]"," [separator]" " [word](_[letter]"s" [letter]"e" [letter]"x"_) [separator]" " [word](_[letter]"a" [letter]"t"_) [separator]" " [word](_[letter]"m" [letter]"y"_) [separator]" " [word](_[letter]"m" [letter]"o" [letter]"m" [letter]"'" [letter]"s"_) [separator]" " [word](_[letter]"h" [letter]"o" [letter]"u" [letter]"s" [letter]"e"_) ~(_comma _) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"m" [letter]"y"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"u" [letter]"f" [letter]"f"_) [separator]" " [word](_[letter]"l" [letter]"e" [letter]"f" [letter]"t"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"d" [letter]"r" [letter]"i" [letter]"v" [letter]"e" [letter]"w" [letter]"a" [letter]"y"_) [separator]"." [separator]" " [word](_[letter]"B" [letter]"e" [letter]"r" [letter]"k" [letter]"e" [letter]"l" [letter]"e" [letter]"y"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"O" [letter]"a" [letter]"k" [letter]"l" [letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"h" [letter]"i" [letter]"l" [letter]"l" [letter]"s"_) [separator]"," [separator]" " [word](_[letter]"l" [letter]"o" [letter]"n" [letter]"e" [letter]"l" [letter]"i" [letter]"n" [letter]"e" [letter]"s" [letter]"s"_) ~(_comma _) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"w" [letter]"a" [letter]"l" [letter]"k"_) [separator]" " [word](_[letter]"o" [letter]"n"_) [separator]" " [word](_[letter]"s" [letter]"h" [letter]"a" [letter]"r" [letter]"p"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"o" [letter]"n" [letter]"e" [letter]"s"_) [separator]" " [word](_[letter]"b" [letter]"y"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"i" [letter]"n" [letter]"d" [letter]"u" [letter]"s" [letter]"t" [letter]"r" [letter]"i" [letter]"a" [letter]"l"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"a" [letter]"c" [letter]"h"_) [separator]"." [separator]" " [word](_[letter]"A"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"o" [letter]"l" [letter]"e" [letter]"n"_) [separator]" " [word](_[letter]"b" [letter]"i" [letter]"k" [letter]"e"_) [separator]"," [separator]" " [word](_[letter]"t" [letter]"e" [letter]"c" [letter]"h" [letter]"n" [letter]"o"_) [separator]" " [word](_[letter]"m" [letter]"u" [letter]"s" [letter]"i" [letter]"c"_) ~(_comma _) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"o" [letter]"r" [letter]"i" [letter]"e" [letter]"s"_) [separator]" " [word](_[letter]"f" [letter]"r" [letter]"o" [letter]"m"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"c" [letter]"a" [letter]"r"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"e" [letter]"f"_) [separator]"." [separator]" " [word](_[letter]"M" [letter]"a" [letter]"t" [letter]"h"_) [separator]"," [separator]" " [word](_[letter]"m" [letter]"e" [letter]"n"_) ~(_comma _) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"m" [letter]"e" [letter]"s" [letter]"s" [letter]"i" [letter]"n" [letter]"e" [letter]"s" [letter]"s"_) [separator]"." [separator]" " [word](_[letter]"S" [letter]"c" [letter]"r" [letter]"e" [letter]"a" [letter]"m" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"l" [letter]"a" [letter]"n" [letter]"d" [letter]"l" [letter]"a" [letter]"n" [letter]"d" [letter]"i" [letter]"e" [letter]"s"_) [separator]"," [separator]" " [word](_[letter]"t" [letter]"h" [letter]"a" [letter]"n" [letter]"k" [letter]"s" [letter]"g" [letter]"i" [letter]"v" [letter]"i" [letter]"n" [letter]"g"_) ~(_comma _) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"g" [letter]"u" [letter]"i" [letter]"t" [letter]"a" [letter]"r"_) [separator]"." [separator]" " [word](_[letter]"T" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"p" [letter]"r" [letter]"o" [letter]"m" [letter]"i" [letter]"s" [letter]"e"_) [separator]" " [word](_[letter]"o" [letter]"f"_) [separator]" " [word](_[letter]"g" [letter]"o" [letter]"a" [letter]"t" [letter]"s"_) [separator]"," [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"M" [letter]"a" [letter]"r" [letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"a" [letter]"d" [letter]"l" [letter]"a" [letter]"n" [letter]"d" [letter]"s"_) ~(_comma _) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"s" [letter]"a" [letter]"n" [letter]"d" [letter]"w" [letter]"i" [letter]"c" [letter]"h" [letter]"e" [letter]"s"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"t" [letter]"r" [letter]"u" [letter]"n" [letter]"k"_) [separator]"." [separator]" " [word](_[letter]"L" [letter]"o" [letter]"c" [letter]"k" [letter]"e" [letter]"d"_) [separator]" " [word](_[letter]"o" [letter]"u" [letter]"t"_) [separator]"," [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"c" [letter]"o" [letter]"f" [letter]"f" [letter]"e" [letter]"e"_) [separator]" " [word](_[letter]"s" [letter]"h" [letter]"o" [letter]"p"_) ~(_comma _) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"d" [letter]"e" [letter]"w"_) [separator]"." [separator]" " [word](_[letter]"A"_) [separator]" " [word](_[letter]"c" [letter]"o" [letter]"n" [letter]"f" [letter]"e" [letter]"r" [letter]"e" [letter]"n" [letter]"c" [letter]"e"_) [separator]"," [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"c" [letter]"r" [letter]"a" [letter]"n" [letter]"e"_) [separator]" " [word](_[letter]"t" [letter]"r" [letter]"a" [letter]"n" [letter]"s" [letter]"p" [letter]"o" [letter]"r" [letter]"t" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"p" [letter]"o" [letter]"r" [letter]"t" [letter]"a" [letter]"j" [letter]"o" [letter]"h" [letter]"n"_) ~(_comma _) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"s" [letter]"e" [letter]"c" [letter]"u" [letter]"r" [letter]"i" [letter]"t" [letter]"y"_) [separator]" " [word](_[letter]"g" [letter]"u" [letter]"a" [letter]"r" [letter]"d"_) [separator]" " [word](_[letter]"w" [letter]"h" [letter]"o"_) [separator]" " [word](_[letter]"t" [letter]"o" [letter]"o" [letter]"k"_) [separator]" " [word](_[letter]"m" [letter]"y"_) [separator]" " [word](_[letter]"l" [letter]"u" [letter]"n" [letter]"c" [letter]"h"_) [separator]"." [separator]" " [word](_[letter]"A"_) [separator]" " [word](_[letter]"v" [letter]"i" [letter]"s" [letter]"i" [letter]"t"_) [separator]" " [word](_[letter]"d" [letter]"u" [letter]"r" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"w" [letter]"h" [letter]"i" [letter]"c" [letter]"h"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"p" [letter]"l" [letter]"a" [letter]"c" [letter]"e"_) [separator]" " [word](_[letter]"f" [letter]"e" [letter]"l" [letter]"t"_) [separator]" " [word](_[letter]"a" [letter]"l" [letter]"i" [letter]"v" [letter]"e"_) [separator]"," [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"v" [letter]"i" [letter]"s" [letter]"i" [letter]"t"_) [separator]" " [word](_[letter]"d" [letter]"u" [letter]"r" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"w" [letter]"h" [letter]"i" [letter]"c" [letter]"h"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"p" [letter]"l" [letter]"a" [letter]"c" [letter]"e"_) [separator]" " [word](_[letter]"f" [letter]"e" [letter]"l" [letter]"t"_) [separator]" " [word](_[letter]"d" [letter]"e" [letter]"a" [letter]"d"_) ~(_comma _) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"v" [letter]"i" [letter]"s" [letter]"i" [letter]"t"_) [separator]" " [word](_[letter]"d" [letter]"u" [letter]"r" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"w" [letter]"h" [letter]"i" [letter]"c" [letter]"h"_) [separator]" " [word](_[letter]"I"_) [separator]" " [word](_[letter]"f" [letter]"o" [letter]"u" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"o" [letter]"u" [letter]"t"_) [separator]" " [word](_[letter]"I"_) [separator]" " [word](_[letter]"w" [letter]"a" [letter]"s"_) [separator]" " [word](_[letter]"a" [letter]"b" [letter]"o" [letter]"u" [letter]"t"_) [separator]" " [word](_[letter]"t" [letter]"o"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"c" [letter]"o" [letter]"m" [letter]"e"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"f" [letter]"a" [letter]"t" [letter]"h" [letter]"e" [letter]"r"_) [separator]"." [separator]" " [separator]" " [separator]" " [separator]" " [separator]" "_)|)_) ~(_bind @thecomma [word](_[separator]","_)_) ~(_bind @comma &(|@thecomma|)_) ~(_bind @oxford &(|~(_cram [separator]"," @thecomma_)|)_) ~(_bind @nooxford &(|~(_chop @thecomma_)|)_) ~(_bind @switch &(|~(|if ~(_is-empty @thecomma_) ~(_oxford _) ~(_nooxford _)|)|)_) ~(_bind @drawbutton &(|~(_let @exp ~(|set-click ~(|make-expectation ~(|style:with-padding-of ~(|style:with-background-color-of ~(_style:with-text-in-size [letter]"S" #20_) $"#dddddd"|) #10|)|)|)_) ~(|ff-with @exp &" n"(|~(_switch _) ~(_force-draw @thepoem_) ~(_reset @exp_) @n|)|)|)_)|)|)v2:~(|with-imports @math-functions @util-functions @animation-functions ~(|begin ~(_bind @talk ~(_copy [doc](|[line](_[word](_[letter]"Y" [letter]"o" [letter]"u"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"e" [letter]"a" [letter]"l"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"m" [letter]"o" [letter]"m" [letter]"e" [letter]"n" [letter]"t"_) [separator]" " [word](_[letter]"w" [letter]"h" [letter]"e" [letter]"n"_) [separator]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [separator]" " [word](_[letter]"c" [letter]"a" [letter]"n"_) [separator]","_) [line](_[word](_[letter]"p" [letter]"a" [letter]"r" [letter]"k"_) [separator]" " [word](_[letter]"i" [letter]"t"_) [separator]" " [word](_[letter]"l" [letter]"i" [letter]"k" [letter]"e"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"m" [letter]"o" [letter]"t" [letter]"o" [letter]"r" [letter]"c" [letter]"y" [letter]"c" [letter]"l" [letter]"e"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"t" [letter]"w" [letter]"e" [letter]"e" [letter]"n"_) [separator]" " [word](_[letter]"c" [letter]"a" [letter]"r" [letter]"s"_) [separator]","_) [line](_[word](_[letter]"a"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"o" [letter]"k" [letter]"m" [letter]"a" [letter]"r" [letter]"k"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"t" [letter]"w" [letter]"e" [letter]"e" [letter]"n"_) [separator]" " [word](_[letter]"p" [letter]"a" [letter]"g" [letter]"e" [letter]"s"_) [separator]","_) [line](_[word](_[letter]"a"_) [separator]" " [word](_[letter]"h" [letter]"a" [letter]"l" [letter]"f"_) [separator]" " [word](_[letter]"h" [letter]"o" [letter]"u" [letter]"r"_) [separator]" " [word](_[letter]"t" [letter]"o"_) [separator]" " [word](_[letter]"b" [letter]"e"_) [separator]" " [word](_[letter]"a" [letter]"l" [letter]"i" [letter]"v" [letter]"e"_) [separator]"," [separator]" " [word](_[letter]"o" [letter]"r" [letter]"g" [letter]"a" [letter]"n" [letter]"i" [letter]"c"_) [separator]","_) [line](_[word](_[letter]"f" [letter]"a" [letter]"u" [letter]"l" [letter]"t" [letter]"y"_) [separator]"." [separator]" " [word](_[letter]"A"_) [separator]" " [word](_[letter]"m" [letter]"o" [letter]"m" [letter]"e" [letter]"n" [letter]"t"_) [separator]" " [word](_[letter]"t" [letter]"o"_) [separator]" " [word](_[letter]"b" [letter]"e"_) [separator]" " [word](_[letter]"l" [letter]"e" [letter]"d"_) [separator]" " [word](_[letter]"b" [letter]"y"_) [separator]" " [word](_[letter]"o" [letter]"t" [letter]"h" [letter]"e" [letter]"r" [letter]"s"_) [separator]","_) [line](_[word](_[letter]"t" [letter]"o"_) [separator]" " [word](_[letter]"b" [letter]"e"_) [separator]" " [word](_[letter]"t" [letter]"r" [letter]"u" [letter]"s" [letter]"t" [letter]"i" [letter]"n" [letter]"g"_) [separator]"," [separator]" " [word](_[letter]"t" [letter]"o"_) [separator]" " [word](_[letter]"b" [letter]"e"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"c" [letter]"h" [letter]"i" [letter]"l" [letter]"d"_) [separator]"."_)|)_)_) ~(_bind @talk2 [doc](|[line](_[letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a"_)|)_) ~(_bind @set-params-from-vector &" letter v"(|~(_let @x @<`x`>v_) ~(_let @y @<`y`>v_) ~(_let @z @<`z`>v_) ~(_apply-pfont-to ~(|string-cat $"basic##corpus:" ~(_to-string ~(_::pl:: %0.3 ~(_::ti:: @x %0.01_)_)_) $",asc:" ~(_to-string ~(_::pl:: %0.6 ~(_::ti:: @y %0.08_)_)_) $",curve:" ~(_to-string ~(_::pl:: %0.0 ~(_::ti:: @z %0.008_)_)_)|) @letter_)|)_) ~(_bind @init-vlist &(|~(_bind @vlist ~(|map-with ~(_range @flatlength_) &" n"(|~(_make-org @n ~(_instantiate [nil]<`Vector3d`> %1 %1 %20_)_)|)|)_)|)_) ~(_bind @nextvec &" oldvec"(|~(_let @r ~(_range #15_)_) ~(_reduce-with-starting @r &" ignore v"(|~(_lorenz @v %0.0024_)|) @oldvec_)|)_) ~(_bind @step &" newvect"(|~(_set @vlist ~(_map-with @vlist &" elt"(|~(_make-org ~(_::pl:: ~(_first @elt_) #1_) ~(_first ~(_rest @elt_)_)_)|)_)_) ~(_set @vlist ~(_filter-with @vlist &" elt"(|~(_::lt:: ~(_car @elt_) @flatlength_)|)_)_) ~(_let @prev ~(_first ~(_rest ~(_first @vlist_)_)_)_) ~(_cram ~(_make-org #0 @newvect_) @vlist_)|)_) ~(_bind @main &(|~(_bind @flat ~(_util:flatten @talk_)_) ~(_bind @flatlength ~(_util:length-of @flat_)_) ~(_init-vlist _) ~(|animation:do-on-every &" vect"(|~(_let @newvect ~(_nextvec @vect_)_) ~(_step @newvect_) ~(_map-with @vlist &" entry"(|~(_let @n ~(_first @entry_)_) ~(_let @v ~(_first ~(_rest @entry_)_)_) ~(_let @letter ~(_util:nth-from @n @flat_)_) ~(_set-params-from-vector @letter @v_)|)_) ~(_force-draw @talk_) @newvect|) ~(_instantiate [nil]<`Vector3d`> %1 %1 %20_) #1|)|)_) ~(_bind @c ~(_instantiate [nil]<`Canvas`> #400 #400_)_) ~(_bind @testcurve &(|~(|animation:do-on-every &" nex"(|~(_let @v @nex_) ~(_let @lastx @<`x`>v_) ~(_let @lasty @<`y`>v_) ~(|do-n-times &(|~(_set @v ~(_lorenz @v %0.001_)_)|) #40|) ~(|@<`line`>c (|#10 #0 #0 #0|) ~(_::pl:: #200 ~(_to-integer ~(_::ti:: %10 @lastx_)_)_) ~(_::pl:: #200 ~(_to-integer ~(_::ti:: %10 @lasty_)_)_) ~(_::pl:: #200 ~(_to-integer ~(_::ti:: %10 @<`x`>v_)_)_) ~(_::pl:: #200 ~(_to-integer ~(_::ti:: %10 @<`y`>v_)_)_)|) @v|) ~(_instantiate [nil]<`Vector3d`> %1 %1 %20_) #1|)|)_)|)|)v2:~(|begin ~(_import @style-functions_) ~(_bind @makeletter &" lt value"(|~(_bind @container ~(_style:with-width-of ~(_style:with-height-of [word](__) #10_) #10_)_) ~(_let @val ~(_to-integer ~(_::ti:: %30 ~(_::ov:: ~(_to-float @value_) %255_)_)_)_) ~(_cons ~(_style:with-text-in-size @lt @val_) @container_)|)_) ~(_bind @makeletter &" lt value"(|@lt|)_) ~(_bind @color-to-letter &" color"(|~(_let @r ~(_first @color_)_) ~(_let @g ~(_first ~(_rest @color_)_)_) ~(_let @b ~(_first ~(_rest ~(_rest @color_)_)_)_) ~(|case ~(_if ~(_and ~(_::gt:: @r @g_) ~(_::gt:: @r @b_)_) ~(_makeletter [letter]"r" @r_)_) ~(_if ~(_and ~(_::gt:: @g @r_) ~(_::gt:: @g @b_)_) ~(_makeletter [letter]"g" @g_)_) ~(_if ~(_and ~(_::gt:: @b @r_) ~(_::gt:: @b @g_)_) ~(_makeletter [letter]"b" @b_)_) ~(_if ~(_and ~(_::eq:: @r @g_) ~(_::eq:: @r @b_)_) ~(_makeletter [letter]"x" @r_)_) ~(_if ~(_::eq:: @r @g_) ~(_makeletter [letter]"y" @r_)_) ~(_if ~(_::eq:: @r @b_) ~(_makeletter [letter]"m" @r_)_) ~(_if ~(_::eq:: @g @b_) ~(_makeletter [letter]"c" @g_)_)|)|)_) ~(_bind @cc5 &(|~(_setup _) ~(_canvas-grab _) ~(_drawletters _)|)_) ~(_bind @canvas-grab &(|~(_@<`copy-from-clipboard`>c_)|)_) ~(_bind @setup &(|~(_bind @c ~(_instantiate [nil]<`Canvas`> #50 #50_)_)|)_) ~(_bind @drawletters &(|~(_let @result [doc](||)_) ~(|loop-over &" i"(|~(_let @currentlist [line](__)_) ~(|loop-over &" j"(|~(_cram ~(_color-to-letter ~(_@<`color-at`>c @i @j_)_) @currentlist_)|) ~(_range #0 #50_)|) ~(_cram @currentlist @result_)|) ~(_range #0 #50_)|) @result|)_)|)v2:~(|with-imports @math-functions @util-functions @animation-functions ~(|begin ~(_bind @talk ~(_copy [doc](|[line](_[word](_[letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"a" [letter]"a" [letter]"a"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"a" [letter]"a"_) [separator]" " [word](_[letter]"a" [letter]"a"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"a" [letter]"a"_)_) [line](_[separator]" " [word](_[letter]"a" [letter]"a" [letter]"a"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"a" [letter]"a"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"a" [letter]"a"_)_) [line](_[word](_[letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a" [letter]"a"_)_)|)_)_) ~(_bind @set-params-from-vector &" letter v"(|~(_let @x @<`x`>v_) ~(_let @y @<`y`>v_) ~(_let @z @<`z`>v_) ~(_apply-pfont-to ~(|string-cat $"basic##corpus:" ~(_to-string ~(_::pl:: %0.3 ~(_::ti:: @x %0.01_)_)_) $",asc:" ~(_to-string ~(_::pl:: %0.6 ~(_::ti:: @y %0.08_)_)_) $",curve:" ~(_to-string ~(_::pl:: %0.0 ~(_::ti:: @z %0.008_)_)_)|) @letter_)|)_) ~(_bind @init-vlist &(|~(_bind @vlist ~(|map-with ~(_range @flatlength_) &" n"(|~(_make-org @n ~(_instantiate [nil]<`Vector3d`> %1 %1 %20_)_)|)|)_)|)_) ~(_bind @nextvec &" oldvec"(|~(_let @v @oldvec_) ~(|do-n-times &(|~(_set @v ~(_lorenz @v %0.0024_)_)|) #15|) @v|)_) ~(_bind @step &" newvect"(|~(_set @vlist ~(_map-with @vlist &" elt"(|~(_make-org ~(_::pl:: ~(_first @elt_) #1_) ~(_first ~(_rest @elt_)_)_)|)_)_) ~(_set @vlist ~(_filter-with @vlist &" elt"(|~(_::lt:: ~(_car @elt_) @flatlength_)|)_)_) ~(_let @prev ~(_first ~(_rest ~(_first @vlist_)_)_)_) ~(_cram ~(_make-org #0 @newvect_) @vlist_)|)_) ~(_bind @main &(|~(_bind @flat ~(_util:flatten @talk_)_) ~(_bind @flatlength ~(_util:length-of @flat_)_) ~(_init-vlist _) ~(|animation:do-on-every &" vect"(|~(_let @newvect ~(_nextvec @vect_)_) ~(_step @newvect_) ~(_map-with @vlist &" entry"(|~(_let @n ~(_first @entry_)_) ~(_let @v ~(_first ~(_rest @entry_)_)_) ~(_let @letter ~(_util:nth-from @n @flat_)_) ~(_set-params-from-vector @letter @v_)|)_) ~(_force-draw @talk_) @newvect|) ~(_instantiate [nil]<`Vector3d`> %1 %1 %20_) #1|)|)_) ~(_bind @c ~(_instantiate [nil]<`Canvas`> #400 #400_)_) ~(_bind @do-n-times &" f& n"(|~(|if ~(_::eq:: @n #0_) [nil] ~(|begin ~(_f _) ~(_do-n-times @f ~(_- @n #1_)_)|)|)|)_) ~(_bind @testcurve &(|~(|animation:do-on-every &" nex"(|~(_let @v @nex_) ~(_let @lastx @<`x`>v_) ~(_let @lasty @<`y`>v_) ~(|do-n-times &(|~(_set @v ~(_lorenz @v %0.001_)_)|) #40|) ~(|@<`line`>c (|#10 #0 #0 #0|) ~(_::pl:: #200 ~(_to-integer ~(_::ti:: %10 @lastx_)_)_) ~(_::pl:: #200 ~(_to-integer ~(_::ti:: %10 @lasty_)_)_) ~(_::pl:: #200 ~(_to-integer ~(_::ti:: %10 @<`x`>v_)_)_) ~(_::pl:: #200 ~(_to-integer ~(_::ti:: %10 @<`y`>v_)_)_)|) @v|) ~(_instantiate [nil]<`Vector3d`> %1 %1 %20_) #1|)|)_)|)|)v2:~(|begin ~(_bind @square-size #20_) ~(_bind @num-rows #20_) ~(_bind @num-cols #20_) ~(_bind @random-color &(|~(|string-cat $"#" ~(_print-in-hex ~(_to-integer ~(_::ti:: %256 ~(_random _)_)_)_) ~(_print-in-hex ~(_to-integer ~(_::ti:: %256 ~(_random _)_)_)_) ~(_print-in-hex ~(_to-integer ~(_::ti:: %256 ~(_random _)_)_)_)|)|)_) ~(_bind @make-square &(|~(|background-color ~(_height ~(_width [word](__) @square-size_) @square-size_) ~(_random-color _)|)|)_) ~(_bind @make-row &(|~(_let @make-row-n &" n"(|~(|if ~(_::eq:: @n #0_) [line](__) ~(_cons ~(_make-square _) ~(_make-row-n ~(_- @n #1_)_)_)|)|)_) ~(_make-row-n @num-cols_)|)_) ~(_bind @make-checkerboard &(|~(_let @make-cb-n &" n"(|~(|if ~(_::eq:: @n #0_) [doc](||) ~(_cons ~(_make-row _) ~(_make-cb-n ~(_- @n #1_)_)_)|)|)_) ~(_make-cb-n @num-rows_)|)_)|)v2:~(|package @color ~(_import @math-functions_) ~(_bind @random-color-in-hsv-ranges &" huestart#% hueend#% satstart#% satend#% valstart#% valend#%"(|~(|string-cat $"hsl(" ~(_to-string ~(_::ti:: %360 ~(_random-from-to @huestart @hueend_)_)_) $"," ~(_to-string ~(_::ti:: %100 ~(_random-from-to @satstart @satend_)_)_) $"%," ~(_to-string ~(_::ti:: %100 ~(_random-from-to @valstart @valend_)_)_) $"%)"|)|)_) ~(_bind @random-color &(|~(|string-cat $"rgb(" ~(_to-string ~(_random-from-to #0 #255_)_) $"," ~(_to-string ~(_random-from-to #0 #255_)_) $"," ~(_to-string ~(_random-from-to #0 #255_)_) $")"|)|)_)|)v2:~(|package @emojigame ~(_import @style-functions_) ~(_bind @makecell &(_~(_style:with-height-of ~(_style:with-width-of ~(_make-word _) #12_) #12_)_)_) ~(_bind @makerow &(|~(_let @row ~(_make-org _)_) ~(|loop-over &" n"(|~(_cram ~(_makecell _) @row_)|) ~(_range #20_)|)|)_) ~(_bind @makegrid &(|~(_let @grid ~(_make-org _)_) ~(|loop-over &" n"(|~(_cram ~(_makerow _) @grid_)|) ~(_range #20_)|)|)_) [doc](|[line](_[word](_[letter]"n" [letter]"e" [letter]"e" [letter]"d"_) [separator]" " [word](_[letter]"t" [letter]"o"_) [separator]" " [word](_[letter]"f" [letter]"i" [letter]"x"_) [separator]" " [word](_[letter]"b" [letter]"u" [letter]"g"_) [separator]" " [separator]"#" [word](_[letter]"1" [letter]"1" [letter]"8"_)_)|)|)v2:~(|package @foobar ~(|begin ~(_bind @a [word](_[letter]"a" [letter]"p" [letter]"p" [letter]"l" [letter]"e"_)_)|)|)v2:~(|package @fx ~(_import @layout-functions_) ~(_import @style-functions_) ~(_import @animation-functions_) ~(_bind @split-horiz-four-times &" base split-amount#"(|~(_let @pct-string &" n%"(|~(_to-string ~(_to-integer ~(_::ti:: %100 @n_)_)_)|)_) ~(_let @get-letter-part &" top1% top2% bottom1% bottom2%"(|~(|style:with-style-set-to @base $"clip-path" ~(|string-cat $"polygon(" ~(_pct-string @top1_) $"% 0%, " ~(_pct-string @top2_) $"% 0%, " ~(_pct-string @bottom2_) $"% 100%, " ~(_pct-string @bottom1_) $"% 100%)"|)|)|)_) ~(_let @shift-right-by &" nex amt#"(|~(|style:with-style-set-to ~(|style:with-style-set-to @nex $"position" $"relative"|) $"left" ~(_string-cat ~(_to-string @amt_) $"px"_)|)|)_) ~(|cons ~(_get-letter-part %0 %0.25 %0 %0.25_) ~(|cons ~(|shift-right-by ~(_get-letter-part %0.25 %0.5 %0.25 %0.5_) @split-amount|) ~(|cons ~(|shift-right-by ~(_get-letter-part %0.5 %0.75 %0.5 %0.75_) ~(_::ti:: #2 @split-amount_)|) ~(|cons ~(|shift-right-by ~(_get-letter-part %0.75 %1 %0.75 %1_) ~(_::ti:: #3 @split-amount_)|) ~(_make-zlist _)|)|)|)|)|)_) ~(_bind @split-letter-vert &" base-letter split-distance#"(|~(_let @left-point ~(_to-integer ~(_::ti:: %100 ~(_random _)_)_)_) ~(_let @right-point ~(_to-integer ~(_::ti:: %100 ~(_random _)_)_)_) ~(_let @placeholder-letter ~(|style:with-hidden ~(_style:with-top-padding-of @base-letter @split-distance_)|)_) ~(_let @top-letter ~(|style:with-style-set-to @base-letter $"clip-path" ~(_string-cat $"polygon(0% 0%, 100% 0%, 100% " ~(_to-string @right-point_) $"%, 0% " ~(_to-string @left-point_) $"%, 0% 0%)"_)|)_) ~(_let @bottom-letter ~(|style:with-style-set-to ~(|style:with-style-set-to ~(|style:with-style-set-to @base-letter $"clip-path" ~(_string-cat $"polygon(0% 100%, 0% " ~(_to-string @left-point_) $"%, 100% " ~(_to-string @right-point_) $"%, 100% 100%)"_)|) $"position" $"relative"|) $"top" ~(_string-cat ~(_to-string @split-distance_) $"px"_)|)_) ~(_cons @top-letter ~(_cons @bottom-letter ~(_cons @placeholder-letter ~(_make-zlist _)_)_)_)|)_) ~(_bind @split-letter-horiz &" base-letter split-distance#"(|~(_let @top-point ~(_to-integer ~(_::ti:: %100 ~(_random _)_)_)_) ~(_let @bottom-point ~(_to-integer ~(_::ti:: %100 ~(_random _)_)_)_) ~(_let @placeholder-letter ~(|style:with-hidden ~(_style:with-left-padding-of @base-letter @split-distance_)|)_) ~(_let @left-letter ~(|style:with-style-set-to @base-letter $"clip-path" ~(_string-cat $"polygon(0% 0%, " ~(_to-string @top-point_) $"% 0%, " ~(_to-string @bottom-point_) $"% 100%, 0% 100%)"_)|)_) ~(_let @right-letter ~(|style:with-style-set-to ~(|style:with-style-set-to ~(|style:with-style-set-to @base-letter $"clip-path" ~(_string-cat $"polygon(" ~(_to-string @top-point_) $"% 0%, 100% 0%, 100% 100%, " ~(_to-string @bottom-point_) $"% 100%)"_)|) $"position" $"relative"|) $"left" ~(_string-cat ~(_to-string @split-distance_) $"px"_)|)_) ~(_cons @left-letter ~(_cons @right-letter ~(_cons @placeholder-letter ~(_make-zlist _)_)_)_)|)_) ~(_bind @theads &" doc"(|~(|layout:justify-doc-to-width-in-format @doc #790 &" line"(|~(_style:with-light-weight ~(_style:with-font ~(_style:uppercased @line_) $"Helvetica"_)_)|)|)|)_) ~(_bind @flippyletters &" doc"(|~(|layout:do-for-each-letter-or-separator-in &" letter"(|~(|animation:do-on-every &" previous"(|~(|style:with-background-color-of ~(|style:with-text-in-color @letter ~(_animation:random-color-in-hsv-ranges %0.0 %1 %0.75 %1 %0.6 %1_)|) ~(_animation:random-color-in-hsv-ranges %0.0 %1 %0.75 %1 %0.0 %0.4_)|)|) @letter ~(_animation:fudge-interval #100_)|)|) ~(_theads @doc_)|)|)_) ~(_bind @dutchdoors &" doc"(|~(|layout:do-for-each-letter-or-separator-in &" letter"(|~(_let @w ~(_get-pixel-width @letter_)_) ~(_let @h ~(_get-pixel-height @letter_)_) ~(_let @color1 ~(_animation:random-color _)_) ~(_let @color2 ~(_animation:random-color _)_) ~(_let @color3 ~(_animation:random-color _)_) ~(_let @color4 ~(_animation:random-color _)_) ~(_let @pct ~(_random _)_) ~(_let @backletter ~(|style:with-background-color-of ~(_style:with-text-in-color @letter @color1_) @color2|)_) ~(_let @frontletter ~(_style:with-clip-percent ~(|style:with-background-color-of ~(_style:with-text-in-color @letter @color3_) @color4|) @pct %0.0 %0.0 %0.0_)_) ~(_cons @backletter ~(_cons @frontletter ~(_style:with-height-of ~(_style:with-width-of ~(_make-zlist _) @w_) @h_)_)_)|) @doc|)|)_)|)v2:~(|begin ~(_import @style-functions_) ~(_import @animation-functions_) ~(_bind @show-poem &(|~(_chop @frame_) ~(_cram ~(|animation:reactivate-nested-animations ~(|style:with-text-in-size ~(|style:with-font ~(|style:with-padding-of ~(_cons ~(_process-lines @poem_) [doc](||)_) #100|) $"Cochin"|) #20|)|) @frame_)|)_) ~(_bind @remove-poem &(|~(_chop @frame_) ~(_cram [nil] @frame_)|)_) ~(_bind @larger &" word"(|~(_style:with-text-in-size @word #35_)|)_) ~(_bind @black-bg &" line"(|~(|style:with-background-color-of ~(|style:with-text-in-color @line $"#ffffff"|) $"#000000"|)|)_) ~(_bind @process-words &" words"(|~(_map-with @words &" word"(|~(|if ~(_is-command @word_) ~(_eval @word_) @word|)|)_)|)_) ~(_bind @process-lines &" lines"(|~(_map-with @lines &" line"(|~(|if ~(_is-command @line_) ~(_process-words ~(_eval @line_)_) ~(_process-words @line_)|)|)_)|)_) ~(_bind @poem [doc](|~(_black-bg [line](_[word](_[letter]"I"_) [letter]" " [word](_[letter]"h" [letter]"a" [letter]"v" [letter]"e"_) [letter]" " [word](_[letter]"r" [letter]"e" [letter]"a" [letter]"c" [letter]"h" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"t" [letter]"o" [letter]"p"_) [letter]" " [word](_[letter]"o" [letter]"f"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"r" [letter]"i" [letter]"d" [letter]"g" [letter]"e"_) [letter]"."_)_) [line](_[nil] [word](_[letter]"I"_) [letter]" " [word](_[letter]"c" [letter]"a" [letter]"n" [letter]"'" [letter]"t"_) [letter]" " [word](_[letter]"h" [letter]"e" [letter]"a" [letter]"r"_) [letter]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [letter]"."_) [line](_[nil] [word](_[letter]"I"_) [letter]" " [word](_[letter]"c" [letter]"a" [letter]"n"_) [letter]" " [word](_[letter]"o" [letter]"n" [letter]"l" [letter]"y"_) [letter]" " [word](_[letter]"h" [letter]"e" [letter]"a" [letter]"r"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " ~(_larger [word](_[letter]"s" [letter]"t" [letter]"a" [letter]"r" [letter]"s"_)_)_) [line](_[nil] [word](_[letter]"a" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " ~(_animation:fade-between [word](_[letter]"c" [letter]"r" [letter]"i" [letter]"c" [letter]"k" [letter]"e" [letter]"t" [letter]"s"_) [line](_[word](_[letter]"t" [letter]"e" [letter]"r" [letter]"m" [letter]"i" [letter]"t" [letter]"e" [letter]"s"_) [letter]" " [word](_[letter]"i" [letter]"n"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"h" [letter]"a" [letter]"l" [letter]"f"_) [letter]"-" [word](_[letter]"b" [letter]"u" [letter]"r" [letter]"i" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"b" [letter]"o" [letter]"a" [letter]"r" [letter]"d" [letter]"s"_)_) %0.8 %3.1_) [letter]"."_) [line](_[nil] [word](_[letter]"I"_) [letter]" " [word](_[letter]"k" [letter]"n" [letter]"o" [letter]"w"_) [letter]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [letter]" " [word](_[letter]"a" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"a" [letter]"f" [letter]"r" [letter]"a" [letter]"i" [letter]"d"_) [letter]","_) [line](_[nil] [word](_[letter]"g" [letter]"a" [letter]"b" [letter]"b" [letter]"l" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"b" [letter]"y"_) [letter]" " [word](_[letter]"y" [letter]"o" [letter]"u" [letter]"r"_) [letter]" " [word](_[letter]"c" [letter]"a" [letter]"r"_)_) [line](_[nil] [word](_[letter]"i" [letter]"n"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " ~(_flicker [word](_[letter]"f" [letter]"i" [letter]"r" [letter]"e" [letter]"l" [letter]"i" [letter]"g" [letter]"h" [letter]"t"_)_) [letter]"."_) [line](_[nil] [word](_[letter]"I" [letter]"t"_) [letter]" " [word](_[letter]"i" [letter]"s"_) [letter]" " [word](_[letter]"d" [letter]"a" [letter]"r" [letter]"k"_) [letter]" " [word](_[letter]"w" [letter]"h" [letter]"e" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"I"_) [letter]" " [word](_[letter]"a" [letter]"m"_) [letter]","_) [line](_[nil] [word](_[letter]"a" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"w" [letter]"i" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"k" [letter]"n" [letter]"o" [letter]"w" [letter]"s"_) [letter]" " [word](_[letter]"m" [letter]"e"_) [letter]" " [word](_[letter]"m" [letter]"u" [letter]"c" [letter]"h"_) [letter]" " [word](_[letter]"b" [letter]"e" [letter]"t" [letter]"t" [letter]"e" [letter]"r"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"a" [letter]"n"_) [letter]" " ~(_style:flipped-horizontally [word](_[letter]"y" [letter]"o" [letter]"u"_)_) [letter]" " [word](_[letter]"d" [letter]"o"_) [letter]"."_)|)_) ~(_bind @frame ~(_cons [nil] ~(_make-doc _)_)_)|)v2:~(|begin ~(_import @fx-functions_) ~(_bind @random-dots &" canv"(|~(_let @w ~(_random-from-to #1 #2_)_) ~(_let @which ~(_random _)_) ~(_let @color ~(|if ~(_::lt:: @which %0.3_) ~(|make-org ~(_random-from-to #200 #254_) ~(_random-from-to #200 #254_) ~(_random-from-to #0 #20_)|) (_#255 #255 #255_)|)_) ~(|@<`rect`>canv @color ~(_random-from-to #0 ~(_- #40 @w_)_) ~(_random-from-to #0 ~(_- #24 @w_)_) @w @w|)|)_) ~(_bind @do-sand &(|~(_bind @c ~(_instantiate [nil]<`Canvas`> #40 #24_)_) ~(_ff ~(|do-on-every &" n"(|~(_random-dots @n_) @n|) @c #10|)_)|)_) ~(_bind @show-poem &(|~(|util:process ~(|util:process ~(|style:with-line-height ~(|style:with-padding-of ~(|style:with-light-weight ~(|style:with-font ~(|style:with-text-in-size @poem #20|) $"Gill Sans"|)|) #60|) $"1.25"|)|)|)|)_) ~(_bind @inset &" n"(|~(|style:with-left-padding-of ~(|style:with-bottom-padding-of ~(|style:with-top-padding-of ~(|style:align-right ~(|style:with-text-in-color ~(|style:with-text-in-size ~(|style:italicized @n|) #18|) $"#666666"|)|) #32|) #20|) #140|)|)_) ~(_bind @inset2 &" n"(|~(|style:with-top-padding-of ~(|style:with-left-padding-of ~(|style:italicized ~(|style:with-normal-weight @n|)|) #20|) #28|)|)_) ~(_bind @dying-word &" w"(|~(|style:with-text-in-color @w $"#dddddd"|)|)_) ~(_bind @shatter-words &" words"(|~(|ff ~(|animation:do-on-every &" n"(|~(|layout:do-for-each-letter-or-separator-in &" letter"(|~(_let @n ~(_random _)_) ~(_let @splitsize ~(_animation:random-from-to #3 #8_)_) ~(|if ~(_::lt:: @n %0.2_) @letter ~(|if ~(_::lt:: @n %0.6_) ~(_fx:split-letter-horiz @letter @splitsize_) ~(_fx:split-letter-vert @letter @splitsize_)|)|)|) @words|)|) [nil] #50|)|)|)_) ~(_bind @poem [doc](|[line](_[word](_[letter]"W" [letter]"h" [letter]"y"_) [separator]"," [separator]" " [word](_[letter]"w" [letter]"h" [letter]"e" [letter]"n"_) [separator]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [separator]" " [word](_[letter]"a" [letter]"r" [letter]"e"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " ~(_fx:split-horiz-four-times [line](_[word](_[letter]"s" [letter]"e" [letter]"v" [letter]"e" [letter]"r" [letter]"a" [letter]"l"_) [separator]" " [word](_[letter]"p" [letter]"i" [letter]"e" [letter]"c" [letter]"e" [letter]"s"_)_) #120_)_) [line](_[nil] [word](_[letter]"d" [letter]"o"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e" [letter]"y"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"i" [letter]"n" [letter]"s" [letter]"i" [letter]"s" [letter]"t"_) [separator]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [separator]" " [word](_[letter]"a" [letter]"r" [letter]"e"_) [separator]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [separator]" " [word](_[letter]"r" [letter]"e" [letter]"a" [letter]"d" [letter]"y"_) [separator]"?"_) ~(|inset [doc](|[line](_[nil] [word](_[letter]"B" [letter]"u" [letter]"t"_) [separator]" " [word](_[letter]"a" [letter]"t"_) [separator]" " [word](_[letter]"p" [letter]"e" [letter]"a" [letter]"c" [letter]"e"_) [separator]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [separator]" " [word](_[letter]"a" [letter]"r" [letter]"e"_) [separator]" " [word](_[letter]"n" [letter]"o" [letter]"w"_) [separator]"," [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"r" [letter]"e" [letter]"a" [letter]"d" [letter]"y"_) [separator]"."_) [line](_[nil] [word](_[letter]"T" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"s" [letter]"u" [letter]"n"_) [letter]" " [word](_[letter]"g" [letter]"o" [letter]"e" [letter]"s"_) [letter]" " [word](_[letter]"d" [letter]"o" [letter]"w" [letter]"n"_) [letter]" " ~(_ff ~(_animation:cycle-every [word](_[word](_[letter]"o" [letter]"v" [letter]"e" [letter]"r"_) [word](_[letter]"a" [letter]"n" [letter]"d"_)_) #250_)_)_) [line](_[word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"g" [letter]"a" [letter]"r" [letter]"g" [letter]"o" [letter]"y" [letter]"l" [letter]"e"_) [separator]" " [word](_[letter]"d" [letter]"o" [letter]"u" [letter]"b" [letter]"t" [letter]"s"_) [separator]" " [word](_[letter]"s" [letter]"i" [letter]"t"_) [separator]" " [word](_[letter]"a" [letter]"r" [letter]"o" [letter]"u" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"y" [letter]"o" [letter]"u" [letter]"r"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"d"_) [separator]","_) [line](_[nil] ~(_ff ~(_animation:cycle-every ~(|util:process [line](_[line](_[word](_[letter]"w" [letter]"i" [letter]"t" [letter]"h"_) [letter]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [letter]" " [word](_[letter]"u" [letter]"n" [letter]"t" [letter]"i" [letter]"l"_) [letter]" " ~(_dying-word [line](_[word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"e" [letter]"n" [letter]"d"_)_)_)_) [line](_[word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"a" [letter]"r" [letter]"o" [letter]"u" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"b" [letter]"e" [letter]"n" [letter]"d"_) [letter]" " ~(_dying-word [line](_[word](_[letter]"i" [letter]"s"_) [letter]" " [word](_[letter]"d" [letter]"e" [letter]"a" [letter]"t" [letter]"h"_)_)_)_)_)|) #2000_)_)_)|)|) [line](_[nil] [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"y" [letter]"e" [letter]"t"_) [separator]"?"_) [line](_[nil]_) [line](_[nil] [nil] ~(_shatter-words [line](_[word](_[letter]"T" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"g" [letter]"l" [letter]"a" [letter]"s" [letter]"s"_) [separator]" " [word](_[letter]"b" [letter]"r" [letter]"o" [letter]"k" [letter]"e" [letter]"n"_) [separator]"," [separator]" " [word](_[letter]"s" [letter]"h" [letter]"a" [letter]"r" [letter]"p"_) [separator]","_)_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"c" [letter]"u" [letter]"t" [letter]"s"_) [separator]" " [word](_[letter]"y" [letter]"o" [letter]"u" [letter]"r"_) [separator]" " [word](_[letter]"f" [letter]"e" [letter]"e" [letter]"t"_) [separator]"."_) [line](_[nil] [nil] [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " ~(_style:with-text-in-size [word](_[letter]"y" [letter]"o" [letter]"u"_) #24_) [separator]" " ~(_style:with-text-in-size [word](_[letter]"s" [letter]"t" [letter]"i" [letter]"l" [letter]"l"_) #28_) [separator]" " ~(_style:with-text-in-size [word](_[letter]"l" [letter]"i" [letter]"v" [letter]"e"_) #32_) [separator]" " [word](_[letter]"t" [letter]"o"_) [separator]" " [word](_[letter]"s" [letter]"p" [letter]"i" [letter]"t" [letter]"e"_) [separator]" " [word](_[letter]"i" [letter]"t"_) [separator]","_) [line](_[nil] [nil] [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"s" [letter]"o"_) [separator]" " [word](_[letter]"c" [letter]"l" [letter]"e" [letter]"a" [letter]"r" [letter]"l" [letter]"y"_) [separator]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [separator]" " [word](_[letter]"s" [letter]"h" [letter]"o" [letter]"u" [letter]"l" [letter]"d"_) [separator]" " [word](_[letter]"g" [letter]"o"_) [separator]"," [separator]" " ~(_ff ~(_animation:cycle-every [doc](|[line](_[word](_[letter]"c" [letter]"l" [letter]"e" [letter]"a" [letter]"r"_) [letter]"-" [word](_[letter]"e" [letter]"y" [letter]"e" [letter]"d"_)_) [line](_[nil] [word](_[letter]"h" [letter]"e" [letter]"a" [letter]"d" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"o" [letter]"u" [letter]"t"_)_) [line](_[nil] [word](_[letter]"h" [letter]"e" [letter]"a" [letter]"d"_) [letter]" " [word](_[letter]"h" [letter]"i" [letter]"g" [letter]"h"_)_) [line](_[nil] [word](_[letter]"e" [letter]"y" [letter]"e" [letter]"s"_) [letter]" " [word](_[letter]"a" [letter]"h" [letter]"e" [letter]"a" [letter]"d"_)_)|) #200_)_) [separator]","_) [line](_[nil] [nil] [nil] [nil] [nil] [nil] [word](_[letter]"S" [letter]"o"_) [separator]":" [separator]" " ~(_ff ~(_animation:cycle-every (_[word](_[letter]"a" [letter]"s" [letter]"s" [letter]"e" [letter]"m" [letter]"b" [letter]"l" [letter]"e"_) [word](_[letter]"a" [letter]"c" [letter]"c" [letter]"u" [letter]"m" [letter]"u" [letter]"l" [letter]"a" [letter]"t" [letter]"e"_)_) #50_)_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"o" [letter]"d" [letter]"d" [letter]"s"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"b" [letter]"i" [letter]"t" [letter]"s"_) [separator]"," [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"s" [letter]"c" [letter]"r" [letter]"a" [letter]"p" [letter]"s"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"e" [letter]"n" [letter]"d" [letter]"s"_) [separator]","_) [line](_[nil] [nil] [nil] [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"y" [letter]"o" [letter]"u" [letter]"r"_) [separator]" " [word](_[letter]"r" [letter]"u" [letter]"c" [letter]"k" [letter]"s" [letter]"a" [letter]"c" [letter]"k"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"f" [letter]"l" [letter]"a" [letter]"s" [letter]"h" [letter]"l" [letter]"i" [letter]"g" [letter]"h" [letter]"t"_) [separator]"," [separator]" " [word](_[letter]"i" [letter]"t" [letter]"s"_) [separator]" " [word](_[letter]"b" [letter]"a" [letter]"t" [letter]"t" [letter]"e" [letter]"r" [letter]"y"_) [separator]" " [word](_[letter]"d" [letter]"e" [letter]"a" [letter]"d"_) [separator]","_) [line](_[nil] [nil] [word](_[letter]"m" [letter]"a" [letter]"t" [letter]"c" [letter]"h" [letter]"b" [letter]"o" [letter]"x" [letter]"e" [letter]"s"_) [separator]"," [separator]" " [word](_[letter]"p" [letter]"a" [letter]"p" [letter]"e" [letter]"r" [letter]"s"_) [separator]"," [separator]" " [word](_[letter]"c" [letter]"h" [letter]"a" [letter]"r" [letter]"g" [letter]"e" [letter]"r" [letter]"s"_) [separator]"," [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"t" [letter]"t" [letter]"o" [letter]"m"_) [separator]"," [letter]" " ~(_make-zlist ~(_do-sand _) [word](_[letter]"s" [letter]"a" [letter]"n" [letter]"d"_)_) [letter]","_) [line](_[nil] [word](_[letter]"a" [letter]"n" [letter]"d"_)_) ~(|inset2 [doc](|[line](_[nil] [word](_[letter]"b" [letter]"r" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"i" [letter]"t"_) [letter]" " [word](_[letter]"a" [letter]"l" [letter]"l"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"t" [letter]"e" [letter]"m" [letter]"p" [letter]"l" [letter]"e"_) [letter]" " [word](_[letter]"a" [letter]"g" [letter]"a" [letter]"i" [letter]"n"_) [letter]","_) [line](_[nil] [word](_[letter]"f" [letter]"a" [letter]"c" [letter]"e"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"a" [letter]"v" [letter]"e" [letter]"n" [letter]"s"_) [separator]"," [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e" [letter]"n"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"w"_) [separator]","_) [line](_[nil] [nil] [word](_[letter]"a"_) [separator]" " [word](_[letter]"l" [letter]"i" [letter]"t" [letter]"t" [letter]"l" [letter]"e"_) [separator]" " [word](_[letter]"e" [letter]"m" [letter]"b" [letter]"a" [letter]"r" [letter]"r" [letter]"a" [letter]"s" [letter]"s" [letter]"e" [letter]"d"_) [separator]"," [separator]" " [word](_[letter]"b" [letter]"u" [letter]"t"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e" [letter]"n"_) [separator]","_) [line](_[nil] [nil] [word](_[letter]"a" [letter]"s" [letter]"k"_) [separator]" " [word](_[letter]"f" [letter]"o" [letter]"r"_) [separator]" " [word](_[letter]"m" [letter]"e" [letter]"r" [letter]"c" [letter]"y"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"b" [letter]"l" [letter]"i" [letter]"s" [letter]"s"_)_) [line](_[nil] [word](_[letter]"w" [letter]"i" [letter]"t" [letter]"h"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"e" [letter]"a" [letter]"d" [letter]"y"_) [separator]" " [word](_[letter]"g" [letter]"a" [letter]"z" [letter]"e"_) [separator]","_) [line](_[nil] [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"w" [letter]"a" [letter]"i" [letter]"t"_) [separator]"."_)|)|)|)_)|)v2:~(|with-imports @animation-functions @vector-functions @util-functions @style-functions ~(|begin [doc](|[line](_[word](_[letter]"P" [letter]"o" [letter]"e" [letter]"m"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"u" [letter]"f" [letter]"f"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"l" [letter]"o" [letter]"w"_) [separator]"."_)|) ~(_bind @poemtext [doc](|[line](_[word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"x" [letter]"e" [letter]"s"_)_) [line](_[word](_[letter]"j" [letter]"u" [letter]"s" [letter]"t"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"x"_)_) [line](_[word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"x"_)_) [line](_[word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"x"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"e" [letter]"v" [letter]"e" [letter]"r" [letter]"y"_) [separator]" " [word](_[letter]"d" [letter]"a" [letter]"y"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"r" [letter]"i" [letter]"g" [letter]"h" [letter]"t"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_) [separator]" " [word](_[letter]"i" [letter]"n" [letter]"s" [letter]"i" [letter]"d" [letter]"e"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_) [separator]" " [word](_[letter]"i" [letter]"n" [letter]"s" [letter]"i" [letter]"d" [letter]"e"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"x"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"p" [letter]"l" [letter]"a" [letter]"c" [letter]"e"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"n" [letter]"e" [letter]"v" [letter]"e" [letter]"r"_) [separator]" " [word](_[letter]"g" [letter]"o"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"y" [letter]"w" [letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_) [separator]" " [word](_[letter]"I"_) [separator]" " [word](_[letter]"a" [letter]"m"_)_) [line](_[word](_[letter]"j" [letter]"u" [letter]"s" [letter]"t"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"j" [letter]"u" [letter]"s" [letter]"t"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"s" [letter]"t" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"s" [letter]"t" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"x"_)_) [line](_[word](_[letter]"h" [letter]"e" [letter]"l" [letter]"l" [letter]"o"_)_) [line](_[word](_[letter]"I" [letter]"'" [letter]"m"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"r" [letter]"i" [letter]"g" [letter]"h" [letter]"t"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"s" [letter]"t" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"y" [letter]"u" [letter]"p"_)_) [line](_[word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"h" [letter]"e" [letter]"l" [letter]"l" [letter]"o"_)_) [line](_[word](_[letter]"I" [letter]"'" [letter]"m"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"n" [letter]"o" [letter]"t"_) [separator]" " [word](_[letter]"g" [letter]"o" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"y" [letter]"w" [letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_) [line](_[word](_[letter]"n" [letter]"o" [letter]"p" [letter]"e"_)_) [line](_[word](_[letter]"s" [letter]"t" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_)|)_) ~(_bind @numpoemlines ~(_util:length-of @poemtext_)_) ~(_bind @setup-text &(|~(_bind @textsurface ~(|style:with-width-of ~(|style:with-height-of ~(_make-zlist _) @canvasheight|) @canvaswidth|)_) ~(_bind @right-container ~(_style:rotate-by [doc](||) %90_)_) ~(_bind @top-container ~(_copy [doc](||)_)_) ~(_bind @left-container ~(_style:rotate-by [doc](||) %-90_)_) ~(_bind @bottom-container ~(_style:rotate-by [doc](||) %180_)_) ~(_cram ~(_cram [nil] @right-container_) @textsurface_) ~(_cram ~(_cram [nil] @top-container_) @textsurface_) ~(_cram ~(_cram [nil] @left-container_) @textsurface_) ~(_cram ~(_cram [nil] @bottom-container_) @textsurface_)|)_) ~(_bind @format-text &" txt"(|~(_let @t ~(_ff ~(_animation:fade-out-for-seconds ~(|style:uppercased ~(|style:with-font ~(|style:with-text-in-size ~(_style:with-text-in-color @txt $"#ffffff"_) #35|) $"Helvetica"|)|) %3_)_)_) ~(_let @c ~(_style:push-center ~(_style:with-width-of [line](__) @canvaswidth_)_)_) ~(_cons @t @c_)|)_) ~(_bind @set-right-text &" text"(|~(_chop @right-container_) ~(_cram ~(_format-text @text_) @right-container_) ~(_force-draw @textsurface_)|)_) ~(_bind @set-top-text &" text"(|~(_chop @top-container_) ~(_cram ~(_format-text @text_) @top-container_) ~(_force-draw @textsurface_)|)_) ~(_bind @set-left-text &" text"(|~(_chop @left-container_) ~(_cram ~(_format-text @text_) @left-container_) ~(_force-draw @textsurface_)|)_) ~(_bind @set-bottom-text &" text"(|~(_chop @bottom-container_) ~(_cram ~(_format-text @text_) @bottom-container_) ~(_force-draw @textsurface_)|)_) ~(_bind @readpoem &(|~(_do-on-every-for &" n"(|~(_bind @words ~(_util:nth-from ~(_modulo @n @numpoemlines_) @poemtext_)_) ~(_bind @whichside ~(_modulo @n #4_)_) ~(|first-non-nil ~(_if ~(_::eq:: @whichside #0_) ~(_set-right-text @words_)_) ~(_if ~(_::eq:: @whichside #1_) ~(_set-bottom-text @words_)_) ~(_if ~(_::eq:: @whichside #2_) ~(_set-left-text @words_)_) ~(_if ~(_::eq:: @whichside #3_) ~(_set-top-text @words_)_)|) ~(_::pl:: @n #1_)|) #0 #1000 ~(_::ti:: @numpoemlines #3_)_)|)_) [doc](|[line](_[word](_[letter]"C" [letter]"a" [letter]"n" [letter]"v" [letter]"a" [letter]"s"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"u" [letter]"f" [letter]"f"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"l" [letter]"o" [letter]"w"_) [separator]"."_)|) ~(_bind @canvaswidth %500_) ~(_bind @canvasheight %500_) ~(_bind @maxradius %200_) ~(_bind @canvas ~(_instantiate [nil]<`Canvas`> ~(_to-integer @canvaswidth_) ~(_to-integer @canvasheight_)_)_) ~(_bind @centeroffset ~(_instantiate [nil]<`Vector`> ~(_::ov:: @canvaswidth %2_) ~(_::ov:: @canvasheight %2_)_)_) ~(_bind @position ~(_instantiate [nil]<`Vector`> %0 %0_)_) ~(_bind @reset-canvas &(|~(_@<`fill-background`>canvas (|#0 #0 #0|)_) ~(_bind @position ~(_instantiate [nil]<`Vector`> %0 %0_)_)|)_) ~(_bind @directions ~(|make-org ~(_add-tag ~(_<`right`>instantiate [nil]<`Vector`> %5 %0_) $"right"_) ~(_add-tag ~(_<`left`>instantiate [nil]<`Vector`> %-5 %0_) $"left"_) ~(_add-tag ~(_<`down`>instantiate [nil]<`Vector`> %0 %5_) $"down"_) ~(_add-tag ~(_<`up`>instantiate [nil]<`Vector`> %0 %-5_) $"up"_)|)_) ~(_bind @constructprobs &" rotateby"(|~(_let @probs1 ~(|map-with @directions &" d"(|${the position plus d (delta) gives you a distance from the origin.
divide by max radius allowed,
then
plug into the formula:
(1-x)^(1/100) which is mostly flat
but falls off sharply as you approach 1.
this gives you probability of this
distance being chosen, but you have to normalize it.} ~(_let @drotated ~(_@<`rotate`>d @rotateby_)_) ~(_let @where ~(_@<`add`>drotated @position_)_) ~(_let @radius ~(_@<`magnitude`>where_)_) ~(_let @radprob ~(_power ~(_- %1 ~(_::ov:: @radius @maxradius_)_) ~(_::ov:: %1 %100_)_)_) ~(_cons @radprob ~(_cons @where (||)_)_)|)|)_) ~(_let @total ~(_reduce-with-starting @probs1 &" item val"(|~(_::pl:: ~(_car @item_) @val_)|) %0_)_) ~(_map-with @probs1 &" item"(|~(_let @second ~(_car ~(_cdr @item_)_)_) ~(_let @norm ~(_::ov:: ~(_car @item_) @total_)_) ~(_cons @norm ~(_cons @second (||)_)_)|)_)|)_) ~(_bind @chooseoption &" options"(|~(_let @chosen [nil]_) ~(_let @r ~(_random _)_) ~(_reduce-with-starting @options &" item val"(|~(_let @prob ~(_first @item_)_) ~(_let @nextval ~(_::pl:: @val @prob_)_) ~(|if ~(_and ~(_::gte:: @r @val_) ~(_::lt:: @r @nextval_)_) ~(_set @chosen ~(_util:second @item_)_)|) @nextval|) %0_) @chosen|)_) ~(_bind @dostep &" rotateby%"(|~(_let @newposition ~(_chooseoption ~(_constructprobs @rotateby_)_)_) ~(_let @drawstart ~(_@<`add`>position @centeroffset_)_) ~(_let @drawend ~(_@<`add`>newposition @centeroffset_)_) ~(|@<`line`>canvas (|#255 #255 #255|) ~(_to-integer @<`x`>drawstart_) ~(_to-integer @<`y`>drawstart_) ~(_to-integer @<`x`>drawend_) ~(_to-integer @<`y`>drawend_)|) ~(_set @position @newposition_)|)_) ~(_bind @randomwalk &(|~(|animation:do-on-every &" theta"(|~(_dostep @theta_) ~(_::pl:: @theta %0.001_)|) %0 #1|)|)_) ~(_bind @setup-and-get-root &(|~(_setup-text _) ~(_reset-canvas _) ~(_bind @paddingcontainer ~(_style:with-padding-of (||) #30_)_) ~(_cons ~(_make-zlist @canvas @textsurface_) @paddingcontainer_)|)_) ~(_bind @start &(|~(_make-org ~(_ff ~(_readpoem _)_) ~(_ff ~(_randomwalk _)_)_)|)_)|)|)v2:~(|with-imports @util-functions @animation-functions @util-functions ~(|begin ~(_bind @test2 &(_~(_loop2 ~(_animation:fade-in-for-seconds [word](_[letter]"h" [letter]"e" [letter]"l" [letter]"l" [letter]"o"_) %3_)_)_)_) ~(_bind @test &(|~(_animation:loop2 ~(_animation:seq ~(_animation:fade-in-for-seconds [word](_[letter]"h" [letter]"e" [letter]"l" [letter]"l" [letter]"o"_) %1_) ~(_animation:fade-out-for-seconds [word](_[letter]"h" [letter]"e" [letter]"l" [letter]"l" [letter]"o"_) %1_)_)_)|)_) ~(_bind @sing &(|~(_format ~(_copy @poem_)_)|)_) ~(_bind @format &" text"(|~(_style:with-font ~(_style:with-padding-of ~(_util:process-text @text_) #200_) $"Helvetica"_)|)_) ~(_bind @adultfade &" text"(|~(_animation:do-on-every-with-param &" nex p"(|~(_let @val ~(_::ov:: ~(_sin ~(_::ov:: @p %40_)_) %2_)_) ~(_style:with-alpha-of @nex @val_)|) @text #20_)|)_) ~(_bind @poem [doc](|[line](_[word](_[letter]"S" [letter]"e" [letter]"a" [letter]"s" [letter]"i" [letter]"d" [letter]"e"_)_) [line](__) [line](__) [line](_[word](_[letter]"Y" [letter]"o" [letter]"u"_) [separator]" " ~(_cycle [line](_[word](_[letter]"u" [letter]"n" [letter]"c" [letter]"e" [letter]"r" [letter]"e" [letter]"m" [letter]"o" [letter]"n" [letter]"i" [letter]"o" [letter]"u" [letter]"s" [letter]"l" [letter]"y"_) [word](_[letter]"p" [letter]"e" [letter]"r" [letter]"f" [letter]"u" [letter]"n" [letter]"c" [letter]"t" [letter]"o" [letter]"r" [letter]"i" [letter]"l" [letter]"y"_)_)_) [separator]" " [word](_[letter]"p" [letter]"u" [letter]"s" [letter]"h"_) [separator]" " [word](_[letter]"m" [letter]"e"_) [separator]" " [word](_[letter]"i" [letter]"n" [letter]"t" [letter]"o"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"w" [letter]"a" [letter]"t" [letter]"e" [letter]"r"_)_) [line](_[word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"I"_) [separator]" " [word](_[letter]"f" [letter]"l" [letter]"o" [letter]"a" [letter]"t"_) [separator]" " [word](_[letter]"a" [letter]"w" [letter]"a" [letter]"y"_) [separator]"," [separator]" " [word](_[letter]"m" [letter]"y"_) [separator]" " [word](_[letter]"l" [letter]"e" [letter]"g" [letter]"s"_) [separator]" " [word](_[letter]"d" [letter]"a" [letter]"n" [letter]"g" [letter]"l" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"m" [letter]"i" [letter]"l" [letter]"e" [letter]"s"_) [separator]" " [word](_[letter]"a" [letter]"b" [letter]"o" [letter]"v" [letter]"e"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"c" [letter]"r" [letter]"a" [letter]"b" [letter]"s"_) [separator]","_) [line](_[word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"s" [letter]"i" [letter]"l" [letter]"v" [letter]"e" [letter]"r"_) [separator]" " [word](_[letter]"s" [letter]"h" [letter]"a" [letter]"f" [letter]"t" [letter]"s"_) [separator]" " [word](_[letter]"o" [letter]"f"_) [separator]" " [word](_[letter]"l" [letter]"i" [letter]"g" [letter]"h" [letter]"t"_) [separator]" " ~(_cycle [line](_[line](_[word](_[letter]"c" [letter]"o" [letter]"l" [letter]"l" [letter]"i" [letter]"d" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"l" [letter]"o" [letter]"w"_) [separator]" " [word](_[letter]"w" [letter]"i" [letter]"t" [letter]"h"_)_) [line](_[word](_[letter]"i" [letter]"m" [letter]"p" [letter]"a" [letter]"c" [letter]"t" [letter]"i" [letter]"n" [letter]"g"_)_)_)_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " ~(_cycle [line](_[word](_[letter]"s" [letter]"a" [letter]"n" [letter]"d"_) [word](_[letter]"m" [letter]"i" [letter]"c" [letter]"a"_) [word](_[letter]"s" [letter]"i" [letter]"l" [letter]"i" [letter]"c" [letter]"a"_)_)_) [separator]","_) [line](_[word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"I"_) [separator]" " [word](_[letter]"l" [letter]"o" [letter]"o" [letter]"k"_) [separator]" " [word](_[letter]"b" [letter]"a" [letter]"c" [letter]"k"_) [separator]" " [word](_[letter]"a" [letter]"t"_) [separator]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [separator]","_) [line](_[word](_[letter]"e" [letter]"y" [letter]"e" [letter]"s"_) [separator]" " ~(_cycle [line](_[word](_[letter]"u" [letter]"n" [letter]"c" [letter]"e" [letter]"r" [letter]"t" [letter]"a" [letter]"i" [letter]"n"_) [word](_[letter]"f" [letter]"a" [letter]"c" [letter]"t" [letter]"u" [letter]"a" [letter]"l"_) [word](_[letter]"w" [letter]"i" [letter]"d" [letter]"e"_) [line](_[word](_[letter]"f" [letter]"i" [letter]"n" [letter]"a" [letter]"l" [letter]"l" [letter]"y"_) [separator]" " [word](_[letter]"s" [letter]"e" [letter]"e" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [separator]" " [word](_[letter]"f" [letter]"o" [letter]"r"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"f" [letter]"i" [letter]"r" [letter]"s" [letter]"t"_) [separator]" " [word](_[letter]"t" [letter]"i" [letter]"m" [letter]"e"_)_)_)_) [separator]"."_) [line](_[word](_[letter]"I"_) [separator]" " [word](_[letter]"h" [letter]"a" [letter]"d"_) [separator]" " [word](_[letter]"g" [letter]"r" [letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"t" [letter]"o" [letter]"w" [letter]"e" [letter]"r" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"d" [letter]"r" [letter]"e" [letter]"a" [letter]"m" [letter]"s"_) [separator]","_) [line](_[word](_[letter]"i" [letter]"m" [letter]"p" [letter]"r" [letter]"e" [letter]"g" [letter]"n" [letter]"a" [letter]"b" [letter]"l" [letter]"e"_) [separator]" " [word](_[letter]"f" [letter]"o" [letter]"r" [letter]"t" [letter]"r" [letter]"e" [letter]"s" [letter]"s" [letter]"e" [letter]"s"_) [separator]" " [word](_[letter]"l" [letter]"i" [letter]"k" [letter]"e"_) [separator]" " [word](_[letter]"b" [letter]"a" [letter]"s" [letter]"a" [letter]"l" [letter]"t"_) [separator]" " [word](_[letter]"c" [letter]"l" [letter]"i" [letter]"f" [letter]"f" [letter]"s"_) [separator]"," [separator]" " ~(_cycle [line](_[word](_[letter]"t" [letter]"o" [letter]"p" [letter]"p" [letter]"e" [letter]"d"_) [word](_[letter]"t" [letter]"i" [letter]"p" [letter]"p" [letter]"e" [letter]"d"_)_)_) [separator]" " [word](_[letter]"w" [letter]"i" [letter]"t" [letter]"h"_) [separator]" " ~(_cycle [line](_[word](_[letter]"p" [letter]"e" [letter]"n" [letter]"n" [letter]"a" [letter]"n" [letter]"t" [letter]"s"_) [word](_[letter]"c" [letter]"o" [letter]"l" [letter]"o" [letter]"n" [letter]"n" [letter]"a" [letter]"d" [letter]"e" [letter]"s"_)_)_) [separator]"."_) [line](_~(_cycle [line](_[line](_[word](_[letter]"H" [letter]"o" [letter]"w"_) [separator]" " [word](_[letter]"d" [letter]"i" [letter]"d"_) [separator]" " [word](_[letter]"I"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"c" [letter]"o" [letter]"m" [letter]"e"_)_) [line](_[word](_[letter]"T" [letter]"h" [letter]"e" [letter]"n"_) [separator]" " [word](_[letter]"I"_) [separator]" " [word](_[letter]"s" [letter]"o" [letter]"m" [letter]"e" [letter]"h" [letter]"o" [letter]"w"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"c" [letter]"a" [letter]"m" [letter]"e"_)_)_)_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"i" [letter]"d" [letter]"i" [letter]"o" [letter]"t"_) [separator]" " [word](_[letter]"w" [letter]"h" [letter]"o"_) [separator]","_) [line](_[word](_[letter]"a" [letter]"f" [letter]"t" [letter]"e" [letter]"r"_) [separator]" " [word](_[letter]"h" [letter]"a" [letter]"v" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"r" [letter]"e" [letter]"a" [letter]"d"_) [separator]" " [word](_[letter]"s" [letter]"o"_) [separator]" " [word](_[letter]"m" [letter]"a" [letter]"n" [letter]"y"_) [separator]" " [word](_[letter]"t" [letter]"i" [letter]"m" [letter]"e" [letter]"s"_) [separator]","_) [line](_[word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"a" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"c" [letter]"h" [letter]"i" [letter]"l" [letter]"d" [letter]"r" [letter]"e" [letter]"n" [letter]"'" [letter]"s"_) [separator]" " [word](_[letter]"b" [letter]"o" [letter]"o" [letter]"k" [letter]"s"_) [separator]","_) [line](_[separator]{"} [word](_[letter]"O" [letter]"n" [letter]"e"_) [separator]" " [word](_[letter]"t" [letter]"i" [letter]"n" [letter]"y"_) [separator]" " [word](_[letter]"m" [letter]"o" [letter]"t" [letter]"e"_) [separator]" " [word](_[letter]"c" [letter]"a" [letter]"n"_) [separator]" " [word](_[letter]"b" [letter]"r" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"i" [letter]"t"_) [separator]" " [word](_[letter]"a" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"d" [letter]"o" [letter]"w" [letter]"n"_) [separator]"," [separator]{"}_) ~(_style:with-left-padding-of ~(_adultfade [line](_[word](_[letter]"a" [letter]"s"_) [separator]" " [word](_[letter]"a" [letter]"n"_) [separator]" " [word](_[letter]"a" [letter]"d" [letter]"u" [letter]"l" [letter]"t"_) [separator]","_)_) #200_) [line](_[word](_[letter]"l" [letter]"e" [letter]"t"_) [separator]" " [word](_[letter]"m" [letter]"y"_) [separator]" " [word](_[letter]"g" [letter]"u" [letter]"a" [letter]"r" [letter]"d" [letter]"s"_) [separator]" " [word](_[letter]"g" [letter]"e" [letter]"t"_) [separator]" " [word](_[letter]"d" [letter]"r" [letter]"u" [letter]"n" [letter]"k"_) [separator]" " [word](_[letter]"a" [letter]"t"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e" [letter]"i" [letter]"r"_) [separator]" " [word](_[letter]"p" [letter]"o" [letter]"s" [letter]"t" [letter]"s"_) [separator]","_) [line](_[word](_[letter]"l" [letter]"e" [letter]"f" [letter]"t"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"d" [letter]"r" [letter]"a" [letter]"w" [letter]"b" [letter]"r" [letter]"i" [letter]"d" [letter]"g" [letter]"e"_) [separator]" " [word](_[letter]"o" [letter]"p" [letter]"e" [letter]"n"_) [separator]","_) [line](_[word](_[letter]"w" [letter]"e" [letter]"n" [letter]"t"_) [separator]" " [word](_[letter]"w" [letter]"i" [letter]"t" [letter]"h"_) [separator]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [separator]" " [word](_[letter]"t" [letter]"o"_) [separator]" " ~(_cycle [line](_[line](_[word](_[letter]"a"_) [separator]" " [word](_[letter]"k" [letter]"e" [letter]"l" [letter]"p"_) [separator]"-" [word](_[letter]"s" [letter]"t" [letter]"r" [letter]"e" [letter]"w" [letter]"n"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"a" [letter]"c" [letter]"h"_)_) [line](_[word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"b" [letter]"l" [letter]"e" [letter]"a" [letter]"c" [letter]"h" [letter]"e" [letter]"d"_) [separator]" " [word](_[letter]"s" [letter]"e" [letter]"a" [letter]"s" [letter]"i" [letter]"d" [letter]"e"_)_)_)_) [separator]","_) [line](_[word](_[letter]"t" [letter]"o" [letter]"o" [letter]"k"_) [separator]" " [word](_[letter]"o" [letter]"f" [letter]"f"_) [separator]" " [word](_[letter]"a" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"m" [letter]"y"_) [separator]" " [word](_[letter]"c" [letter]"l" [letter]"o" [letter]"t" [letter]"h" [letter]"e" [letter]"s"_) [separator]","_) [line](_[word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"l" [letter]"e" [letter]"f" [letter]"t"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e" [letter]"m"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"y" [letter]"o" [letter]"u" [letter]"r"_) [separator]" " [word](_[letter]"l" [letter]"o" [letter]"c" [letter]"k" [letter]"e" [letter]"d"_) [separator]" " [word](_[letter]"c" [letter]"a" [letter]"r"_) [separator]"."_)|)_)|)|)v2:~(|begin ~(_import @style-functions_) ~(_bind @poem [doc](|[line](_[word](_[letter]"H" [letter]"e" [letter]"r" [letter]"o"_) [separator]" " [word](_[letter]"h" [letter]"o" [letter]"u" [letter]"r"_) [separator]":" [separator]" " [word](_[letter]"Z" [letter]"e" [letter]"n" [letter]"o"_) [separator]" " [word](_[letter]"g" [letter]"e" [letter]"t" [letter]"s"_) [separator]" " [word](_[letter]"c" [letter]"l" [letter]"o" [letter]"s" [letter]"e" [letter]"r"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"c" [letter]"l" [letter]"o" [letter]"s" [letter]"e" [letter]"r"_) [separator]" " [word](_[letter]"t" [letter]"o"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"a" [letter]"t"_) [separator]" " [word](_[letter]"s" [letter]"i" [letter]"n" [letter]"g" [letter]"u" [letter]"l" [letter]"a" [letter]"r" [letter]"i" [letter]"t" [letter]"y"_) [separator]" " [word](_[letter]"o" [letter]"f"_) [separator]" " [word](_[letter]"s" [letter]"i" [letter]"m" [letter]"p" [letter]"l" [letter]"i" [letter]"c" [letter]"i" [letter]"t" [letter]"y"_) [separator]","_) [line](_[word](_[letter]"f" [letter]"o" [letter]"l" [letter]"l" [letter]"o" [letter]"w" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"p" [letter]"l" [letter]"u" [letter]"m" [letter]"b" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"o" [letter]"f"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"w" [letter]"o" [letter]"r" [letter]"l" [letter]"d"_) [separator]" " [word](_[letter]"t" [letter]"o"_) [separator]" " [word](_[letter]"w" [letter]"h" [letter]"e" [letter]"r" [letter]"e"_) [separator]" " [word](_[letter]"i" [letter]"t"_) [separator]" " [word](_[letter]"l" [letter]"e" [letter]"a" [letter]"d" [letter]"s"_) [separator]","_) [line](_[word](_[letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"r" [letter]"e" [letter]"a" [letter]"l" [letter]"i" [letter]"z" [letter]"e" [letter]"s"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"a" [letter]"t"_) [separator]" " [word](_[letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"p" [letter]"u" [letter]"r" [letter]"s" [letter]"u" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"d" [letter]"e" [letter]"a" [letter]"t" [letter]"h"_) [separator]","_) [line](_[word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"s" [letter]"o"_) [separator]" " [word](_[letter]"a" [letter]"t"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"m" [letter]"o" [letter]"m" [letter]"e" [letter]"n" [letter]"t"_) [separator]" " [word](_[letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"s" [letter]"e" [letter]"e" [letter]"s"_) [separator]" " [word](_[letter]"t" [letter]"r" [letter]"u" [letter]"t" [letter]"h"_)_) [line](_[word](_[letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"w" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"c" [letter]"o" [letter]"m" [letter]"e"_) [separator]" " [word](_[letter]"i" [letter]"r" [letter]"r" [letter]"e" [letter]"l" [letter]"e" [letter]"v" [letter]"a" [letter]"n" [letter]"t"_) [separator]"."_) ~(_style:with-text-in-size [line](_[word](_[letter]"Y" [letter]"o" [letter]"u"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e" [letter]"r" [letter]"e"_) [letter]"!"_) #30_) [line](_[word](_[letter]"C" [letter]"o" [letter]"m" [letter]"e"_) [separator]" " [word](_[letter]"w" [letter]"i" [letter]"t" [letter]"h"_) [separator]" " [word](_[letter]"m" [letter]"e"_) [separator]","_) [line](_[word](_[letter]"b" [letter]"e" [letter]"c" [letter]"a" [letter]"u" [letter]"s" [letter]"e"_) [separator]" " [word](_[letter]"I"_) [separator]" " [word](_[letter]"n" [letter]"e" [letter]"e" [letter]"d"_) [separator]" " [word](_[letter]"a" [letter]"n"_) [separator]" " [word](_[letter]"e" [letter]"x" [letter]"c" [letter]"u" [letter]"s" [letter]"e"_) [separator]" " [word](_[letter]"t" [letter]"o"_) [separator]" " [word](_[letter]"l" [letter]"i" [letter]"e"_) [separator]" " [word](_[letter]"o" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"g" [letter]"r" [letter]"a" [letter]"v" [letter]"e" [letter]"l"_) [separator]" " [word](_[letter]"d" [letter]"r" [letter]"i" [letter]"v" [letter]"e" [letter]"w" [letter]"a" [letter]"y"_) [separator]"."_) [line](_[word](_[letter]"S" [letter]"h" [letter]"a" [letter]"r" [letter]"p"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"o" [letter]"n" [letter]"e" [letter]"s"_) [separator]" " [word](_[letter]"w" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"d" [letter]"i" [letter]"g"_) [separator]" " [word](_[letter]"i" [letter]"n" [letter]"t" [letter]"o"_) [separator]" " [word](_[letter]"o" [letter]"u" [letter]"r"_) [separator]" " [word](_[letter]"b" [letter]"a" [letter]"c" [letter]"k" [letter]"s"_) [separator]"," [separator]" " [word](_[letter]"u" [letter]"n" [letter]"b" [letter]"a" [letter]"n" [letter]"a" [letter]"l"_) [separator]","_) [line](_[word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"w" [letter]"e"_) [separator]" " [word](_[letter]"w" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"w" [letter]"a" [letter]"t" [letter]"c" [letter]"h"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"g" [letter]"r" [letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"n" [letter]"a" [letter]"r" [letter]"r" [letter]"a" [letter]"t" [letter]"i" [letter]"v" [letter]"e"_) [separator]" " [word](_[letter]"o" [letter]"f"_) [separator]" " [word](_[letter]"Z" [letter]"e" [letter]"n" [letter]"o" [letter]"'" [letter]"s"_) [separator]" " [word](_[letter]"a" [letter]"d" [letter]"v" [letter]"e" [letter]"n" [letter]"t" [letter]"u" [letter]"r" [letter]"e" [letter]"s"_) [separator]" " [word](_[letter]"p" [letter]"l" [letter]"a" [letter]"y"_) [separator]" " [word](_[letter]"o" [letter]"u" [letter]"t"_) [separator]" " [word](_[letter]"o" [letter]"v" [letter]"e" [letter]"r" [letter]"h" [letter]"e" [letter]"a" [letter]"d"_) [separator]","_) [line](_[word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"d" [letter]"a" [letter]"r" [letter]"k"_) [separator]" " [word](_[letter]"l" [letter]"e" [letter]"a" [letter]"v" [letter]"e" [letter]"s"_) [separator]" " [word](_[letter]"a" [letter]"g" [letter]"a" [letter]"i" [letter]"n" [letter]"s" [letter]"t"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"e" [letter]"e" [letter]"l"_) [separator]" " [word](_[letter]"d" [letter]"u" [letter]"s" [letter]"k"_) [separator]" " [word](_[letter]"s" [letter]"k" [letter]"y"_) [separator]"," [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"l" [letter]"a" [letter]"t" [letter]"e" [letter]"r"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"e" [letter]"n" [letter]"t" [letter]"r" [letter]"a" [letter]"i" [letter]"l" [letter]"s"_) [separator]" " [word](_[letter]"o" [letter]"f"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"M" [letter]"i" [letter]"l" [letter]"k" [letter]"y"_) [separator]" " [word](_[letter]"W" [letter]"a" [letter]"y"_) [separator]"."_)|)_) [separator]","|)v2:~(|package @layout ~(_import @util-functions_) ~(_import @style-functions_) ~(_bind @scale-to-pixel-width &" n width"(|~(_let @defaultsize #50_) ~(_let @infont ~(_style:with-text-in-size @n @defaultsize_)_) ~(_let @widthindefaultfont ~(_get-pixel-width @infont_)_) ~(_let @heightindefaultfont ~(_get-pixel-height @infont_)_) ~(_let @ratio ~(_::ov:: ~(_to-float @width_) ~(_to-float @widthindefaultfont_)_)_) ~(_let @containerheight ~(_::ti:: @ratio ~(_to-float @heightindefaultfont_)_)_) ~(|cons ~(_style:with-transform-origin-x-y ~(_style:with-scale @infont @ratio_) %0.0 %0.0_) ~(_style:with-height-of [line](__) @containerheight_)|)|)_) ~(_bind @justify-doc-to-width-in-format-by-line &" doc sizelimit format"(|~(|map-with @doc &" line"(|~(_let @formattedline ~(_format @line_)_) ~(_let @widthat50 ~(_get-pixel-width ~(_style:with-text-in-size @formattedline #50_)_)_) ~(_let @desiredpixelsize ~(_to-integer ~(_::ti:: %50 ~(_::ov:: ~(_to-float @sizelimit_) @widthat50_)_)_)_) ~(_style:with-text-in-size @formattedline @desiredpixelsize_)|)|)|)_) ~(_bind @justify-doc-to-width-in-format &" doc sizelimit format"(|~(|map-with @doc &" line"(|~(_let @formattedline ~(_do-for-each-letter-or-separator-in &" letter"(|~(_format @letter_)|) @line_)_) ~(_let @widthat50 ~(_get-pixel-width ~(_style:with-text-in-size @formattedline #50_)_)_) ~(_let @desiredpixelsize ~(_to-integer ~(_::ti:: %50 ~(_::ov:: ~(_to-float @sizelimit_) @widthat50_)_)_)_) ~(_do-for-each-letter-or-separator-in &" letter"(|~(|style:with-text-in-size @letter @desiredpixelsize|)|) @formattedline_)|)|)|)_) ~(_bind @doc-with-contents-of &" lst"(|~(_util:put-contents-in @lst [doc](||)_)|)_) ~(_bind @with-only-words &" lst"(|~(_util:with-only-items-satisfying @lst @is-word_)|)_) ~(_bind @combine-lines &" doc"(|~(|if ~(_is-empty @doc_) [line](__) ~(_util:list-cat ~(_car @doc_) ~(_combine-lines ~(_cdr @doc_)_)_)|)|)_) ~(_bind @flatten-lines &" doc"(|~(|map @doc &" line"(|~(_util:flatten @line_)|)|)|)_) ~(_bind @do-for-each-line-in &" f doc"(|~(|util:traverse-items-satisfying-and-do @doc &" n"(|~(_is-line @n_)|) @f|)|)_) ~(_bind @do-for-each-word-in &" f doc"(|~(|util:traverse-items-satisfying-and-do @doc &" n"(|~(_is-word @n_)|) @f|)|)_) ~(_bind @do-for-each-letter-in &" f doc"(|~(|util:traverse-items-satisfying-and-do @doc &" n"(|~(_is-letter @n_)|) @f|)|)_) ~(_bind @do-for-each-letter-or-separator-in &" f doc"(|~(|util:traverse-items-satisfying-and-do @doc &" n"(|~(|or ~(_is-letter @n_) ~(_is-separator @n_)|)|) @f|)|)_) ~(_bind @do-for-each-expectation-in &" f doc"(|~(|util:traverse-items-satisfying-and-do @doc &" n"(|~(_is-expectation @n_)|) @f|)|)_) ~(_bind @top-mask-nex-by &" n amount"(|~(_let @nexheight ~(_get-pixel-height @n_)_) ~(_let @nexwidth ~(_get-pixel-width @n_)_) ~(_let @maskheight ~(_::ti:: @amount @nexheight_)_) ~(_cons @n ~(_style:clips-contents ~(_style:with-width-of ~(_style:with-height-of [word](__) @maskheight_) @nexwidth_)_)_)|)_)|)v2:(|~(_import @animation-functions_) ~(_import @math-functions_) ~(_import @color-functions_) ~(_import @style-functions_) ~(_bind @poem ~(_style:with-padding-of ~(_style:with-font [doc](||) $"Helvetica"_) #30_)_) (_@poem (|@poem|)_)|)v2:~(|package @math ~(_import @util-functions_) ~(_import @vector-functions_) ~(_bind @min &" a b"(|~(_if ~(_::lt:: @a @b_) @a @b_)|)_) ~(_bind @max &" a b"(|~(_if ~(_::gt:: @a @b_) @a @b_)|)_) ~(_bind @hex-string-of &" n"(|~(_let @map [word](_[word](_#10 $"a"_) [word](_#11 $"b"_) [word](_#12 $"c"_) [word](_#13 $"d"_) [word](_#14 $"e"_) [word](_#15 $"f"_)_)_) ~(_let @string-for-digit &" digit-in-decimal"(|~(|if ~(_::lte:: @digit-in-decimal #9_) ~(_to-string @digit-in-decimal_) ~(_util:lookup-key-in @digit-in-decimal @map_)|)|)_) ~(_let @do-entire-number &" num"(|~(_let @least-sig-digit ~(_modulo @num #16_)_) ~(_let @remaining ~(|if ~(_::eq:: #0 ~(_- @num @least-sig-digit_)_) #0 ~(_::ov:: ~(_- @num @least-sig-digit_) #16_)|)_) ~(|string-cat ~(|if ~(_::eq:: #0 @remaining_) $ ~(_do-entire-number @remaining_)|) ~(_string-for-digit @least-sig-digit_)|)|)_) ~(_do-entire-number @n_)|)_) ~(_bind @random-from-to &" start#% end#%"(|~(_let @rand ~(_::ti:: ~(_random _) ~(_- ~(_to-float @end_) ~(_to-float @start_)_)_)_) ~(|if ~(_or ~(_is-float @start_) ~(_is-float @end_)_) ~(_::pl:: @start @rand_) ~(_::pl:: @start ~(_to-integer @rand_)_)|)|)_) ~(_bind @random-boolean &(|~(_let @rand ~(_random _)_) ~(_::lt:: @rand %0.5_)|)_) ~(_bind @runge-kutta &"% f& yn% h%"(|[doc](|[line](_[word](_[letter]"N" [letter]"o" [letter]"t" [letter]"e"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"a" [letter]"t"_) [separator]" " [word](_[letter]"f"_) [separator]" " [word](_[letter]"s" [letter]"h" [letter]"o" [letter]"u" [letter]"l" [letter]"d"_) [separator]" " [word](_[letter]"b" [letter]"e"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"f" [letter]"u" [letter]"n" [letter]"c" [letter]"t" [letter]"i" [letter]"o" [letter]"n"_) [separator]" " [word](_[letter]"o" [letter]"f"_) [separator]" " [word](_[letter]"j" [letter]"u" [letter]"s" [letter]"t"_) [separator]" " [word](_[letter]"y"_) [separator]"," [separator]" " [word](_[letter]"t"_) [separator]" " [word](_[letter]"n" [letter]"o" [letter]"t"_) [separator]" " [word](_[letter]"s" [letter]"u" [letter]"p" [letter]"p" [letter]"o" [letter]"r" [letter]"t" [letter]"e" [letter]"d"_) [separator]"."_)|) ~(_let @k1 ~(_f @yn_)_) ~(_let @k2 ~(_f ~(_::pl:: @yn ~(_::ti:: @h ~(_::ov:: @k1 %2_)_)_)_)_) ~(_let @k3 ~(_f ~(_::pl:: @yn ~(_::ti:: @h ~(_::ov:: @k2 %2_)_)_)_)_) ~(_let @k4 ~(_f ~(_::pl:: @yn ~(_::ti:: @h @k3_)_)_)_) ~(|::pl:: @yn ~(|::ti:: ~(_::ov:: %1 %6_) @h ~(|::pl:: @k1 ~(_::ti:: %2 @k2_) ~(_::ti:: %2 @k3_) @k4|)|)|)|)_) ~(_bind @runge-kutta-vector &" f& yn h%"(|[doc](|[line](_[word](_[letter]"C" [letter]"a" [letter]"l" [letter]"c" [letter]"u" [letter]"l" [letter]"a" [letter]"t" [letter]"e" [letter]"s"_) [separator]" " [word](_[letter]"n" [letter]"e" [letter]"x" [letter]"t"_) [separator]" " [word](_[letter]"v" [letter]"a" [letter]"l" [letter]"u" [letter]"e"_) [separator]" " [word](_[letter]"o" [letter]"f"_) [separator]" " [word](_[letter]"f"_) [separator]" " [word](_[letter]"a" [letter]"k" [letter]"a"_) [separator]" " [word](_[letter]"d" [letter]"v" [letter]"d" [letter]"t"_) [separator]"," [separator]" " [word](_[letter]"g" [letter]"i" [letter]"v" [letter]"e" [letter]"n"_) [separator]" " [word](_[letter]"y" [letter]"s" [letter]"u" [letter]"b" [letter]"m"_) [separator]" " [separator]"-" [separator]" " [word](_[letter]"a" [letter]"k" [letter]"a"_) [separator]" " [word](_[letter]"v" [letter]"s" [letter]"u" [letter]"b" [letter]"m"_) [separator]" " [separator]"-" [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"e" [letter]"p"_) [separator]" " [word](_[letter]"v" [letter]"a" [letter]"l" [letter]"u" [letter]"e"_) [separator]" " [word](_[letter]"o" [letter]"f"_) [separator]" " [word](_[letter]"h"_) [separator]"." [separator]" " [word](_[letter]"y" [letter]"s" [letter]"u" [letter]"b" [letter]"n"_) [separator]" " [word](_[letter]"s" [letter]"h" [letter]"o" [letter]"u" [letter]"l" [letter]"d"_) [separator]" " [word](_[letter]"b" [letter]"e"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"V" [letter]"e" [letter]"c" [letter]"t" [letter]"o" [letter]"r" [letter]"3" [letter]"d"_)_)|) ~(_let @k1 ~(_f @yn_)_) ~(_let @k2 ~(_f ~(_@<`add`>yn ~(_~(_<`scale`>@<`scale`>k1 %0.5_) @h_)_)_)_) ~(_let @k3 ~(_f ~(_@<`add`>yn ~(_~(_<`scale`>@<`scale`>k2 %0.5_) @h_)_)_)_) ~(_let @k4 ~(_f ~(_@<`add`>yn ~(_@<`scale`>k3 @h_)_)_)_) ~(|@<`add`>yn ~(|~(|<`scale`>vector:add-3d @k1 ~(_@<`scale`>k2 %0.5_) ~(_@<`scale`>k3 %0.5_) @k4|) ~(_::ti:: ~(_::ov:: %1 %6_) @h_)|)|)|)_) ~(_bind @lorenz &" v h%"(|[doc](|[line](_[word](_[letter]"v"_) [separator]" " [word](_[letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"i" [letter]"n" [letter]"i" [letter]"t" [letter]"i" [letter]"a" [letter]"l"_) [separator]" " [word](_[letter]"c" [letter]"o" [letter]"n" [letter]"d" [letter]"i" [letter]"t" [letter]"i" [letter]"o" [letter]"n"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"h"_) [separator]" " [word](_[letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"e" [letter]"p"_)_)|) ~(_let @dxdt &" v"(|~(_let @sigma %10_) ~(_let @rho %28_) ~(_let @beta ~(_::ov:: %8 %3_)_) ~(_let @xval ~(_::ti:: @sigma ~(_- @<`y`>v @<`x`>v_)_)_) ~(_let @yval ~(_- ~(_::ti:: @<`x`>v ~(_- @rho @<`z`>v_)_) @<`y`>v_)_) ~(_let @zval ~(_- ~(_::ti:: @<`x`>v @<`y`>v_) ~(_::ti:: @beta @<`z`>v_)_)_) ~(_instantiate [nil]<`Vector3d`> @xval @yval @zval_)|)_) ~(_runge-kutta-vector @dxdt @v @h_)|)_)|)v2:~(|begin ~(_import @style-functions_) ~(_let @start [doc](|~(|begin ~(_import @fx-functions_) ~(_ff-with ~(_make-pending ~(_load @poems_)_) &" data"(|~(_bind @poems @data_)|)_) ~(_ff-with ~(_make-pending ~(_load @poems_)_) &" data"(|~(_bind @poems @data_)|)_) ~(_ff-with ~(_make-pending ~(_load @poems_)_) &" data"(|~(_bind @poems @data_)|)_)|) ~(|begin ~(_cancel-ff _) ~(_chop @left-frame_) ~(|cram ~(_dofunction ~(_car @poems_)_) @left-frame|)|)|)_) ~(_bind @setup &(|~(_let @fw #795_) ~(_bind @left-frame ~(_style:with-width-of [doc](|!no|) @fw_)_) ~(_bind @right-frame ~(_style:with-scrollbars-on ~(_style:with-width-of ~(_style:with-height-of @start #900_) @fw_)_)_) ~(_bind @frame ~(_cram @left-frame ~(_cram @right-frame [line](__)_)_)_)|)_) ~(_quote ~(_setup _)_)|)v2:~(|begin ~(_import @style-functions_) ~(_let @start [doc](|~(|begin ~(_import @fx-functions_) ~(_ff-with ~(_load @poems_) &" data"(|~(_bind @poems @data_)|)_)|) ~(|begin ~(_cancel-ff _) ~(_chop @left-frame_) ~(|cram ~(_dofunction ~(_car @poems_)_) @left-frame|)|)|)_) ~(_bind @setup &(|~(_let @fw #795_) ~(_bind @left-frame ~(_style:with-width-of [doc](|!no|) @fw_)_) ~(_bind @right-frame ~(_style:with-scrollbars-on ~(_style:with-width-of ~(_style:with-height-of @start #900_) @fw_)_)_) ~(_bind @frame ~(_cram @left-frame ~(_cram @right-frame [line](__)_)_)_)|)_) ~(_quote ~(_setup _)_)|)v2:~(|begin ~(_bind @right-content [doc](|~(|run ~(_menu _) ~(_change-letter-function &" letter"(|~(_start-changing-background @letter_)|)_) ~(_change-poem [doc](|[line](_[word](_[letter]"A"_) [letter]" " [word](_[letter]"r" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"w" [letter]"h" [letter]"e" [letter]"e" [letter]"l" [letter]"b" [letter]"a" [letter]"r" [letter]"r" [letter]"o" [letter]"w"_)_) [line](_[nil] [word](_[letter]"w" [letter]"i" [letter]"t" [letter]"h"_) [letter]" " [word](_[letter]"a"_) [letter]" " [word](_[letter]"b" [letter]"o" [letter]"o" [letter]"m"_) [letter]" " [word](_[letter]"b" [letter]"o" [letter]"x"_) [letter]" " [word](_[letter]"i" [letter]"n"_) [letter]" " [word](_[letter]"i" [letter]"t"_) [letter]"."_) [line](_[nil] [word](_[letter]"B" [letter]"a" [letter]"t" [letter]"t" [letter]"e" [letter]"r" [letter]"i" [letter]"e" [letter]"s"_)_) [line](_[nil] [word](_[letter]"a" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"i" [letter]"m" [letter]"p" [letter]"o" [letter]"r" [letter]"t" [letter]"a" [letter]"n" [letter]"t"_) [letter]"."_)|)_) [doc](|[line](_[word](_[letter]"l" [letter]"i" [letter]"v" [letter]"e" [letter]"c" [letter]"o" [letter]"d" [letter]"e"_) [letter]" " [word](_[letter]"n" [letter]"y" [letter]"c"_)_) [line](_[nil] [word](_[letter]"a" [letter]"l" [letter]"l"_) [letter]" " [letter]"-" [word](_[letter]"l" [letter]"i" [letter]"v" [letter]"e"_) [letter]" " [word](_[letter]"v" [letter]"i" [letter]"s" [letter]"u" [letter]"a" [letter]"l" [letter]"s"_) [letter]" " [letter]"-" [letter]" " [word](_[letter]"i" [letter]"m" [letter]"p" [letter]"r" [letter]"o" [letter]"v" [letter]"i" [letter]"s" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"w" [letter]"o" [letter]"r" [letter]"d" [letter]"s"_) [letter]" " [letter]"-" [letter]" " [word](_[letter]"p" [letter]"r" [letter]"e" [letter]"r" [letter]"e" [letter]"c" [letter]"o" [letter]"r" [letter]"d" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"s" [letter]"o" [letter]"u" [letter]"n" [letter]"d" [letter]"s"_) [letter]" " [letter]"-" [letter]" " [word](_[letter]"b" [letter]"y"_) [letter]" " [word](_[letter]"e" [letter]"e" [letter]"e" [letter]"e" [letter]"a" [letter]"a" [letter]"i" [letter]"i"_)_)|)|)|)_) ~(_import @perf1-library_) ~(_bind @setup &(|~(_let @fw #800_) ~(_bind @frame ~(_width [doc](|[line](_[word](__)_)|) @fw_)_) ~(_bind @code ~(_width @right-content @fw_)_) ~(_bind @everything ~(_cram @frame ~(_cram @code [line](__)_)_)_)|)_) *(_~(_setup _)_)|)v2:~(|run ~(_bind @menu &(|[doc](|@start-changing-background @start-osc-alpha @start-osc-hue @start-osc-hue-change-bg|)|)_) ~(_bind @help @menu_) ~(_bind @start-changing-background &" nex"(|~(|do-on-every &" n"(|~(_random-background-color @n_)|) @nex ~(_fudge-interval #100_)|)|)_) ~(_bind @start-osc-alpha &" letter"(|~(|do-with-param-on-every &" letter param"(|~(_alpha @letter ~(_::pl:: %0.5 ~(_::ti:: %0.5 ~(_sin ~(_to-float @param_)_)_)_)_)|) @letter ~(_fudge-interval #100_)|)|)_) ~(_bind @start-osc-hue &" letter"(|~(|do-with-param-on-every &" letter param"(|~(_let @h ~(_modulo @param #256_)_) ~(|set-nex-style $"color" ~(_string-cat $"hsl(" ~(_to-string @h_) $", 50%, 50%)"_) @letter|)|) @letter ~(_fudge-interval #100_)|)|)_) ~(_bind @start-osc-hue-change-bg &" letter"(|~(|do-with-param-on-every &" nex param"(|~(_let @h ~(_modulo @param #256_)_) ~(_let @ss ~(|string-cat $"color:" ~(_string-cat $"hsl(" ~(_to-string @h_) $", 50%, 50%)"_) $";" $"background-color:" ~(_string-cat $"rgb(" ~(_to-string ~(_random-in-between #0 #255_)_) $"," ~(_to-string ~(_random-in-between #0 #255_)_) $"," ~(_to-string ~(_random-in-between #0 #255_)_) $")"_)|)_) ~(_apply-style-to @ss @nex_)|) @letter ~(_fudge-interval #100_)|)|)_) ~(|bind @change-poem &" poem"(|~(_ff-stop _) ~(_chop @frame_) ~(_cram ~(_format-poem @poem_) @frame_)|)|) ~(|bind @letter-function &" letter"(|~(_start-changing-background @letter_)|)|) ~(|bind @format-poem &" poem"(|~(|do-for-each-letter @letter-function ~(_justify-doc @poem #799_)|)|)|) ~(|bind @change-letter-function &" f"(|~(|bind @letter-function @f|)|)|) ~(_bind @poems [doc](|[doc](|[line](_[word](_[letter]"A"_) [letter]" " [word](_[letter]"r" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"w" [letter]"h" [letter]"e" [letter]"e" [letter]"l" [letter]"b" [letter]"a" [letter]"r" [letter]"r" [letter]"o" [letter]"w"_)_) [line](_[nil] [word](_[letter]"w" [letter]"i" [letter]"t" [letter]"h"_) [letter]" " [word](_[letter]"a"_) [letter]" " [word](_[letter]"b" [letter]"o" [letter]"o" [letter]"m"_) [letter]" " [word](_[letter]"b" [letter]"o" [letter]"x"_) [letter]" " [word](_[letter]"i" [letter]"n"_) [letter]" " [word](_[letter]"i" [letter]"t"_) [letter]"."_) [line](_[nil] [word](_[letter]"B" [letter]"a" [letter]"t" [letter]"t" [letter]"e" [letter]"r" [letter]"i" [letter]"e" [letter]"s"_)_) [line](_[nil] [word](_[letter]"a" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"i" [letter]"m" [letter]"p" [letter]"o" [letter]"r" [letter]"t" [letter]"a" [letter]"n" [letter]"t"_) [letter]"."_)|)|)_) ~(_import @style-functions_) ~(_import @util-functions_) ~(_import @string-functions_) ~(_import @animation-functions_) ~(_import @layout-functions_) ~(_bind @do-for-each-line &" f doc"(|~(|move-contents-to-doc ~(_do-for-each @f @doc_)|)|)_) ~(_bind @do-for-each-letter &" f doc"(|~(|move-contents-to-doc ~(_do-for-each &" line"(|~(_let @dst ~(_apply-style-to ~(_get-style-from @line_) [word](__)_)_) ~(_do-for-each-and-put-in @f @line @dst_)|) @doc_)|)|)_)|)v2:~(|begin ~(_import @perf2-library_) ~(_let @start [doc](|~(|begin ~(_use @perf2_) ~(_use @util_) ~(_use @layout_) ~(_use @style_) ~(_use @string_) ~(_use @animation_) ~(_use @math_)|) ~(|run ~(|cram ~(|layout:justify-doc-to-width-with-format-of ~(_car @poems_) #790 &" n"(|~(_style:with-font ~(_style:with-light-weight ~(_style:uppercased @n_)_) $"Helvetica"_)|)|) @left-frame|)|)|)_) ~(_bind @setup &(|~(_let @fw #795_) ~(_bind @left-frame ~(_style:with-width-of [doc](||) @fw_)_) ~(_bind @right-frame ~(_style:with-scrollbars-on ~(_style:with-width-of ~(_style:with-height-of @start #900_) @fw_)_)_) ~(_bind @frame ~(_cram @left-frame ~(_cram @right-frame [line](__)_)_)_)|)_) ~(_quote ~(_setup _)_)|)v2:~(|package @perf2 ~(_import @style-functions_) ~(_import @util-functions_) ~(_import @string-functions_) ~(_import @animation-functions_) ~(_import @layout-functions_) ~(_import @math-functions_) ~(_bind @help &(|[doc](|@start-changing-background @start-osc-alpha @start-osc-hue @start-osc-hue-change-bg|)|)_) ~(_bind @flyin-at-frame-rate &" n speed"(|~(|animation:do-with-param-on-every @flyin-function @n @speed|)|)_) ~(_bind @flyin-function &" n p"(|~(_let @percentcomplete ~(_math:min %1 ~(_::ov:: ~(_to-float @p_) %100_)_)_) ~(_let @unscaledrandomx ~(_- ~(_::ti:: ~(_random _) %400_) %200_)_) ~(_let @unscaledrandomy ~(_- ~(_::ti:: ~(_random _) %400_) %200_)_) ~(_let @scalefactor ~(_power ~(_- %1 @percentcomplete_) %0.5_)_) ~(_let @translatex ~(_::ti:: @unscaledrandomx @scalefactor_)_) ~(_let @translatey ~(_::ti:: @unscaledrandomy @scalefactor_)_) ~(_style:with-translate-x-y @n @translatex @translatey_)|)_) ~(_bind @starting-format &" n"(|~(|justify-doc-to-width-with-format-of @n #790 &" n"(|~(_with-font ~(_with-light-weight @n_) $"Helvetica"_)|)|)|)_) ~(_bind @do-for-each-line &" f doc"(|~(_use @util_) ~(|traverse-items-satisfying-and-do @doc &" n"(|~(_is-line @n_)|) @f|)|)_) ~(_bind @do-for-each-word &" f doc"(|~(_use @util_) ~(|traverse-items-satisfying-and-do @doc &" n"(|~(_is-word @n_)|) @f|)|)_) ~(_bind @do-for-each-letter &" f doc"(|~(_use @util_) ~(|traverse-items-satisfying-and-do @doc &" n"(|~(_is-letter @n_)|) @f|)|)_) ~(_bind @do-for-each-letter-or-separator &" f doc"(|~(_use @util_) ~(|traverse-items-satisfying-and-do @doc &" n"(|~(|or ~(_is-letter @n_) ~(_is-separator @n_)|)|) @f|)|)_) ~(_bind @do-for-each-expectation &" f doc"(|~(_use @util_) ~(|traverse-items-satisfying-and-do @doc &" n"(|~(_is-expectation @n_)|) @f|)|)_) ~(_bind @poems [doc](|[doc](|[line](_[word](_[letter]"W" [letter]"e"_) [letter]" " [word](_[letter]"s" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"H" [letter]"a" [letter]"l"_) [letter]"-" [word](_[letter]"A" [letter]"n"_) [letter]"-" [word](_[letter]"T" [letter]"o" [letter]"w"_)_) [line](_[nil] [word](_[letter]"e" [letter]"v" [letter]"e" [letter]"r" [letter]"y"_) [letter]" " [word](_[letter]"n" [letter]"i" [letter]"g" [letter]"h" [letter]"t"_) [letter]" " [word](_[letter]"f" [letter]"r" [letter]"o" [letter]"m"_) [letter]" " [word](_[letter]"o" [letter]"u" [letter]"r"_) [letter]" " [word](_[letter]"w" [letter]"i" [letter]"n" [letter]"d" [letter]"o" [letter]"w" [letter]"s"_) [letter]","_) [line](_[nil] [word](_[letter]"b" [letter]"a" [letter]"n" [letter]"g" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"o" [letter]"u" [letter]"r"_) [letter]" " [word](_[letter]"c" [letter]"h" [letter]"e" [letter]"s" [letter]"t" [letter]"s"_) [letter]","_) [line](_[nil] [word](_[letter]"o" [letter]"u" [letter]"r"_) [letter]" " [word](_[letter]"p" [letter]"o" [letter]"t" [letter]"s"_) [letter]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"p" [letter]"a" [letter]"n" [letter]"s"_) [letter]","_) [line](_[nil] [word](_[letter]"d" [letter]"e" [letter]"s" [letter]"p" [letter]"e" [letter]"r" [letter]"a" [letter]"t" [letter]"e"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " [word](_[letter]"l" [letter]"i" [letter]"v" [letter]"e"_) [letter]","_) [line](_[nil] [word](_[letter]"d" [letter]"e" [letter]"s" [letter]"p" [letter]"e" [letter]"r" [letter]"a" [letter]"t" [letter]"e"_)_) [line](_[nil] [word](_[letter]"f" [letter]"o" [letter]"r"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"s" [letter]"u" [letter]"m" [letter]"m" [letter]"e" [letter]"r"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " [word](_[letter]"c" [letter]"o" [letter]"m" [letter]"e"_) [letter]"."_)|) [doc](|[line](_[word](_[letter]"W" [letter]"e"_) [letter]" " [word](_[letter]"s" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"H" [letter]"a" [letter]"l"_) [letter]"-" [word](_[letter]"A" [letter]"n"_) [letter]"-" [word](_[letter]"T" [letter]"o" [letter]"w"_)_) [line](_[nil] [word](_[letter]"E" [letter]"v" [letter]"e" [letter]"r" [letter]"y"_) [letter]" " [word](_[letter]"n" [letter]"i" [letter]"g" [letter]"h" [letter]"t"_) [letter]" " [word](_[letter]"f" [letter]"r" [letter]"o" [letter]"m"_) [letter]" " [word](_[letter]"o" [letter]"u" [letter]"r"_) [letter]" " [word](_[letter]"w" [letter]"i" [letter]"n" [letter]"d" [letter]"o" [letter]"w" [letter]"s"_) [letter]","_) [line](_[nil] [word](_[letter]"B" [letter]"a" [letter]"n" [letter]"g" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"o" [letter]"u" [letter]"r"_) [letter]" " [word](_[letter]"c" [letter]"h" [letter]"e" [letter]"s" [letter]"t" [letter]"s"_) [letter]"," [letter]" " [word](_[letter]"o" [letter]"u" [letter]"r"_) [letter]" " [word](_[letter]"p" [letter]"o" [letter]"t" [letter]"s"_) [letter]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"p" [letter]"a" [letter]"n" [letter]"s"_) [letter]","_) [line](_[nil] [word](_[letter]"D" [letter]"e" [letter]"s" [letter]"p" [letter]"e" [letter]"r" [letter]"a" [letter]"t" [letter]"e"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " [word](_[letter]"l" [letter]"i" [letter]"v" [letter]"e"_) [letter]","_) [line](_[nil] [word](_[letter]"D" [letter]"e" [letter]"s" [letter]"p" [letter]"e" [letter]"r" [letter]"a" [letter]"t" [letter]"e"_)_) [line](_[nil] [word](_[letter]"f" [letter]"o" [letter]"r"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"s" [letter]"u" [letter]"m" [letter]"m" [letter]"e" [letter]"r"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " [word](_[letter]"c" [letter]"o" [letter]"m" [letter]"e"_) [letter]"."_)|)|)_)|)v2:~(|begin ~(_import @style-functions_) ~(_import @util-functions_) ~(_bind @justify-doc &" doc size"(|~(_let @newdoc [doc](||)_) ~(_do-for-each &" line"(|~(_let @f ~(_font ~(_light ~(_flatten @line_)_) $"Helvetica"_)_) ~(_set @newdoc ~(_cons ~(_resize-to-target @f @size_) @newdoc_)_)|) @doc_) @newdoc|)_) ~(_bind @resize-to-target &" phrase target"(|~(_let @size ~(_find-best-font @phrase @target_)_) ~(_text-size @phrase @size_)|)_) ~(_bind @do-for-each &" f lst"(|~(|if ~(_is-empty @lst_) [word](__) ~(_cons ~(_@f ~(_car @lst_)_) ~(_do-for-each @f ~(_cdr @lst_)_)_)|)|)_) ~(_bind @range &" start end"(|~(|if ~(_::gt:: @start @end_) [word](__) ~(_cons @start ~(_range ~(_::pl:: @start #1_) @end_)_)|)|)_) ~(_bind @make-width-lookup &" list"(|~(|if ~(_is-empty @list_) [word](__) ~(|begin ~(_let @first ~(_car @list_)_) ~(_let @width ~(_run-js $"$dom[0].getBoundingClientRect().width" @first_)_) ~(_cons ~(_cons @first ~(_cons @width [word](__)_)_) ~(_make-width-lookup ~(_cdr @list_)_)_)|)|)|)_) ~(_bind @lookup &" nex table"(|~(_let @r [nil]_) ~(_do-for-each &" entry"(|~(_let @key ~(_car @entry_)_) ~(|if ~(_equal @key @nex_) ~(_set @r ~(_car ~(_cdr @entry_)_)_) [nil]|)|) @table_) @r|)_) ~(_bind @total-in-font &" phrase font-list-entry"(|~(_let @lookup-table ~(_car ~(_cdr @font-list-entry_)_)_) ~(_let @sum #0_) ~(_do-for-each &" letter"(|~(_let @width ~(_lookup @letter @lookup-table_)_) ~(|if ~(_equal @width [nil]_) [nil] ~(_set @sum ~(_::pl:: @sum @width_)_)|)|) @phrase_) @sum|)_) ~(_bind @calculate-all-widths &" phrase all-lookups"(|~(_do-for-each &" lookup"(|~(_let @font ~(_car @lookup_)_) ~(_let @total ~(_total-in-font @phrase @lookup_)_) ~(_cons @font ~(_cons @total [word](__)_)_)|) @all-lookups_)|)_) ~(_bind @find-best-font &" phrase targetwidth"(|~(_let @widthmap ~(_calculate-all-widths @phrase @lettermap_)_) ~(_let @best ~(_car ~(_car @widthmap_)_)_) ~(_let @find-it &" target prevsize map"(|~(|if ~(_is-empty @map_) @prevsize ~(|begin ~(_let @mapentry ~(_car @map_)_) ~(_let @fontsize ~(_car @mapentry_)_) ~(_let @width-in-font ~(_car ~(_cdr @mapentry_)_)_) ~(|if ~(_::gt:: @width-in-font @target_) @prevsize ~(_find-it @target @fontsize ~(_cdr @map_)_)|)|)|)|)_) ~(_find-it @targetwidth @best @widthmap_)|)_) [doc](|[doc](|[line](_[word](_[letter]"d" [letter]"o"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"f" [letter]"o" [letter]"l" [letter]"l" [letter]"o" [letter]"w" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"f" [letter]"i" [letter]"r" [letter]"s" [letter]"t"_) [letter]"-" [letter]" " [word](_[letter]"r" [letter]"e" [letter]"t" [letter]"r" [letter]"i" [letter]"e" [letter]"v" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"f" [letter]"o" [letter]"n" [letter]"t"_) [letter]" " [word](_[letter]"s" [letter]"i" [letter]"z" [letter]"e"_) [letter]" " [word](_[letter]"d" [letter]"o" [letter]"e" [letter]"s" [letter]"n" [letter]"'" [letter]"t"_) [letter]" " [word](_[letter]"w" [letter]"o" [letter]"r" [letter]"k"_) [letter]" " [word](_[letter]"u" [letter]"n" [letter]"t" [letter]"i" [letter]"l"_) [letter]" " [word](_[letter]"i" [letter]"t" [letter]"'" [letter]"s"_) [letter]" " [word](_[letter]"b" [letter]"e" [letter]"e" [letter]"n"_)_) [line](_[nil] [word](_[letter]"r" [letter]"e" [letter]"n" [letter]"d" [letter]"e" [letter]"r" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"o" [letter]"n"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"s" [letter]"c" [letter]"r" [letter]"e" [letter]"e" [letter]"n"_) [letter]" " [letter]" " [letter]"-" [letter]" " [word](_[letter]"l" [letter]"o" [letter]"o" [letter]"k" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " [word](_[letter]"f" [letter]"i" [letter]"x"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [letter]"-" [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e" [letter]"n"_) [letter]" " [word](_[letter]"p" [letter]"a" [letter]"s" [letter]"t" [letter]"e"_) [letter]" " [word](_[letter]"i" [letter]"n"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"b" [letter]"i" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"e" [letter]"x" [letter]"p" [letter]"r"_) [letter]" " [word](_[letter]"b" [letter]"e" [letter]"l" [letter]"o" [letter]"w"_) [letter]"."_)|) ~(_do-for-each &" n"(|~(_cons @n ~(_cons ~(_font ~(_light ~(_text-size [word](_[letter]"A" [letter]"B" [letter]"C" [letter]"D" [letter]"E" [letter]"F" [letter]"G" [letter]"H" [letter]"I" [letter]"J" [letter]"K" [letter]"L" [letter]"M" [letter]"N" [letter]"O" [letter]"P" [letter]"Q" [letter]"R" [letter]"S" [letter]"T" [letter]"U" [letter]"V" [letter]"W" [letter]"X" [letter]"Y" [letter]"Z" [letter]" " [letter]";" [letter]"," [letter]":" [letter]"?" [letter]"'" [letter]{"} [letter]"." [letter]"," [letter]"a" [letter]"b" [letter]"c" [letter]"d" [letter]"e" [letter]"f" [letter]"g" [letter]"h" [letter]"i" [letter]"j" [letter]"k" [letter]"l" [letter]"m" [letter]"n" [letter]"o" [letter]"p" [letter]"q" [letter]"r" [letter]"s" [letter]"t" [letter]"u" [letter]"v" [letter]"w" [letter]"x" [letter]"y" [letter]"z"_) @n_)_) $"Helvetica"_) [word](__)_)_)|) ~(_range #8 #40_)_) ~(_bind @lettermap ~(_do-for-each &" item"(|~(_let @list ~(_car ~(_cdr @item_)_)_) ~(_let @size ~(_car @item_)_) ~(_cons @size ~(_cons ~(_make-width-lookup @list_) [word](__)_)_)|) [doc](|[line](_[word](_[letter]"i" [letter]"t" [letter]"e" [letter]"m" [letter]"s"_) [letter]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_)|)_)_)|)|)v2:(|~(_import @animation-functions_) ~(_animation:osc-pfont [doc](|[line](_[word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"q" [letter]"u" [letter]"i" [letter]"c" [letter]"k"_) [separator]" " [word](_[letter]"b" [letter]"r" [letter]"o" [letter]"w" [letter]"n"_) [separator]" " [word](_[letter]"f" [letter]"o" [letter]"x"_) [separator]" " [word](_[letter]"j" [letter]"u" [letter]"m" [letter]"p" [letter]"s"_) [separator]" " [word](_[letter]"o" [letter]"v" [letter]"e" [letter]"r"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"l" [letter]"a" [letter]"z" [letter]"y"_) [separator]" " [word](_[letter]"d" [letter]"o" [letter]"g"_) [separator]"."_)|) &" val"(|~(|string-cat $"basic##corpus:" ~(_to-string @val_) $|)|) %0.1 %0.6_)|)v2:~(|run ~(_import @style-functions_) ~(_import @util-functions_) ~(_import @string-functions_) ~(_import @animation-functions_) ~(_import @layout-functions_)|)v2:~(|with-imports @style-functions @math-functions @animation-functions ~(|begin ~(_load-web-font $"Righteous"_) ~(_bind @format &"s"(|~(_style:with-padding-of ~(_style:with-font @s $"Righteous"_) #100_)|)_) ~(_bind @randomoffset &"n"(|~(_let @small #98_) ~(_let @large #103_) ~(_let @n ~(_style:with-left-padding-of @n ~(_math:random-from-to @small @large_)_)_) ~(_let @n ~(_style:with-right-padding-of @n ~(_math:random-from-to @small @large_)_)_) ~(_let @n ~(_style:with-top-padding-of @n ~(_math:random-from-to @small @large_)_)_) ~(_let @n ~(_style:with-bottom-padding-of @n ~(_math:random-from-to @small @large_)_)_) @n|)_) ~(_bind @sentence ~(_format [doc]"padding-left:50px;padding-top:50px;font-size:30px;font-family:Righteous;padding-bottom:50px;padding-right:50px"(|[line](_[word](_[letter]"W" [letter]"h" [letter]"e" [letter]"n"_) [separator]" " [word](_[letter]"I"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"l" [letter]"i" [letter]"e" [letter]"v" [letter]"e" [letter]"d"_) [separator]","_) [line](_[word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"s" [letter]"m" [letter]"e" [letter]"l" [letter]"l" [letter]"e" [letter]"d"_) [separator]" " [word](_[letter]"m" [letter]"i" [letter]"n" [letter]"t"_)_) [line](_[word](_[letter]"a" [letter]"m" [letter]"o" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"r" [letter]"o" [letter]"u" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"o" [letter]"n" [letter]"e" [letter]"s"_)_) [line](_[word](_[letter]"i" [letter]"t"_) [separator]" " [word](_[letter]"f" [letter]"e" [letter]"l" [letter]"t"_) [separator]" " [word](_[letter]"l" [letter]"i" [letter]"k" [letter]"e"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e" [letter]"r" [letter]"e"_) [separator]" " [word](_[letter]"w" [letter]"a" [letter]"s"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"p" [letter]"l" [letter]"a" [letter]"c" [letter]"e"_)_) [line](_[word](_[letter]"f" [letter]"o" [letter]"r"_) [separator]" " [word](_[letter]"m" [letter]"i" [letter]"s" [letter]"t" [letter]"a" [letter]"k" [letter]"e" [letter]"s"_) [separator]"."_) [line](_[word](_[letter]"B" [letter]"u" [letter]"t"_) [separator]" " [word](_[letter]"w" [letter]"e" [letter]"'" [letter]"v" [letter]"e"_) [separator]" " [word](_[letter]"s" [letter]"e" [letter]"e" [letter]"n"_)_) [line](_[word](_[letter]"w" [letter]"h" [letter]"e" [letter]"r" [letter]"e"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"a" [letter]"t"_) [separator]" " [word](_[letter]"h" [letter]"a" [letter]"s"_) [separator]" " [word](_[letter]"g" [letter]"o" [letter]"t" [letter]"t" [letter]"e" [letter]"n"_) [separator]" " [word](_[letter]"u" [letter]"s"_) [separator]"."_)|)_)_) ~(_bind @randomrot &"n"(|~(_style:rotate-by @n ~(_to-float ~(_math:random-from-to #-5 #5_)_)_)|)_) ~(_bind @manyrot &"n"(|~(_animation:do-on-every &" r"(|~(_randomoffset ~(_randomrot @r_)_)|) ~(_copy @n_) #100_)|)_) ~(_bind @do &(|~(_bind @allofthem ~(_copy ~(_set-nex-direction (,,) $"zdirectional"_)_)_) ~(_act ~(_animation:do-on-every &" n"(|~(_cram ~(_act ~(_manyrot @sentence_)_) @allofthem_)|) #0 #3000_)_) @allofthem|)_)|)|)v2:~(|begin ~(_import @animation-functions_) ~(_import @style-functions_) ~(_import @util-functions_) ~(_bind @random-left-margin &" nex"(|~(_style:with-left-padding-of @nex ~(_to-integer ~(_::ti:: %100 ~(_random _)_)_)_)|)_) ~(_bind @random-right-margin &" nex"(|~(_style:with-right-padding-of @nex ~(_to-integer ~(_::ti:: %100 ~(_random _)_)_)_)|)_) ~(_process [doc](|[line](_[word](_[letter]"T" [letter]"h" [letter]"e" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"a" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"c" [letter]"o" [letter]"n" [letter]"s" [letter]"e" [letter]"q" [letter]"u" [letter]"e" [letter]"n" [letter]"c" [letter]"e" [letter]"s"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " ~(_ff ~(_animation:do-on-every &" n"(_~(_random-left-margin @n_)_) [word](_[letter]"k" [letter]"n" [letter]"o" [letter]"w" [letter]"i" [letter]"n" [letter]"g"_) #500_)_)_) [line](_[nil] [word](_[letter]"t" [letter]"h" [letter]"e" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"a" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"c" [letter]"o" [letter]"n" [letter]"s" [letter]"e" [letter]"q" [letter]"u" [letter]"e" [letter]"n" [letter]"c" [letter]"e" [letter]"s"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " ~(_ff ~(_animation:do-on-every &" n"(_~(_random-left-margin @n_)_) [word](_[letter]"g" [letter]"u" [letter]"e" [letter]"s" [letter]"s" [letter]"i" [letter]"n" [letter]"g"_) #500_)_)_) [line](_[nil] ~(_ff ~(_animation:do-on-every &" n"(_~(_random-right-margin @n_)_) [word](_[letter]"d" [letter]"y" [letter]"i" [letter]"n" [letter]"g"_) #500_)_) [letter]" " [word](_[letter]"i" [letter]"s"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"c" [letter]"o" [letter]"n" [letter]"s" [letter]"e" [letter]"q" [letter]"u" [letter]"e" [letter]"n" [letter]"c" [letter]"e"_) [letter]" " [word](_[letter]"o" [letter]"f"_) [letter]" " [word](_[letter]"l" [letter]"i" [letter]"v" [letter]"i" [letter]"n" [letter]"g"_) [letter]" "_)|)_)|)v2:[doc](|[line](_[word](_[letter]"R" [letter]"u" [letter]"b" [letter]"b" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"o" [letter]"v" [letter]"e" [letter]"r"_) [letter]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"d" [letter]"o" [letter]"w" [letter]"n"_) [letter]" " [word](_[letter]"l" [letter]"i" [letter]"k" [letter]"e"_) [letter]" " [word](_[letter]"a"_) [letter]" " [word](_[letter]"w" [letter]"o" [letter]"r" [letter]"n"_) [letter]"-" [word](_[letter]"o" [letter]"u" [letter]"t"_) [letter]" " [word](_[letter]"e" [letter]"r" [letter]"a" [letter]"s" [letter]"e" [letter]"r"_) [letter]","_) [line](_[nil] [word](_[letter]"r" [letter]"o" [letter]"u" [letter]"n" [letter]"d" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"e" [letter]"d" [letter]"g" [letter]"e" [letter]"s"_) [letter]"," [letter]" " [word](_[letter]"n" [letter]"u" [letter]"m" [letter]"b" [letter]"e" [letter]"d"_) [letter]" " ~(_repeat-at-interval &" nex"(_~(_text-size @nex ~(_to-integer ~(_::pl:: %6 ~(_::ti:: %10 ~(_random _)_)_)_)_)_) [word](_[letter]"e" [letter]"x" [letter]"t" [letter]"r" [letter]"e" [letter]"m" [letter]"i" [letter]"t" [letter]"i" [letter]"e" [letter]"s"_) #250_) [letter]"," [letter]" " [word](_[letter]"i" [letter]"n" [letter]"s" [letter]"e" [letter]"n" [letter]"s" [letter]"i" [letter]"t" [letter]"i" [letter]"v" [letter]"e"_) [letter]","_) [line](_[nil] [word](_[letter]"a" [letter]"n" [letter]"o" [letter]"t" [letter]"h" [letter]"e" [letter]"r"_) [letter]" " [word](_[letter]"d" [letter]"a" [letter]"y"_) [letter]" " [word](_[letter]"i" [letter]"n"_) [letter]" " [word](_[letter]"p" [letter]"a" [letter]"r" [letter]"a" [letter]"d" [letter]"i" [letter]"s" [letter]"e"_) [letter]","_) [line](_[nil] [word](_[letter]"b" [letter]"e" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"w" [letter]"a" [letter]"i" [letter]"t" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"o" [letter]"n"_) [letter]" " [word](_[letter]"h" [letter]"a" [letter]"n" [letter]"d"_) ~(_repeat-at-interval &" nex"(__)_) [letter]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"f" [letter]"o" [letter]"o" [letter]"t"_) [letter]" " [word](_[letter]"b" [letter]"y"_) [letter]" " [word](_[letter]"w" [letter]"o" [letter]"m" [letter]"e" [letter]"n"_) [letter]" " [word](_[letter]"w" [letter]"e" [letter]"a" [letter]"r" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"f" [letter]"l" [letter]"o" [letter]"w" [letter]"e" [letter]"r" [letter]"s"_) [letter]","_) [line](_[nil] [word](_[letter]"b" [letter]"u" [letter]"t"_) [letter]" " [word](_[letter]"m" [letter]"o" [letter]"s" [letter]"t" [letter]"l" [letter]"y"_) [letter]" " [word](_[letter]"w" [letter]"o" [letter]"r" [letter]"r" [letter]"y" [letter]"i" [letter]"n" [letter]"g"_)_) [line](_[nil]_) [line](_[nil]_) ~(_bind @choose &" nth lst"(|~(_let @choosefunc_)|)_)|)v2:[doc](|~(_repeat-at-interval &" unused"(_~(|choose-one-randomly [doc](|~(_text-size ~(_font [line](_[word](_[letter]"H" [letter]"O" [letter]"L" [letter]"D"_) [letter]" " [word](_[letter]"M" [letter]"E"_) [letter]" " [word](_[letter]"I" [letter]"N"_) [letter]" " [word](_[letter]"Y" [letter]"O" [letter]"U" [letter]"R"_) [letter]" " [word](_[letter]"A" [letter]"R" [letter]"M" [letter]"S"_)_) $"Arial"_) #40_) ~(_text-size ~(_font [line](_[word](_[letter]"K" [letter]"E" [letter]"E" [letter]"P"_) [letter]" " [word](_[letter]"M" [letter]"E"_) [letter]" " [word](_[letter]"I" [letter]"N"_) [letter]" " [word](_[letter]"Y" [letter]"O" [letter]"U" [letter]"R"_) [letter]" " [word](_[letter]"T" [letter]"H" [letter]"O" [letter]"U" [letter]"G" [letter]"H" [letter]"T" [letter]"S"_)_) $"Arial"_) #40_)|)|)_) [nil] #150_) ~(_repeat-at-interval &" unused"(_~(|choose-one-randomly [doc](|~(_text-size ~(_font [line](_[word](_[letter]"D" [letter]"O" [letter]"N" [letter]"'" [letter]"T"_) [letter]" " [word](_[letter]"L" [letter]"E" [letter]"A" [letter]"V" [letter]"E"_) [letter]" " [word](_[letter]"M" [letter]"E"_)_) $"Arial"_) #40_) ~(_text-size ~(_font [line](_[word](_[letter]"L" [letter]"E" [letter]"T"_) [letter]" " [word](_[letter]"M" [letter]"E"_) [letter]" " [word](_[letter]"G" [letter]"O"_)_) $"Arial"_) #40_)|)|)_) [nil] #150_) ~(_repeat-at-interval &" unused"(_~(|choose-one-randomly [doc](|~(_text-size ~(_font [line](_[word](_[letter]"H" [letter]"O" [letter]"L" [letter]"D"_) [letter]" " [word](_[letter]"M" [letter]"E"_) [letter]" " [word](_[letter]"I" [letter]"N"_) [letter]" " [word](_[letter]"Y" [letter]"O" [letter]"U" [letter]"R"_) [letter]" " [word](_[letter]"A" [letter]"R" [letter]"M" [letter]"S"_)_) $"Arial"_) #40_) ~(_text-size ~(_font [line](_[word](_[letter]"K" [letter]"E" [letter]"E" [letter]"P"_) [letter]" " [word](_[letter]"M" [letter]"E"_) [letter]" " [word](_[letter]"I" [letter]"N"_) [letter]" " [word](_[letter]"Y" [letter]"O" [letter]"U" [letter]"R"_) [letter]" " [word](_[letter]"T" [letter]"H" [letter]"O" [letter]"U" [letter]"G" [letter]"H" [letter]"T" [letter]"S"_)_) $"Arial"_) #40_)|)|)_) [nil] #150_) ~(_repeat-at-interval &" unused"(_~(|choose-one-randomly [doc](|~(_text-size ~(_font [line](_[word](_[letter]"D" [letter]"O" [letter]"N" [letter]"'" [letter]"T"_) [letter]" " [word](_[letter]"L" [letter]"E" [letter]"A" [letter]"V" [letter]"E"_) [letter]" " [word](_[letter]"M" [letter]"E"_)_) $"Arial"_) #40_) ~(_text-size ~(_font [line](_[word](_[letter]"L" [letter]"E" [letter]"T"_) [letter]" " [word](_[letter]"M" [letter]"E"_) [letter]" " [word](_[letter]"G" [letter]"O"_)_) $"Arial"_) #40_)|)|)_) [nil] #150_) ~(_repeat-at-interval &" unused"(_~(|choose-one-randomly [doc](|~(_text-size ~(_font [line](_[word](_[letter]"I"_) [letter]" " [word](_[letter]"D" [letter]"O" [letter]"N" [letter]"'" [letter]"T"_) [letter]" " [word](_[letter]"W" [letter]"A" [letter]"N" [letter]"T"_) [letter]" " [word](_[letter]"T" [letter]"O"_) [letter]" " [word](_[letter]"D" [letter]"I" [letter]"E"_)_) $"Arial"_) #40_) ~(_text-size ~(_font [line](_[word](_[letter]"I"_) [letter]" " [word](_[letter]"D" [letter]"O" [letter]"N" [letter]"'" [letter]"T"_) [letter]" " [word](_[letter]"W" [letter]"A" [letter]"N" [letter]"T"_) [letter]" " [word](_[letter]"T" [letter]"O"_) [letter]" " [word](_[letter]"B" [letter]"E"_) [letter]" " [word](_[letter]"H" [letter]"E" [letter]"R" [letter]"E"_)_) $"Arial"_) #40_)|)|)_) [nil] #150_)|)v2:~(_sequence ~(_font [doc](|~(_text-size [line](_[word](_[letter]"G" [letter]"A" [letter]"R" [letter]"B" [letter]"A" [letter]"G" [letter]"E"_)_) #50_) ~(_text-size [line](_[nil] [word](_[letter]"I"_) [letter]" " [word](_[letter]"t" [letter]"o" [letter]"o" [letter]"k"_) [letter]" " [word](_[letter]"o" [letter]"u" [letter]"t"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_)_) #25_) ~(_text-size [line](_[word](_[letter]"G" [letter]"A" [letter]"R" [letter]"B" [letter]"A" [letter]"G" [letter]"E"_)_) #50_) ~(_text-size [line](_[nil] [word](_[letter]"I"_) [letter]" " [word](_[letter]"f" [letter]"e" [letter]"e" [letter]"l"_) [letter]" " [word](_[letter]"l" [letter]"i" [letter]"k" [letter]"e"_)_) #25_) ~(_text-size [line](_[word](_[letter]"G" [letter]"A" [letter]"R" [letter]"B" [letter]"A" [letter]"G" [letter]"E"_)_) #50_) ~(_text-size [line](_[nil] [word](_[letter]"I"_) [letter]" " [word](_[letter]"s" [letter]"m" [letter]"e" [letter]"l" [letter]"l"_) [letter]" " [word](_[letter]"l" [letter]"i" [letter]"k" [letter]"e"_)_) #25_) ~(_text-size [line](_[word](_[letter]"G" [letter]"A" [letter]"R" [letter]"B" [letter]"A" [letter]"G" [letter]"E"_)_) #50_) ~(_text-size [line](_[nil] [word](_[letter]"I"_) [letter]" " [word](_[letter]"e" [letter]"a" [letter]"t"_)_) #25_) ~(_text-size [line](_[word](_[letter]"G" [letter]"A" [letter]"R" [letter]"B" [letter]"A" [letter]"G" [letter]"E"_)_) #50_) ~(_text-size [line](_[nil] [word](_[letter]"M" [letter]"y"_) [letter]" " [word](_[letter]"l" [letter]"i" [letter]"f" [letter]"e"_) [letter]" " [word](_[letter]"i" [letter]"s"_)_) #25_)|) $"Arial"_) #500_)v2:~(|begin ~(_bind @try-until-same &" desired"(|~(_repeat-at-interval &" lasttry"(|~(|if ~(_equal @desired @lasttry_) @desired ~(_choose-one-randomly [word](_[letter]"A" [letter]"B" [letter]"C" [letter]"D" [letter]"E" [letter]"F" [letter]"G" [letter]"H" [letter]"I" [letter]"J" [letter]"K" [letter]"L" [letter]"M" [letter]"N" [letter]"O" [letter]"P" [letter]"Q" [letter]"R" [letter]"S" [letter]"T" [letter]"U" [letter]"V" [letter]"W" [letter]"X" [letter]"Y" [letter]"Z"_)_)|)|) [letter]"-" #50_)|)_) ~(_bind @try-all-until-same &" nex"(|~(_let @f ~(_flatten @nex_)_) ~(_let @do-letters &" lst"(|~(|if ~(_is-empty @lst_) [word](__) ~(_cons ~(_try-until-same ~(_car @lst_)_) ~(_do-letters ~(_cdr @lst_)_)_)|)|)_) ~(_do-letters @f_)|)_)|)v2:~(|padding-left ~(|text-size ~(|font [doc](|[line](_[word](_[letter]"T" [letter]"h" [letter]"e" [letter]"s" [letter]"e"_) [letter]" " [word](_[letter]"l" [letter]"i" [letter]"v" [letter]"e" [letter]"s"_) [letter]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [letter]" " [word](_[letter]"a" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"a" [letter]"s" [letter]"k" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"m" [letter]"e"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " [word](_[letter]"l" [letter]"e" [letter]"a" [letter]"d"_) [letter]":"_) [line](_[nil] [word](_[letter]"T" [letter]"h" [letter]"e" [letter]"s" [letter]"e"_) [letter]" " ~(_background-color ~(_text-color [word](_[letter]"m" [letter]"o" [letter]"r" [letter]"n" [letter]"i" [letter]"n" [letter]"g" [letter]"s"_) $"#ffffff"_) $"#000000"_) [letter]"."_) [line](_[nil] [word](_[letter]"W" [letter]"h" [letter]"a" [letter]"t"_) [letter]" " [word](_[letter]"a" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e" [letter]"y"_) [letter]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [letter]" " ~(_cycle [word](_~(_flatten [line](_[word](_[letter]"w" [letter]"h" [letter]"o"_) [letter]" " [word](_[letter]"a" [letter]"m"_) [letter]" " [word](_[letter]"I"_)_)_) ~(_flatten [line](_[word](_[letter]"w" [letter]"h" [letter]"o"_) [letter]" " [word](_[letter]"a" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"y" [letter]"o" [letter]"u"_)_)_) ~(_flatten [line](_[word](_[letter]"I"_) [letter]" " [word](_[letter]"a" [letter]"m"_) [letter]" " [word](_[letter]"w" [letter]"h" [letter]"o"_)_)_)_) #200_) [letter]"?" [letter]" "_) [line](_[word](_[letter]"T" [letter]"h" [letter]"e" [letter]"s" [letter]"e"_) [letter]" " [word](_[letter]"a" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"g" [letter]"r" [letter]"o" [letter]"a" [letter]"n" [letter]"s"_) [letter]"."_) [line](_[nil] [word](_[letter]"T" [letter]"h" [letter]"i" [letter]"s"_) [letter]" " [word](_[letter]"i" [letter]"s"_) [letter]" " [word](_[letter]"a"_) [letter]" " [word](_[letter]"m" [letter]"e" [letter]"t" [letter]"h" [letter]"o" [letter]"d"_) [letter]"," [letter]" " [word](_[letter]"s" [letter]"t" [letter]"e" [letter]"p"_) [letter]" " [word](_[letter]"a" [letter]"f" [letter]"t" [letter]"e" [letter]"r"_) [letter]" " [word](_[letter]"s" [letter]"t" [letter]"e" [letter]"p"_) [letter]"," [letter]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"I"_) [letter]" " [word](_[letter]"a" [letter]"m"_) [letter]" " ~(_cycle [word](_[word](_[letter]"l" [letter]"o" [letter]"s" [letter]"t"_) [word](_[letter]"b" [letter]"e" [letter]"w" [letter]"i" [letter]"l" [letter]"d" [letter]"e" [letter]"r" [letter]"e" [letter]"d"_)_) #2000_) [letter]"," [letter]" " [word](_[letter]"a" [letter]"s"_) [letter]" " [word](_[letter]"u" [letter]"s" [letter]"u" [letter]"a" [letter]"l"_) [letter]"," [letter]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [letter]" " ~(_cycle [word](_[word](_[letter]"l" [letter]"o" [letter]"s" [letter]"t"_) [word](_[letter]"b" [letter]"e" [letter]"w" [letter]"i" [letter]"l" [letter]"d" [letter]"e" [letter]"r" [letter]"e" [letter]"d"_)_) #2000_) [letter]","_) [line](_[nil] [word](_[letter]"a"_) [letter]" " [word](_[letter]"f" [letter]"o" [letter]"o" [letter]"l"_) ~(_background-color ~(_text-color ~(_flip-vertical [word](_[letter]"f" [letter]"o" [letter]"o" [letter]"l"_)_) $"#ffffff"_) $"#000000"_) [letter]" " [word](_[letter]"a" [letter]"g" [letter]"a" [letter]"i" [letter]"n"_) [letter]","_) [line](_[nil] [word](_[letter]"t" [letter]"r" [letter]"y" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"a" [letter]"g" [letter]"a" [letter]"i" [letter]"n"_) [letter]"."_) [line](_[nil] [word](_[letter]"I" [letter]"t"_) [letter]" " [word](_[letter]"w" [letter]"i" [letter]"l" [letter]"l"_) [letter]" " [word](_[letter]"b" [letter]"e"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [letter]" " [word](_[letter]"w" [letter]"a" [letter]"y"_) [letter]" " [word](_[letter]"u" [letter]"n" [letter]"t" [letter]"i" [letter]"l"_) [letter]" " [word](_[letter]"I"_) [letter]" " [word](_[letter]"f" [letter]"i" [letter]"n" [letter]"a" [letter]"l" [letter]"l" [letter]"y"_) [letter]" " [word](_[letter]"g" [letter]"i" [letter]"v" [letter]"e"_) [letter]" " [word](_[letter]"o" [letter]"u" [letter]"t"_) [letter]","_) [line](_[nil] [word](_[letter]"l" [letter]"i" [letter]"k" [letter]"e"_) [letter]" " [word](_[letter]"a"_) [letter]" " [word](_[letter]"b" [letter]"l" [letter]"o" [letter]"w" [letter]"n"_) [letter]" " [word](_[letter]"f" [letter]"u" [letter]"s" [letter]"e"_) [letter]","_) [line](_[nil] [word](_[letter]"q" [letter]"u" [letter]"i" [letter]"e" [letter]"t"_) [letter]" " [word](_[letter]"d" [letter]"a" [letter]"r" [letter]"k" [letter]"n" [letter]"e" [letter]"s" [letter]"s"_) [letter]" " [word](_[letter]"d" [letter]"e" [letter]"s" [letter]"c" [letter]"e" [letter]"n" [letter]"d" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"s" [letter]"u" [letter]"d" [letter]"d" [letter]"e" [letter]"n" [letter]"l" [letter]"y"_)_) [line](_[nil] [word](_[letter]"l" [letter]"i" [letter]"k" [letter]"e"_) [letter]" " [word](_[letter]"a"_) [letter]" " [word](_[letter]"c" [letter]"o" [letter]"m" [letter]"f" [letter]"o" [letter]"r" [letter]"t" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"a" [letter]"n" [letter]"s" [letter]"w" [letter]"e" [letter]"r"_) [letter]"."_)|) $"Arial"|) #18|) #30|)v2:[doc](|[line](_[word](_[letter]"D" [letter]"i" [letter]"d"_) [letter]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [letter]" " [word](_[letter]"k" [letter]"n" [letter]"o" [letter]"w"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"a" [letter]"t"_) [letter]" " [word](_[letter]"I"_) [letter]" " [word](_[letter]"a" [letter]"m"_) [letter]" " [word](_[letter]"a" [letter]"l" [letter]"r" [letter]"e" [letter]"a" [letter]"d" [letter]"y"_) [letter]" " [word](_[letter]"d" [letter]"e" [letter]"a" [letter]"d"_) [letter]"?"_) [line](_[nil] [word](_[letter]"I"_) [letter]" " [word](_[letter]"d" [letter]"i" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"w" [letter]"h" [letter]"e" [letter]"n"_) [letter]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [letter]" " [word](_[letter]"d" [letter]"i" [letter]"e" [letter]"d"_)_) [line](_[nil] [word](_[letter]"I"_) [letter]" " [word](_[letter]"d" [letter]"i" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"w" [letter]"h" [letter]"e" [letter]"n"_) [letter]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [letter]" " [word](_[letter]"d" [letter]"i" [letter]"s" [letter]"a" [letter]"p" [letter]"p" [letter]"e" [letter]"a" [letter]"r" [letter]"e" [letter]"d"_) ~(_text-color [word](_[letter]"d" [letter]"i" [letter]"s" [letter]"a" [letter]"p" [letter]"p" [letter]"e" [letter]"a" [letter]"r" [letter]"e" [letter]"d"_) $"#ff0000"_) [word](_[letter]"d" [letter]"i" [letter]"s" [letter]"a" [letter]"p" [letter]"p" [letter]"e" [letter]"a" [letter]"r" [letter]"e" [letter]"d"_) [letter]"."_) [line](_[nil] [word](_[letter]"I"_) [letter]" " [word](_[letter]"a" [letter]"m"_) [letter]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_) [letter]"," [letter]" " [word](_[letter]"b" [letter]"u" [letter]"t"_) [letter]" " [word](_[letter]"I"_) [letter]" " [word](_[letter]"a" [letter]"m"_) [letter]" " [word](_[letter]"n" [letter]"o" [letter]"t"_) [letter]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_) [letter]"."_) [line](_[nil] [word](_[letter]"I"_) [letter]" " [word](_[letter]"a" [letter]"m"_) [letter]" " [word](_[letter]"j" [letter]"u" [letter]"s" [letter]"t"_) [letter]" " [word](_[letter]"a"_) [letter]" " [word](_[letter]"m" [letter]"u" [letter]"r" [letter]"m" [letter]"u" [letter]"r"_) [letter]"."_)|)v2:~(|with-imports @style-functions @util-functions @animation-functions ~(|begin ~(_bind @show-poem &(|~(|util:process ~(|format [doc](|[line](_[word](_[letter]"I" [letter]"n"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [letter]" " [word](_[letter]"w" [letter]"r" [letter]"e" [letter]"c" [letter]"k" [letter]"a" [letter]"g" [letter]"e"_) [separator]","_) [line](_[word](_[letter]"i" [letter]"n"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [letter]" " [word](_[letter]"o" [letter]"c" [letter]"e" [letter]"a" [letter]"n"_) [separator]"," [separator]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"p" [letter]"a" [letter]"t" [letter]"r" [letter]"o" [letter]"n" [letter]"i" [letter]"z" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"c" [letter]"a" [letter]"l" [letter]"m"_) [separator]","_) [line](_[word](_[letter]"I"_) [letter]" " [word](_[letter]"w" [letter]"a" [letter]"n" [letter]"t"_) [letter]" " [word](_[letter]"a"_) [letter]" " [word](_[letter]"t" [letter]"i" [letter]"n"_) [letter]" " [word](_[letter]"e" [letter]"d" [letter]"g" [letter]"e"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " [word](_[letter]"c" [letter]"u" [letter]"t"_) [letter]" " [word](_[letter]"m" [letter]"e"_) [letter]"."_) ~(_list-cat [line](_[word](_[letter]"T" [letter]"h" [letter]"e"_) [separator]" "_) ~(_list-cat ~(_pains #500_) [line](_[separator]" " [word](_[letter]"w" [letter]"o" [letter]"u" [letter]"l" [letter]"d"_) [letter]" " [word](_[letter]"c" [letter]"o" [letter]"m" [letter]"e"_)_)_)_) [line](_[word](_[letter]"l" [letter]"i" [letter]"k" [letter]"e"_) [letter]" " [word](_[letter]"a"_) [letter]" " [word](_[letter]"v" [letter]"o" [letter]"i" [letter]"c" [letter]"e"_) [letter]" " [word](_[letter]"f" [letter]"r" [letter]"o" [letter]"m"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"s" [letter]"p" [letter]"a" [letter]"r" [letter]"e"_) [separator]" " [word](_[letter]"s" [letter]"k" [letter]"y"_) [separator]","_) [line](_[word](_[letter]"a" [letter]"s"_) [separator]" " [word](_[letter]"i" [letter]"f"_) [separator]" " [word](_[letter]"s" [letter]"o" [letter]"m" [letter]"e" [letter]"o" [letter]"n" [letter]"e"_) [separator]" " [word](_[letter]"w" [letter]"e" [letter]"r" [letter]"e"_) [separator]" " [word](_[letter]"l" [letter]"i" [letter]"s" [letter]"t" [letter]"e" [letter]"n" [letter]"i" [letter]"n" [letter]"g"_) [separator]","_) [line](_[word](_[letter]"a" [letter]"s"_) [separator]" " [word](_[letter]"i" [letter]"f"_) [separator]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [separator]" " [word](_[letter]"h" [letter]"a" [letter]"d"_) [separator]" " [word](_[letter]"b" [letter]"e" [letter]"e" [letter]"n"_) [separator]" " [word](_[letter]"l" [letter]"i" [letter]"s" [letter]"t" [letter]"e" [letter]"n" [letter]"i" [letter]"n" [letter]"g"_) [separator]"."_)|)|)|)|)_) ~(_bind @format &" n"(|~(|style:with-padding-of ~(|style:with-text-in-size ~(_style:with-font @n $"Helvetica"_) #20|) #30|)|)_) ~(_bind @getpain &(|~(|style:with-top-padding-of ~(|style:with-left-padding-of ~(|style:with-text-in-size ~(|style:with-font [word](_[letter]"p" [letter]"a" [letter]"i" [letter]"n"_) $"Helvetica"|) ~(_animation:random-from-to #5 #15_)|) ~(_animation:random-from-to #0 #50_)|) ~(_animation:random-from-to #2 #7_)|)|)_) ~(_bind @pains &" num#"(|~(_let @hurt ~(_make-line _)_) ~(_let @do &" n#"(|~(|if ~(_::gt:: @n #0_) ~(|begin ~(_cram ~(_getpain _) @hurt_) ~(_do ~(_- @n #1_)_)|)|)|)_) ~(_do @num_) @hurt|)_)|)|)v2:[doc](|[doc](|[line](_[word](_[letter]"T" [letter]"h" [letter]"e" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"i" [letter]"s"_) [letter]" " [word](_[letter]"a"_) [letter]" " [word](_[letter]"l" [letter]"i" [letter]"t" [letter]"t" [letter]"l" [letter]"e"_) [letter]" " [word](_[letter]"m" [letter]"a" [letter]"n"_)_) [line](_[nil] [word](_[letter]"w" [letter]"h" [letter]"o"_) [letter]" " [word](_[letter]"d" [letter]"i" [letter]"d" [letter]"n" [letter]"'" [letter]"t"_) [letter]" " [word](_[letter]"d" [letter]"e" [letter]"s" [letter]"e" [letter]"r" [letter]"v" [letter]"e"_) [letter]" " [word](_[letter]"a" [letter]"n" [letter]"y"_) [letter]" " [word](_[letter]"o" [letter]"f"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [letter]"."_) [line](_[nil] [word](_[letter]"B" [letter]"e" [letter]"f" [letter]"o" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"d" [letter]"e" [letter]"l" [letter]"u" [letter]"g" [letter]"e"_) [letter]" " [word](_[letter]"o" [letter]"f"_) [letter]" " [word](_[letter]"a" [letter]"d" [letter]"u" [letter]"l" [letter]"t" [letter]"h" [letter]"o" [letter]"o" [letter]"d"_) [letter]","_) [line](_[nil] [word](_[letter]"b" [letter]"e" [letter]"f" [letter]"o" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"c" [letter]"h" [letter]"e" [letter]"m" [letter]"i" [letter]"c" [letter]"a" [letter]"l" [letter]"s"_) [letter]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"p" [letter]"u" [letter]"s" [letter]"h"_) [letter]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"p" [letter]"u" [letter]"l" [letter]"l"_) [letter]","_) [line](_[nil] [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"a" [letter]"s" [letter]"s" [letter]"u" [letter]"m" [letter]"p" [letter]"t" [letter]"i" [letter]"o" [letter]"n" [letter]"s"_) [letter]"," [letter]" " [word](_[letter]"p" [letter]"e" [letter]"o" [letter]"p" [letter]"l" [letter]"e"_) [letter]" " [word](_[letter]"f" [letter]"i" [letter]"n" [letter]"i" [letter]"s" [letter]"h" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"e" [letter]"a" [letter]"c" [letter]"h"_) [letter]" " [word](_[letter]"o" [letter]"t" [letter]"h" [letter]"e" [letter]"r" [letter]"s"_) [letter]" " [word](_[letter]"s" [letter]"e" [letter]"n" [letter]"t" [letter]"e" [letter]"n" [letter]"c" [letter]"e" [letter]"s"_) [separator]","_) [line](_[nil] [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"l" [letter]"a" [letter]"u" [letter]"g" [letter]"h" [letter]"t" [letter]"e" [letter]"r"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"r" [letter]"e" [letter]"v" [letter]"e" [letter]"n" [letter]"g" [letter]"e"_) [letter]":"_) [line](_[nil] [nil] [word](_[letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"j" [letter]"u" [letter]"s" [letter]"t"_) [letter]" " [word](_[letter]"w" [letter]"a" [letter]"n" [letter]"t" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " [word](_[letter]"c" [letter]"a" [letter]"l" [letter]"m" [letter]"l" [letter]"y"_) [letter]" " [word](_[letter]"r" [letter]"e" [letter]"a" [letter]"d"_) [letter]","_) [line](_[nil] [word](_[letter]"a" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"w" [letter]"o" [letter]"u" [letter]"l" [letter]"d"_) [letter]" " [word](_[letter]"j" [letter]"u" [letter]"s" [letter]"t"_) [letter]" " [word](_[letter]"t" [letter]"e" [letter]"l" [letter]"l"_) [letter]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [letter]" " [word](_[letter]"w" [letter]"h" [letter]"a" [letter]"t"_) [letter]" " [word](_[letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"o" [letter]"u" [letter]"g" [letter]"h" [letter]"t"_) [letter]","_) [line](_[nil] [word](_[letter]"i" [letter]"f"_) [letter]" " [word](_[letter]"y" [letter]"o" [letter]"u"_) [letter]" " [word](_[letter]"a" [letter]"s" [letter]"k" [letter]"e" [letter]"d"_) [letter]"."_)|) [doc](|[line](_[word](_[letter]"W" [letter]"e"_) [letter]" " [word](_[letter]"s" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"H" [letter]"a" [letter]"l"_) [letter]"-" [word](_[letter]"A" [letter]"n"_) [letter]"-" [word](_[letter]"T" [letter]"o" [letter]"w"_)_) [line](_[nil] [word](_[letter]"e" [letter]"v" [letter]"e" [letter]"r" [letter]"y"_) [letter]" " [word](_[letter]"n" [letter]"i" [letter]"g" [letter]"h" [letter]"t"_) [letter]" " [word](_[letter]"f" [letter]"r" [letter]"o" [letter]"m"_) [letter]" " [word](_[letter]"o" [letter]"u" [letter]"r"_) [letter]" " [word](_[letter]"w" [letter]"i" [letter]"n" [letter]"d" [letter]"o" [letter]"w" [letter]"s"_) [letter]","_) [line](_[nil] [word](_[letter]"b" [letter]"a" [letter]"n" [letter]"g" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"o" [letter]"u" [letter]"r"_) [letter]" " [word](_[letter]"c" [letter]"h" [letter]"e" [letter]"s" [letter]"t" [letter]"s"_) [letter]","_) [line](_[nil] [word](_[letter]"o" [letter]"u" [letter]"r"_) [letter]" " [word](_[letter]"p" [letter]"o" [letter]"t" [letter]"s"_) [letter]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"p" [letter]"a" [letter]"n" [letter]"s"_) [letter]","_) [line](_[nil] [word](_[letter]"d" [letter]"e" [letter]"s" [letter]"p" [letter]"e" [letter]"r" [letter]"a" [letter]"t" [letter]"e"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " [word](_[letter]"l" [letter]"i" [letter]"v" [letter]"e"_) [letter]","_) [line](_[nil] [word](_[letter]"d" [letter]"e" [letter]"s" [letter]"p" [letter]"e" [letter]"r" [letter]"a" [letter]"t" [letter]"e"_)_) [line](_[nil] [word](_[letter]"f" [letter]"o" [letter]"r"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"s" [letter]"u" [letter]"m" [letter]"m" [letter]"e" [letter]"r"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " [word](_[letter]"c" [letter]"o" [letter]"m" [letter]"e"_) [letter]"."_)|) [doc](|[line](_[word](_[letter]"A"_) [letter]" " [word](_[letter]"r" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"w" [letter]"h" [letter]"e" [letter]"e" [letter]"l" [letter]"b" [letter]"a" [letter]"r" [letter]"r" [letter]"o" [letter]"w"_)_) [line](_[nil] [word](_[letter]"w" [letter]"i" [letter]"t" [letter]"h"_) [letter]" " [word](_[letter]"a"_) [letter]" " [word](_[letter]"b" [letter]"o" [letter]"o" [letter]"m"_) [letter]" " [word](_[letter]"b" [letter]"o" [letter]"x"_) [letter]" " [word](_[letter]"i" [letter]"n"_) [letter]" " [word](_[letter]"i" [letter]"t"_) [letter]"."_) [line](_[nil] [word](_[letter]"B" [letter]"a" [letter]"t" [letter]"t" [letter]"e" [letter]"r" [letter]"i" [letter]"e" [letter]"s"_)_) [line](_[nil] [word](_[letter]"a" [letter]"r" [letter]"e"_) [letter]" " [word](_[letter]"i" [letter]"m" [letter]"p" [letter]"o" [letter]"r" [letter]"t" [letter]"a" [letter]"n" [letter]"t"_) [letter]"."_)|)|)v2:~(|begin ~(_bind @flatten &" nex"(|~(|if ~(_and ~(_is-list @nex_) ~(_is-empty @nex_)_) @nex ~(|begin ~(_bind @first ~(_car @nex_)_) ~(_bind @rest ~(_cdr @nex_)_) ~(|if ~(_is-list @first_) ~(|if ~(_is-empty @first_) ~(_flatten @rest_) ~(_flatten ~(|cons ~(_car @first_) ~(|cons ~(_cdr @first_) @rest|)|)_)|) ~(|cons @first ~(_flatten ~(_cdr @nex_)_)|)|)|)|)|)_)|)v2:~(|package @string ~(_import @util-functions_) ~(_bind @substring-from-with-length-deprecated &" str start len"(|~(_let @pos #-1_) ~(_let @end ~(_::pl:: @start @len_)_) ~(|reduce-with-starting ~(_string-listify @str_) &" item accum"(|~(_set @pos ~(_::pl:: @pos #1_)_) ~(|if ~(_and ~(_::gte:: @pos @start_) ~(_::lt:: @pos @end_)_) ~(_string-cat @accum @item_) @accum|)|) $|)|)_) ~(_bind @join-on-deprecated &" strlist separator"(|~(|reduce-with-starting @strlist &" item accum"(|~(|if ~(_is-nil @accum_) @item ~(_string-cat @accum @separator @item_)|)|) [nil]|)|)_) ~(_bind @split-on-deprecated &" str on"(|~(_let @result [word](__)_) ~(_let @str ~(_string-cat @str @on_)_) ~(|reduce-with-starting ~(_string-listify @str_) &" item accum"(|~(|if ~(_equal @item @on_) ~(|begin ~(_set @result ~(_cons @accum @result_)_) $|) ~(_string-cat @accum @item_)|)|) $|) ~(_util:reverse @result_)|)_)|)v2:~(|begin ~(_bind @bold &" nex"(|~(_bind @style-list ~(_parse-style ~(_get-style-from @nex_)_)_) ~(_bind @new-style-list ~(_set-style $"font-weight" $"bold" @style-list_)_) ~(_apply-style-to ~(_join-style @new-style-list_) @nex_)|)_) ~(_bind @italic &" nex"(|~(_bind @stylestring ~(_get-style-from @nex_)_) ~(_bind @newstylestring ~(_add-style $"font-style" $"italic" @stylestring_)_) ~(_apply-style-to @newstylestring @nex_)|)_) ~(_bind @parse-style &" stylestring"(|~(_bind @stylelist ~(_string-split @stylestring $";"_)_) ~(_bind @split-pairs &" lst"(|~(|if ~(_is-empty @lst_) [word](__) ~(|begin ~(_bind @pair ~(_string-split ~(_car @lst_) $":"_)_) ~(|cons @pair ~(_split-pairs ~(_cdr @lst_)_)|)|)|)|)_) ~(_split-pairs @stylelist_)|)_) ~(_bind @join-style &" stylelist"(|~(|if ~(_is-empty @stylelist_) $ ~(|begin ~(_bind @pair ~(_car @stylelist_)_) ~(_bind @pairstring ~(|string-cat ~(_car @pair_) ~(_car ~(_cdr @pair_)_)|)_) ~(|string-cat @pairstring ~(|join-style ~(_cdr @stylelist_)|)|)|)|)|)_) ~(_bind @add-style &" stylename styleval stylelist"(|~(|if ~(_has-style @stylename @stylelist_) @str ~(_string-cat @stylename $":" @styleval ~(_if ~(_string-eq @str $_) $ $";"_) @str_)|)|)_) ~(_bind @remove-style &" stylename stylelist"(||)_) ~(_bind @has-style &" stylename stylelist"(|~(|if ~(_is-empty @stylelist_) !no ~(|begin ~(_bind @style ~(_car @stylelist_)_) ~(_bind @pair ~(_string-split @style $":"_)_) ~(_bind @name ~(_car @pair_)_) ~(|if ~(_string-eq @stylename @name_) !yes ~(_has-style @stylename ~(_cdr @stylelist_)_)|)|)|)|)_) ~(_bind @string-substr &" str start len pos"(|~(|if ~(_::eq:: @pos ~(_::pl:: @start @len_)_) $ ~(|if ~(_::gte:: @pos @start_) ~(|string-cat ~(_string-char-at @str @pos_) ~(_string-substr @str @start @len ~(_::pl:: @pos #1_)_)|) ~(_string-substr @str @start @len ~(_::pl:: @pos #1_)_)|)|)|)_) ~(_bind @string-split &" str on"(|~(|begin ~(_bind @first-index-of ~(_string-index-of @str @on_)_) ~(|if ~(_is-error @first-index-of_) ~(_if ~(_string-eq @str $_) [word](__) ~(_cons @str [word](__)_)_) ~(|cons ~(|string-substr @str #0 @first-index-of #0|) ~(|string-split ~(|string-substr @str ~(_::pl:: @first-index-of #1_) ~(_- ~(_string-length @str_) ~(_::pl:: @first-index-of #1_)_) #0|) @on|)|)|)|)|)_)|)v2:~(|package @style ~(_import @util-functions_) ~(_bind @with-clip-percent &" nex top% right% bottom% left%"(|~(|with-style-set-to @nex $"clip-path" ~(|string-cat $"inset(" ~(_to-string ~(_round ~(_::ti:: %100 @top_)_)_) $"% " ~(_to-string ~(_round ~(_::ti:: %100 @right_)_)_) $"% " ~(_to-string ~(_round ~(_::ti:: %100 @bottom_)_)_) $"% " ~(_to-string ~(_round ~(_::ti:: %100 @left_)_)_) $"%)"|)|)|)_) ~(_bind @with-hidden &" nex"(|~(_with-style-set-to @nex $"visibility" $"hidden"_)|)_) ~(_bind @with-visible &" nex"(|~(_with-style-set-to @nex $"visibility" $"visible"_)|)_) ~(_bind @with-line-height &" nex val$"(|~(_with-style-set-to @nex $"line-height" @val_)|)_) ~(_bind @with-translate-x-y &" nex xpix#% ypix#%"(|~(_with-style-set-to @nex $"transform" ~(_string-cat $"translate(" ~(_to-string @xpix_) $"px," ~(_to-string @ypix_) $"px)"_)_)|)_) ~(_bind @with-stretch-x &" nex xstretch%"(|[doc](|[line](_[word](_[letter]"S" [letter]"t" [letter]"r" [letter]"e" [letter]"t" [letter]"c" [letter]"h" [letter]"e" [letter]"s"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"n" [letter]"e" [letter]"x"_) [separator]" " [word](_[letter]"o" [letter]"u" [letter]"t"_) [separator]" " [word](_[letter]"a" [letter]"l" [letter]"o" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"x"_) [separator]" " [word](_[letter]"a" [letter]"x" [letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"a" [letter]"d" [letter]"d" [letter]"s"_) [separator]" " [word](_[letter]"m" [letter]"a" [letter]"r" [letter]"g" [letter]"i" [letter]"n" [letter]"s"_) [separator]" " [word](_[letter]"s" [letter]"o"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"a" [letter]"t"_) [separator]" " [word](_[letter]"i" [letter]"t"_) [separator]" " [word](_[letter]"w" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"f" [letter]"l" [letter]"o" [letter]"w"_)_) [line](_[word](_[letter]"c" [letter]"o" [letter]"r" [letter]"r" [letter]"e" [letter]"c" [letter]"t" [letter]"l" [letter]"y"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"l" [letter]"i" [letter]"n" [letter]"e"_) [separator]" " [word](_[letter]"w" [letter]"i" [letter]"t" [letter]"h"_) [separator]" " [word](_[letter]"o" [letter]"t" [letter]"h" [letter]"e" [letter]"r"_) [separator]" " [word](_[letter]"t" [letter]"e" [letter]"x" [letter]"t"_) [separator]"."_)|) ~(_let @get-required-right-margin &" nex"(|~(_let @original-width ~(_get-pixel-width @nex_)_) ~(_let @required-right-margin ~(_- ~(_::ti:: @original-width @xstretch_) @original-width_)_) @required-right-margin|)_) ~(_let @set-style-for-nex &" nex"(|~(|with-style-set-to ~(|with-style-set-to ~(_with-style-set-to @nex $"transform" ~(_string-cat $"scale(" ~(_to-string @xstretch_) $", 1)"_)_) $"transform-origin" $"top left"|) $"margin-right" ~(_string-cat ~(_to-string ~(_get-required-right-margin @nex_)_) $"em"_)|)|)_) ~(_ff-with ~(_set-contents-changed ~(_cons @nex *(__)_)_) &" n"(|~(_set-style-for-nex @n_)|)_) ~(_set-style-for-nex @nex_)|)_) ~(_bind @with-stretch-y &" nex ystretch%"(|[doc](|[line](_[word](_[letter]"S" [letter]"t" [letter]"r" [letter]"e" [letter]"t" [letter]"c" [letter]"h" [letter]"e" [letter]"s"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"n" [letter]"e" [letter]"x"_) [separator]" " [word](_[letter]"o" [letter]"u" [letter]"t"_) [separator]" " [word](_[letter]"a" [letter]"l" [letter]"o" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"y"_) [separator]" " [word](_[letter]"a" [letter]"x" [letter]"i" [letter]"s"_) [separator]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [separator]" " [word](_[letter]"a" [letter]"d" [letter]"d" [letter]"s"_) [separator]" " [word](_[letter]"m" [letter]"a" [letter]"r" [letter]"g" [letter]"i" [letter]"n" [letter]"s"_) [separator]" " [word](_[letter]"s" [letter]"o"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"a" [letter]"t"_) [separator]" " [word](_[letter]"i" [letter]"t"_) [separator]" " [word](_[letter]"w" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"i" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"f" [letter]"l" [letter]"o" [letter]"w"_)_) [line](_[word](_[letter]"c" [letter]"o" [letter]"r" [letter]"r" [letter]"e" [letter]"c" [letter]"t" [letter]"l" [letter]"y"_) [separator]" " [word](_[letter]"i" [letter]"n"_) [separator]" " [word](_[letter]"l" [letter]"i" [letter]"n" [letter]"e"_) [separator]" " [word](_[letter]"w" [letter]"i" [letter]"t" [letter]"h"_) [separator]" " [word](_[letter]"o" [letter]"t" [letter]"h" [letter]"e" [letter]"r"_) [separator]" " [word](_[letter]"t" [letter]"e" [letter]"x" [letter]"t"_) [separator]"."_)|) ~(_let @margin-em ~(_- @ystretch %1_)_) ~(|with-style-set-to ~(|with-style-set-to ~(_with-style-set-to @nex $"transform" ~(_string-cat $"scale(1, " ~(_to-string @ystretch_) $")"_)_) $"margin-top" ~(_string-cat ~(_to-string @margin-em_) $"em"_)|) $"margin-bottom" ~(_string-cat ~(_to-string @margin-em_) $"em"_)|)|)_) ~(_bind @align-right &" nex"(|~(_with-style-set-to @nex $"align-items" $"flex-end"_)|)_) ~(_bind @align-left &" nex"(|~(_with-style-set-to @nex $"align-items" $"flex-start"_)|)_) ~(_bind @align-center &" nex"(|~(_with-style-set-to @nex $"align-center" $"flex-start"_)|)_) ~(_bind @push-center &" nex"(|~(_with-style-set-to @nex $"justify-content" $"center"_)|)_) ~(_bind @push-left &" nex"(|~(_with-style-set-to @nex $"justify-content" $"left"_)|)_) ~(_bind @push-right &" nex"(|~(_with-style-set-to @nex $"justify-content" $"right"_)|)_) ~(_bind @clips-contents &" nex"(|~(_with-style-set-to @nex $"overflow" $"hidden"_)|)_) ~(_bind @with-scrollbars-on &" nex"(|~(_with-style-set-to @nex $"overflow" $"scroll"_)|)_) ~(_bind @with-x-offset-of &" nex val#%"(|~(|with-style-set-to ~(_with-style-set-to @nex $"position" $"relative"_) $"left" ~(_string-cat ~(_to-string @val_) $"px"_)|)|)_) ~(_bind @with-y-offset-of &" nex val#%"(|~(|with-style-set-to ~(_with-style-set-to @nex $"position" $"relative"_) $"top" ~(_string-cat ~(_to-string @val_) $"px"_)|)|)_) ~(_bind @with-alpha-of &" nex val%"(|~(_with-style-set-to @nex $"opacity" ~(_to-string @val_)_)|)_) ~(_bind @with-padding-of &" nex val#%"(|[line](_[word](_[letter]"S" [letter]"u" [letter]"r" [letter]"r" [letter]"o" [letter]"u" [letter]"n" [letter]"d" [letter]"s"_) [separator]" " [word](_[letter]"n" [letter]"e" [letter]"x"_) [separator]" " [word](_[letter]"w" [letter]"i" [letter]"t" [letter]"h"_) [separator]" " [word](_[letter]"p" [letter]"a" [letter]"d" [letter]"d" [letter]"i" [letter]"n" [letter]"g"_) [separator]" " [word](_[letter]"o" [letter]"f"_) [separator]" " [word](_[letter]"v" [letter]"a" [letter]"l"_) [separator]" " [word](_[letter]"o" [letter]"n"_) [separator]" " [word](_[letter]"a" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"s" [letter]"i" [letter]"d" [letter]"e" [letter]"s"_) [separator]"."_) ~(_with-trlb-padding-of @nex @val @val @val @val_)|)_) ~(_bind @with-bottom-padding-of &" nex val#%"(|~(_with-style-set-to @nex $"padding-bottom" ~(_string-cat ~(_to-string @val_) $"px"_)_)|)_) ~(_bind @with-top-padding-of &" nex val#%"(|~(_with-style-set-to @nex $"padding-top" ~(_string-cat ~(_to-string @val_) $"px"_)_)|)_) ~(_bind @with-left-padding-of &" nex val#%"(|~(_with-style-set-to @nex $"padding-left" ~(_string-cat ~(_to-string @val_) $"px"_)_)|)_) ~(_bind @with-right-padding-of &" nex val#%"(|~(_with-style-set-to @nex $"padding-right" ~(_string-cat ~(_to-string @val_) $"px"_)_)|)_) ~(_bind @with-trlb-padding-of &" nex t#% r#% b#% l#%"(|~(|with-left-padding-of ~(|with-right-padding-of ~(|with-top-padding-of ~(|with-bottom-padding-of @nex @b|) @t|) @r|) @l|)|)_) ~(_bind @with-background-color-of &" nex color$"(|~(_with-style-set-to @nex $"background-color" @color_)|)_) ~(_bind @with-height-of &" nex height#%"(|~(_with-style-set-to @nex $"height" ~(_string-cat ~(_to-string @height_) $"px"_)_)|)_) ~(_bind @with-width-of &" nex width#%"(|~(_with-style-set-to @nex $"width" ~(_string-cat ~(_to-string @width_) $"px"_)_)|)_) ~(_bind @with-scale &" nex scale%"(|~(_with-style-set-to @nex $"transform" ~(_string-cat $"scale(" ~(_to-string @scale_) $"," ~(_to-string @scale_) $")"_)_)|)_) ~(_bind @with-transform-origin-x-y &" nex xorigin% yorigin%"(|~(_with-style-set-to @nex $"transform-origin" ~(|string-cat ~(_to-string @xorigin_) $"%" $" " ~(_to-string @yorigin_) $"%"|)_)|)_) ~(_bind @flipped-horizontally &" nex"(|~(_use @util_) ~(_let @stylestring ~(_get-value-for-style @nex $"transform"_)_) ~(_set @stylestring ~(_if ~(_is-nil @stylestring_) $"scale(1,1)" @stylestring_)_) ~(_let @xform ~(_string-split-on @stylestring $","_)_) ~(_let @horizhalf ~(_car @xform_)_) ~(_let @verthalf ~(_cadr @xform_)_) ~(_let @newstyle ~(|string-cat ~(_if ~(_equal @horizhalf $"scale(1"_) $"scale(-1" $"scale(1"_) $"," @verthalf|)_) ~(_with-style-set-to @nex $"transform" @newstyle_)|)_) ~(_bind @flipped-vertically &" nex"(|~(_use @util_) ~(_let @stylestring ~(_get-value-for-style @nex $"transform"_)_) ~(_set @stylestring ~(_if ~(_is-nil @stylestring_) $"scale(1,1)" @stylestring_)_) ~(_let @xform ~(_split-on @stylestring $","_)_) ~(_let @horizhalf ~(_car @xform_)_) ~(_let @verthalf ~(_cadr @xform_)_) ~(_let @newstyle ~(|string-cat @horizhalf $"," ~(_if ~(_equal @verthalf $"1)"_) $"-1)" $"1)"_)|)_) ~(_with-style-set-to @nex $"transform" @newstyle_)|)_) ~(_bind @rotate-by &" nex by%"(|~(_with-style-set-to @nex $"transform" ~(_string-cat $"rotate(" ~(_to-string @by_) $"deg)"_)_)|)_) ~(_bind @italicized &" nex"(|~(_with-style-set-to @nex $"font-style" $"italic"_)|)_) ~(_bind @bolded &" nex"(|~(_with-style-set-to @nex $"font-weight" $"bold"_)|)_) ~(_bind @with-light-weight &" nex"(|~(_with-style-set-to @nex $"font-weight" $"lighter"_)|)_) ~(_bind @with-normal-weight &" nex"(|~(_with-style-set-to @nex $"font-weight" $"normal"_)|)_) ~(_bind @normal &" nex"(|~(_with-style-set-to ~(_with-style-set-to @nex $"font-style" $"italic"_) $"font-weight" $"normal"_)|)_) ~(_bind @with-text-in-color &" nex color$"(|~(_with-style-set-to @nex $"color" @color_)|)_) ~(_bind @with-text-in-size &" nex size#%"(|~(_with-style-set-to @nex $"font-size" ~(_string-cat ~(_to-string @size_) $"px"_)_)|)_) ~(_bind @with-font &" nex fontname$"(|~(_with-style-set-to @nex $"font-family" @fontname_)|)_) ~(_bind @lowercased &" nex"(|~(_with-style-set-to @nex $"text-transform" $"lowercase"_)|)_) ~(_bind @uppercased &" nex"(|~(_with-style-set-to @nex $"text-transform" $"uppercase"_)|)_) ~(_bind @get-value-for-style &" nex stylename$"(|[doc](|[line](_[word](_[letter]"R" [letter]"e" [letter]"t" [letter]"u" [letter]"r" [letter]"n" [letter]"s"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [separator]" " [word](_[letter]"v" [letter]"a" [letter]"l" [letter]"u" [letter]"e"_) [separator]" " [word](_[letter]"f" [letter]"o" [letter]"r"_) [separator]" " [word](_[letter]"a"_) [separator]" " [word](_[letter]"g" [letter]"i" [letter]"v" [letter]"e" [letter]"n"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"y" [letter]"l" [letter]"e"_) [separator]" " [word](_[letter]"n" [letter]"a" [letter]"m" [letter]"e"_) [separator]"."_) [line](_[word](_[letter]"R" [letter]"e" [letter]"t" [letter]"u" [letter]"r" [letter]"n" [letter]"s"_) [separator]" " [word](_[letter]"n" [letter]"u" [letter]"l" [letter]"l"_) [separator]" " [word](_[letter]"i" [letter]"f"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"a" [letter]"t"_) [separator]" " [word](_[letter]"n" [letter]"e" [letter]"x"_) [separator]" " [word](_[letter]"d" [letter]"o" [letter]"e" [letter]"s" [letter]"n" [letter]"'" [letter]"t"_) [separator]" " [word](_[letter]"h" [letter]"a" [letter]"v" [letter]"e"_) [separator]" " [word](_[letter]"t" [letter]"h" [letter]"a" [letter]"t"_) [separator]" " [word](_[letter]"s" [letter]"t" [letter]"y" [letter]"l" [letter]"e"_) [separator]" " [word](_[letter]"s" [letter]"e" [letter]"t"_) [separator]"."_)|) ~(_let @styletable ~(_parse-style-string ~(_get-css-style-from @nex_)_)_) ~(_lookup-key-in @stylename @styletable_)|)_) ~(_bind @with-style-set-to &" nex stylename$ styleval$"(|~(_let @styletable ~(_parse-style-string ~(_get-css-style-from @nex_)_)_) ~(_let @newstyletable ~(_add-style-key-value-to @stylename @styleval @styletable_)_) ~(_apply-css-style-to ~(_to-style-string @newstyletable_) @nex_)|)_) ~(_bind @add-style-key-value-to &" stylename$ styleval$ stylelist()"(|~(_use @util_) ~(_add-key-value-to @stylename @styleval ~(_remove-all-entries-with-key-from @stylename @stylelist_)_)|)_) ~(_bind @parse-style-string &"() stylestring$"(|~(_map-with ~(|filter-with ~(_string-split-on @stylestring $";"_) &" str"(|~(_not ~(_equal @str $_)_)|)|) &" item"(|~(_string-split-on @item $":"_)|)_)|)_) ~(_bind @to-style-string &"$ stylemap()"(|~(_string-join-on ~(_map-with @stylemap &" item"(|~(_string-join-on @item $":"_)|)_) $";"_)|)_) ~(_bind @with-same-style-as &" dst src"(|~(_apply-css-style-to ~(_get-css-style-from @src_) @dst_)|)_)|)v2:[doc](|[line](_[word](_[letter]"H" [letter]"o" [letter]"l" [letter]"d"_) [letter]" " [word](_[letter]"o" [letter]"n"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " [word](_[letter]"y" [letter]"o" [letter]"u" [letter]"r"_) [letter]" " [word](_[letter]"h" [letter]"a" [letter]"t" [letter]"s"_)_) [line](_[nil] [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"b" [letter]"i" [letter]"g"_) [letter]" " [word](_[letter]"o" [letter]"n" [letter]"e"_) [letter]" " [word](_[letter]"i" [letter]"s"_) [letter]" " [word](_[letter]"c" [letter]"o" [letter]"m" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"s" [letter]"i" [letter]"l" [letter]"v" [letter]"e" [letter]"r" [letter]"d" [letter]"o" [letter]"m" [letter]"e"_)_) [line](_[nil] [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [letter]" " [word](_[letter]"s" [letter]"a" [letter]"t" [letter]"u" [letter]"r" [letter]"d" [letter]"a" [letter]"y"_) [letter]" " [word](_[letter]"n" [letter]"i" [letter]"g" [letter]"h" [letter]"t"_) [letter]" " [word](_[letter]"a" [letter]"t"_) [letter]" " [word](_[letter]"8" [letter]"p" [letter]"m"_)_) [line](_[nil] [word](_[letter]"w" [letter]"k" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"t" [letter]"v"_) [letter]" " [word](_[letter]"5" [letter]"0"_) [letter]" " [word](_[letter]"a" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"1" [letter]"0" [letter]"1"_) [letter]" " [word](_[letter]"f" [letter]"m"_) [letter]" " [word](_[letter]"W" [letter]"r" [letter]"i" [letter]"f"_)_) [line](_[nil] [word](_[letter]"W" [letter]"E" [letter]"L" [letter]"C" [letter]"O" [letter]"M" [letter]"E"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " [word](_[letter]"m" [letter]"e" [letter]"t" [letter]"r" [letter]"o"_) [letter]" " [word](_[letter]"c" [letter]"h" [letter]"e" [letter]"v" [letter]"y"_) [letter]" " [word](_[letter]"d" [letter]"e" [letter]"a" [letter]"l" [letter]"e" [letter]"r" [letter]"s"_)_) [line](_[nil] [word](_[letter]"u" [letter]"s"_) [letter]" " [word](_[letter]"h" [letter]"o" [letter]"t"_) [letter]" " [word](_[letter]"r" [letter]"o" [letter]"d"_) [letter]" " [word](_[letter]"7" [letter]"t" [letter]"h"_) [letter]" " [word](_[letter]"a" [letter]"n" [letter]"n" [letter]"u" [letter]"a" [letter]"l"_)_) [line](_[nil] [word](_[letter]"t" [letter]"h" [letter]"r" [letter]"i" [letter]"l" [letter]"l"_) [letter]" " [word](_[letter]"s" [letter]"h" [letter]"o" [letter]"w"_) [letter]" " [word](_[letter]"s" [letter]"p" [letter]"e" [letter]"c" [letter]"t" [letter]"a" [letter]"c" [letter]"u" [letter]"l" [letter]"a" [letter]"r"_)_)|)v2:~(|template @Grid (|#<`width`>30 #<`height`>20 (|<`data`>|) &(|<`:init`>~(_let @makerow &(|~(_let @row (||)_) ~(_loop-over &"n"(|~(_let @row ~(_cons #0 @row_)_)|) ~(_range @self.width_)_) @row|)_) ~(_loop-over &"n"(|~(_set @self.data ~(_cons ~(_makerow _) @self.data_)_)|) ~(_range @self.height_)_)|)|)|)v2:~(_bind @add-all &" list"(|~(|if-then-else ~(_is-empty @list_) ~(_::pl:: ~(_first @list_) ~(_rest @list_)_) %0|)|)_)v2:~(|begin ~(_import @style-functions_) ~(_import @util-functions_) ~(_bind @justify-doc &" doc size"(|~(_let @newdoc [doc](||)_) ~(_do-for-each &" line"(|~(_let @f ~(_font ~(_light ~(_flatten @line_)_) $"Helvetica"_)_) ~(_set @newdoc ~(_cons ~(_resize-to-target @f @size_) @newdoc_)_)|) @doc_) @newdoc|)_) ~(_bind @resize-to-target &" phrase target"(|~(_let @size ~(_find-best-font @phrase @target_)_) ~(_text-size @phrase @size_)|)_) ~(_bind @do-for-each &" f lst"(|~(|if ~(_is-empty @lst_) [word](__) ~(_cons ~(_@f ~(_car @lst_)_) ~(_do-for-each @f ~(_cdr @lst_)_)_)|)|)_) ~(_bind @range &" start end"(|~(|if ~(_::gt:: @start @end_) [word](__) ~(_cons @start ~(_range ~(_::pl:: @start #1_) @end_)_)|)|)_) ~(_bind @make-width-lookup &" list"(|~(|if ~(_is-empty @list_) [word](__) ~(|begin ~(_let @first ~(_car @list_)_) ~(_let @width ~(_run-js $"$dom[0].getBoundingClientRect().width" @first_)_) ~(_cons ~(_cons @first ~(_cons @width [word](__)_)_) ~(_make-width-lookup ~(_cdr @list_)_)_)|)|)|)_) ~(_bind @lookup &" nex table"(|~(_let @r [nil]_) ~(_do-for-each &" entry"(|~(_let @key ~(_car @entry_)_) ~(|if ~(_equal @key @nex_) ~(_set @r ~(_car ~(_cdr @entry_)_)_) [nil]|)|) @table_) @r|)_) ~(_bind @total-in-font &" phrase font-list-entry"(|~(_let @lookup-table ~(_car ~(_cdr @font-list-entry_)_)_) ~(_let @sum #0_) ~(_do-for-each &" letter"(|~(_let @width ~(_lookup @letter @lookup-table_)_) ~(|if ~(_equal @width [nil]_) [nil] ~(_set @sum ~(_::pl:: @sum @width_)_)|)|) @phrase_) @sum|)_) ~(_bind @calculate-all-widths &" phrase all-lookups"(|~(_do-for-each &" lookup"(|~(_let @font ~(_car @lookup_)_) ~(_let @total ~(_total-in-font @phrase @lookup_)_) ~(_cons @font ~(_cons @total [word](__)_)_)|) @all-lookups_)|)_) ~(_bind @find-best-font &" phrase targetwidth"(|~(_let @widthmap ~(_calculate-all-widths @phrase @lettermap_)_) ~(_let @best ~(_car ~(_car @widthmap_)_)_) ~(_let @find-it &" target prevsize map"(|~(|if ~(_is-empty @map_) @prevsize ~(|begin ~(_let @mapentry ~(_car @map_)_) ~(_let @fontsize ~(_car @mapentry_)_) ~(_let @width-in-font ~(_car ~(_cdr @mapentry_)_)_) ~(|if ~(_::gt:: @width-in-font @target_) @prevsize ~(_find-it @target @fontsize ~(_cdr @map_)_)|)|)|)|)_) ~(_find-it @targetwidth @best @widthmap_)|)_) [doc](|[doc](|[line](_[word](_[letter]"d" [letter]"o"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"f" [letter]"o" [letter]"l" [letter]"l" [letter]"o" [letter]"w" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"f" [letter]"i" [letter]"r" [letter]"s" [letter]"t"_) [letter]"-" [letter]" " [word](_[letter]"r" [letter]"e" [letter]"t" [letter]"r" [letter]"i" [letter]"e" [letter]"v" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"f" [letter]"o" [letter]"n" [letter]"t"_) [letter]" " [word](_[letter]"s" [letter]"i" [letter]"z" [letter]"e"_) [letter]" " [word](_[letter]"d" [letter]"o" [letter]"e" [letter]"s" [letter]"n" [letter]"'" [letter]"t"_) [letter]" " [word](_[letter]"w" [letter]"o" [letter]"r" [letter]"k"_) [letter]" " [word](_[letter]"u" [letter]"n" [letter]"t" [letter]"i" [letter]"l"_) [letter]" " [word](_[letter]"i" [letter]"t" [letter]"'" [letter]"s"_) [letter]" " [word](_[letter]"b" [letter]"e" [letter]"e" [letter]"n"_)_) [line](_[nil] [word](_[letter]"r" [letter]"e" [letter]"n" [letter]"d" [letter]"e" [letter]"r" [letter]"e" [letter]"d"_) [letter]" " [word](_[letter]"o" [letter]"n"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"s" [letter]"c" [letter]"r" [letter]"e" [letter]"e" [letter]"n"_) [letter]" " [letter]" " [letter]"-" [letter]" " [word](_[letter]"l" [letter]"o" [letter]"o" [letter]"k" [letter]"i" [letter]"n" [letter]"g"_) [letter]" " [word](_[letter]"t" [letter]"o"_) [letter]" " [word](_[letter]"f" [letter]"i" [letter]"x"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"i" [letter]"s"_) [letter]"-" [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e" [letter]"n"_) [letter]" " [word](_[letter]"p" [letter]"a" [letter]"s" [letter]"t" [letter]"e"_) [letter]" " [word](_[letter]"i" [letter]"n"_) [letter]" " [word](_[letter]"t" [letter]"h" [letter]"e"_) [letter]" " [word](_[letter]"b" [letter]"i" [letter]"n" [letter]"d"_) [letter]" " [word](_[letter]"e" [letter]"x" [letter]"p" [letter]"r"_) [letter]" " [word](_[letter]"b" [letter]"e" [letter]"l" [letter]"o" [letter]"w"_) [letter]"."_)|) ~(_do-for-each &" n"(|~(_cons @n ~(_cons ~(_font ~(_light ~(_text-size [word](_[letter]"A" [letter]"B" [letter]"C" [letter]"D" [letter]"E" [letter]"F" [letter]"G" [letter]"H" [letter]"I" [letter]"J" [letter]"K" [letter]"L" [letter]"M" [letter]"N" [letter]"O" [letter]"P" [letter]"Q" [letter]"R" [letter]"S" [letter]"T" [letter]"U" [letter]"V" [letter]"W" [letter]"X" [letter]"Y" [letter]"Z" [letter]" " [letter]";" [letter]"," [letter]":" [letter]"?" [letter]"'" [letter]{"} [letter]"." [letter]"," [letter]"a" [letter]"b" [letter]"c" [letter]"d" [letter]"e" [letter]"f" [letter]"g" [letter]"h" [letter]"i" [letter]"j" [letter]"k" [letter]"l" [letter]"m" [letter]"n" [letter]"o" [letter]"p" [letter]"q" [letter]"r" [letter]"s" [letter]"t" [letter]"u" [letter]"v" [letter]"w" [letter]"x" [letter]"y" [letter]"z"_) @n_)_) $"Helvetica"_) [word](__)_)_)|) ~(_range #8 #40_)_) ~(_bind @lettermap ~(_do-for-each &" item"(|~(_let @list ~(_car ~(_cdr @item_)_)_) ~(_let @size ~(_car @item_)_) ~(_cons @size ~(_cons ~(_make-width-lookup @list_) [word](__)_)_)|) [doc](|[line](_[word](_[letter]"i" [letter]"t" [letter]"e" [letter]"m" [letter]"s"_) [letter]" " [word](_[letter]"h" [letter]"e" [letter]"r" [letter]"e"_)_)|)_)_)|)|)v2:#20v2:~(|package @text ~(_import @style-functions_)|)v2:#33v2:~(|package @util ~(_bind @LOG [doc](||)_) ~(_bind @log &"() nex"(|~(_cram ~(_copy @nex_) @LOG_)|)_) ~(_bind @caar &" lst()"(|~(_car ~(_car @lst_)_)|)_) ~(_bind @cadr &" lst()"(|~(_car ~(_cdr @lst_)_)|)_) ~(_bind @cdar &" lst()"(|~(_cdr ~(_car @lst_)_)|)_) ~(_bind @cddr &" lst()"(|~(_cdr ~(_cdr @lst_)_)|)_) ~(_bind @second &" lst()"(|~(_first ~(_rest @lst_)_)|)_) ~(_bind @third &" lst()"(|~(_first ~(_rest ~(_rest @lst_)_)_)|)_) ~(_bind @fourth &" lst()"(|~(_first ~(_rest ~(_rest ~(_rest @lst_)_)_)_)|)_) ~(_bind @process &"() list()"(|~(|util:traverse-nexes-satisfying-and-do @list &"! item"(|~(_is-command @item_)|) &" item~"(|~(_eval @item_)|)|)|)_) ~(_bind @range-from-to &"() start# end#"(|~(|if ~(_::gt:: @start @end_) [word](__) ~(_cons @start ~(_range-from-to ~(_::pl:: @start #1_) @end_)_)|)|)_) ~(_bind @reverse &"() lst()"(|~(|reduce-with-starting @lst &" item accum()"(|~(_cons @item @accum_)|) [word](__)|)|)_) ~(_bind @traverse-atoms-of-and-do &" nex f&"(|~(|first-non-nil ~(_if ~(_not ~(_is-list @nex_)_) ~(_f @nex_)_) ~(_if ~(_is-expectation @nex_) @nex_) ~(_if ~(_is-empty @nex_) @nex_) ~(_if !yes ~(|cons ~(_traverse-atoms-of-and-do ~(_first @nex_) @f_) ~(_traverse-atoms-of-and-do ~(_rest @nex_) @f_)|)_)|)|)_) ~(_bind @traverse-atoms-satisfying-and-do &" nex testf& dof&"(|~(|first-non-nil ~(_if ~(_not ~(_is-list @nex_)_) ~(|if ~(_testf @nex_) ~(_dof @nex_) @nex|)_) ~(_if ~(_is-expectation @nex_) @nex_) ~(_if ~(_is-empty @nex_) @nex_) ~(_if !yes ~(|cons ~(_traverse-atoms-satisfying-and-do ~(_first @nex_) @testf @dof_) ~(_traverse-atoms-satisfying-and-do ~(_rest @nex_) @testf @dof_)|)_)|)|)_) ~(_bind @traverse-nexes-satisfying-and-do &" nex testf& dof&"(|~(|first-non-nil ~(_if ~(_testf @nex_) ~(_dof @nex_)_) ~(_if ~(_not ~(_is-list @nex_)_) @nex_) ~(_if ~(_is-expectation @nex_) @nex_) ~(_if ~(_is-empty @nex_) @nex_) ~(_if !yes ~(|cons ~(_traverse-nexes-satisfying-and-do ~(_first @nex_) @testf @dof_) ~(_traverse-nexes-satisfying-and-do ~(_rest @nex_) @testf @dof_)|)_)|)|)_) ~(_bind @nth-from &" n# lst()"(|~(|if ~(_::eq:: @n #0_) ~(_car @lst_) ~(_nth-from ~(_- @n #1_) ~(_rest @lst_)_)|)|)_) ~(_bind @length-of &"# lst()"(|~(|reduce-with-starting @lst &" item accum#"(|~(_::pl:: @accum #1_)|) #0|)|)_) ~(_bind @list-cat &"() lst1() lst2()"(|~(|if ~(_is-empty @lst1_) ~(_copy @lst2_) ~(_cons ~(_first @lst1_) ~(_list-cat ~(_rest @lst1_) @lst2_)_)|)|)_) ~(_bind @put-contents-in &"() lst() dstlst()"(|~(_list-cat @lst @dstlst_)|)_) ~(_bind @contains-item-satisfying &"! lst() f&"(|~(|reduce-with-starting @lst &" item accum()"(|~(|if ~(_f @item_) !yes @accum|)|) !no|)|)_) ~(_bind @with-only-items-satisfying &"() lst() f&"(|~(_filter-with @list @f_)|)_) ~(_bind @lookup-key-in &" key table()"(|~(_let @reclookup &" temptable()"(|~(|if-then ~(_not ~(_is-empty @temptable_)_) ~(|begin ~(_let @entry ~(_first @temptable_)_) ~(_let @thiskey ~(_first @entry_)_) ~(_let @value ~(_first ~(_rest @entry_)_)_) ~(|if-then-else ~(_equal @key @thiskey_) @value ~(_reclookup ~(_rest @temptable_)_)|)|)|)|)_) ~(_reclookup @table_)|)_) ~(_bind @remove-all-entries-with-key-from &"() key table()"(|~(|reduce-with-starting @table &" item accum()"(|~(|if ~(_equal @key ~(_first @item_)_) @accum ~(_cons @item @accum_)|)|) [word](__)|)|)_) ~(_bind @add-key-value-to &" key value table()"(|~(_cons ~(_cons @key ~(_cons @value [word](__)_)_) @table_)|)_) ~(_bind @key-is-in &"! key table()"(|~(_contains-item-satisfying @table &" entry"(|~(_equal @key ~(_first @entry_)_)|)_)|)_)|)v2:~(|<`@@`>package @util ~(_bind @LOG [doc](||)_) ~(_bind @log &"() nex"(|~(_cram ~(_copy @nex_) @LOG_)|)_) ~(_bind @caar &" lst()"(|~(_car ~(_car @lst_)_)|)_) ~(_bind @cadr &" lst()"(|~(_car ~(_cdr @lst_)_)|)_) ~(_bind @cdar &" lst()"(|~(_cdr ~(_car @lst_)_)|)_) ~(_bind @cddr &" lst()"(|~(_cdr ~(_cdr @lst_)_)|)_) ~(_bind @second &" lst()"(|~(_first ~(_rest @lst_)_)|)_) ~(_bind @third &" lst()"(|~(_first ~(_rest ~(_rest @lst_)_)_)|)_) ~(_bind @fourth &" lst()"(|~(_first ~(_rest ~(_rest ~(_rest @lst_)_)_)_)|)_) ~(_bind @process &"() list()"(|~(|util:traverse-nexes-satisfying-and-do @list &"! item"(|~(_is-command @item_)|) &" item~"(|~(_eval @item_)|)|)|)_) ~(_bind @process-text &"() list()"(|~(|util:traverse-for-text @list &"! item"(|~(_is-command @item_)|) &" item~"(|~(_eval @item_)|)|)|)_) ~(_bind @traverse-for-text &" nex testf& dof&"(|~(_let @activate-if-exp &" nex"(|~(|if ~(_is-expectation @nex_) ~(_ff @nex_) @nex|)|)_) ~(|first-non-nil ~(_if ~(_testf @nex_) ~(_activate-if-exp ~(_dof @nex_)_)_) ~(_if ~(_not ~(_is-list @nex_)_) @nex_) ~(_if ~(_is-expectation @nex_) @nex_) ~(_if ~(_is-empty @nex_) @nex_) ~(_if !yes ~(|cons ~(_traverse-for-text ~(_first @nex_) @testf @dof_) ~(_traverse-for-text ~(_rest @nex_) @testf @dof_)|)_)|)|)_) ~(_bind @range-from-to &"() start# end#"(|~(|if ~(_::gt:: @start @end_) [word](__) ~(_cons @start ~(_range-from-to ~(_::pl:: @start #1_) @end_)_)|)|)_) ~(_bind @range &" limit#"(|~(_range-from-to #0 ~(_- @limit #1_)_)|)_) ~(_bind @do-for-each &" f& lst()"(|~(|if ~(_is-empty @lst_) [nil] ~(|begin ~(_let @t ~(_first @lst_)_) ~(_f @t_) ~(_do-for-each @f ~(_rest @lst_)_)|)|)|)_) ~(_bind @do-n-times &" f& n#"(|~(|if ~(_::gt:: @n #0_) ~(|begin ~(_f _) ~(_do-n-times @f ~(_- @n #1_)_)|)|)|)_) ~(_bind @reverse &"() lst()"(|~(|reduce-with-starting @lst &" item accum()"(|~(_cons @item @accum_)|) [word](__)|)|)_) ~(_bind @flatten &"() lst()"(|~(_let @recurse-flatten &" nex dlist()"(|~(|first-non-nil ~(_if ~(_not ~(_is-list @nex_)_) ~(_cram @nex @dlist_)_) ~(_if ~(_not ~(_is-empty @nex_)_) ~(|begin ~(_recurse-flatten ~(_rest @nex_) @dlist_) ~(_recurse-flatten ~(_first @nex_) @dlist_)|)_) [nil]|)|)_) ~(_let @r ~(_make-org _)_) ~(_recurse-flatten @lst @r_) @r|)_) ~(_bind @traverse-atoms-of-and-do &" nex f&"(|~(|first-non-nil ~(_if ~(_not ~(_is-list @nex_)_) ~(_f @nex_)_) ~(_if ~(_is-expectation @nex_) @nex_) ~(_if ~(_is-empty @nex_) @nex_) ~(_if !yes ~(|cons ~(_traverse-atoms-of-and-do ~(_first @nex_) @f_) ~(_traverse-atoms-of-and-do ~(_rest @nex_) @f_)|)_)|)|)_) ~(_bind @traverse-atoms-satisfying-and-do &" nex testf& dof&"(|~(|first-non-nil ~(_if ~(_not ~(_is-list @nex_)_) ~(|if ~(_testf @nex_) ~(_dof @nex_) @nex|)_) ~(_if ~(_is-expectation @nex_) @nex_) ~(_if ~(_is-empty @nex_) @nex_) ~(_if !yes ~(|cons ~(_traverse-atoms-satisfying-and-do ~(_first @nex_) @testf @dof_) ~(_traverse-atoms-satisfying-and-do ~(_rest @nex_) @testf @dof_)|)_)|)|)_) ~(_bind @traverse-nexes-satisfying-and-do &" nex testf& dof&"(|~(|first-non-nil ~(_if ~(_testf @nex_) ~(_dof @nex_)_) ~(_if ~(_not ~(_is-list @nex_)_) @nex_) ~(_if ~(_is-expectation @nex_) @nex_) ~(_if ~(_is-empty @nex_) @nex_) ~(_if !yes ~(|cons ~(_traverse-nexes-satisfying-and-do ~(_first @nex_) @testf @dof_) ~(_traverse-nexes-satisfying-and-do ~(_rest @nex_) @testf @dof_)|)_)|)|)_) ~(_bind @nth-from &" n# lst()"(|~(|if ~(_::eq:: @n #0_) ~(_car @lst_) ~(_nth-from ~(_- @n #1_) ~(_rest @lst_)_)|)|)_) ~(_bind @length-of &"# lst()"(|~(|reduce-with-starting @lst &" item accum#"(|~(_::pl:: @accum #1_)|) #0|)|)_) ~(_bind @list-cat &"() lst1() lst2()"(|~(|if ~(_is-empty @lst1_) ~(_copy @lst2_) ~(_cons ~(_first @lst1_) ~(_list-cat ~(_rest @lst1_) @lst2_)_)|)|)_) ~(_bind @put-contents-in &"() lst() dstlst()"(|~(_list-cat @lst @dstlst_)|)_) ~(_bind @contains-item-satisfying &"! lst() f&"(|~(|reduce-with-starting @lst &" item accum()"(|~(|if ~(_f @item_) !yes @accum|)|) !no|)|)_) ~(_bind @with-only-items-satisfying &"() lst() f&"(|~(_filter-with @list @f_)|)_) ~(_bind @lookup-key-in &" key table()"(|~(_let @reclookup &" temptable()"(|~(|if-then ~(_not ~(_is-empty @temptable_)_) ~(|begin ~(_let @entry ~(_first @temptable_)_) ~(_let @thiskey ~(_first @entry_)_) ~(_let @value ~(_first ~(_rest @entry_)_)_) ~(|if-then-else ~(_equal @key @thiskey_) @value ~(_reclookup ~(_rest @temptable_)_)|)|)|)|)_) ~(_reclookup @table_)|)_) ~(_bind @remove-all-entries-with-key-from &"() key table()"(|~(|reduce-with-starting @table &" item accum()"(|~(|if ~(_equal @key ~(_first @item_)_) @accum ~(_cons @item @accum_)|)|) [word](__)|)|)_) ~(_bind @add-key-value-to &" key value table()"(|~(_cons ~(_cons @key ~(_cons @value [word](__)_)_) @table_)|)_) ~(_bind @key-is-in &"! key table()"(|~(_contains-item-satisfying @table &" entry"(|~(_equal @key ~(_first @entry_)_)|)_)|)_)|)v2:~(|package @vector ~(_bind @add-3d &" vecs..."(|~(_reduce-with-starting @vecs &" vec accum"(|~(_@<`add`>accum @vec_)|) ~(_instantiate [nil]<`Vector3d`> %0 %0 %0_)_)|)_) ~(_template [nil]<`Vector3d`> (|%<`y`>0 %<`x`>0 %<`z`>0 &" newx%"(|<`set-x`>~(_set @<`x`>self @newx_)|) &" newy%"(|<`set-y`>~(_set @<`y`>self @newy_)|) &" newz%"(|<`set-z`>~(_set @<`z`>self @newz_)|) &(|<`magnitude`>~(_square-root ~(|::pl:: ~(_power @<`x`>self %2_) ~(_power @<`y`>self %2_) ~(_power @<`z`>self %2_)|)_)|) &" x y z"(|<`:init`>~(_@<`set-x`>self @x_) ~(_@<`set-y`>self @y_) ~(_@<`set-z`>self @z_)|) &" vec"(|<`add`>~(_let @sumx ~(_::pl:: @<`x`>vec @<`x`>self_)_) ~(_let @sumy ~(_::pl:: @<`y`>vec @<`y`>self_)_) ~(_let @sumz ~(_::pl:: @<`z`>vec @<`z`>self_)_) ~(_instantiate [nil]<`Vector3d`> @sumx @sumy @sumz_)|) &" s%"(|<`scale`>~(|instantiate [nil]<`Vector3d`> ~(_::ti:: @<`x`>self @s_) ~(_::ti:: @<`y`>self @s_) ~(_::ti:: @<`z`>self @s_)|)|)|)_) ~(_template [nil]<`Vector`> (|%<`y`>0 %<`x`>0 &" newx%"(|<`set-x`>~(_set @<`x`>self @newx_)|) &" newy%"(|<`set-y`>~(_set @<`y`>self @newy_)|) &" theta%"(|<`rotate`>~(_let @newx ~(_- ~(_::ti:: @<`x`>self ~(_cos @theta_)_) ~(_::ti:: @<`y`>self ~(_sin @theta_)_)_)_) ~(_let @newy ~(_::pl:: ~(_::ti:: @<`x`>self ~(_sin @theta_)_) ~(_::ti:: @<`y`>self ~(_cos @theta_)_)_)_) ~(_instantiate [nil]<`Vector`> @newx @newy_)|) &" vec"(|<`add`>~(_let @sumx ~(_::pl:: @<`x`>vec @<`x`>self_)_) ~(_let @sumy ~(_::pl:: @<`y`>vec @<`y`>self_)_) ~(_instantiate [nil]<`Vector`> @sumx @sumy_)|) &(|<`magnitude`>~(_square-root ~(_::pl:: ~(_power @<`x`>self %2_) ~(_power @<`y`>self %2_)_)_)|) &" x y"(|<`:init`>~(_@<`set-x`>self @x_) ~(_@<`set-y`>self @y_)|)|)_)|)v2:~(|package @writing ~(_import @style-functions_) ~(_import @util-functions_) ~(_bind @cycle &" list()"(|~(_let @n ~(_random-from-to #1000 #3000_)_) ~(_cycle-every @list @n_)|)_) ~(_bind @cycle-every &" list() interval#"(|~(_let @len ~(_util:length-of @list_)_) ~(_do-on-every-with-param &" n p"(|~(_let @index ~(_modulo @p @len_)_) ~(_util:nth-from @index @list_)|) ~(_car @list_) @interval_)|)_) ~(_bind @random-item-from &" lst()"(|~(_let @length ~(_util:length-of @lst_)_) ~(_let @n ~(_to-integer ~(_::ti:: @length ~(_random _)_)_)_) ~(_util:nth-from @n @lst_)|)_) ~(_bind @flicker &"* nex"(|~(|do-on-every &" n"(|~(_let @r ~(_random _)_) ~(_let @opacity ~(|if ~(_::gt:: @r %0.45_) %1 ~(|if ~(_::gt:: @r %0.15_) %0.75 %0.2|)|)_) ~(_style:with-alpha-of @n @opacity_)|) @nex #100|)|)_) ~(_bind @bottom-mask-nex-by &" n amount%"(|~(_let @nexheight ~(_get-pixel-height @n_)_) ~(_let @nexwidth ~(_get-pixel-width @n_)_) ~(_let @maskheight ~(_::ti:: @amount @nexheight_)_) ~(_let @mask ~(|style:with-y-offset-of ~(|style:with-background-color-of ~(|style:with-height-of ~(_style:with-width-of [word](__) @nexwidth_) @maskheight|) $"#ffffff"|) ~(_- @nexheight @maskheight_)|)_) ~(_cons @n ~(_cons @mask ~(_make-zlist _)_)_)|)_) ~(_bind @top-mask-nex-by &" n amount%"(|~(_let @nexheight ~(_get-pixel-height @n_)_) ~(_let @nexwidth ~(_get-pixel-width @n_)_) ~(_let @maskheight ~(_::ti:: @amount @nexheight_)_) ~(_let @mask ~(|style:with-background-color-of ~(|style:with-height-of ~(_style:with-width-of [word](__) @nexwidth_) @maskheight|) $"#ffffff"|)_) ~(_cons @n ~(_cons @mask ~(_make-zlist _)_)_)|)_) ~(_bind @vertical-wipe &" nex newfgcolor$ newbgcolor$"(|~(_let @nexheight ~(_get-pixel-height @nex_)_) ~(_let @nexwidth ~(_get-pixel-width @nex_)_) ~(_let @container ~(_style:with-height-of ~(_style:with-width-of [word](__) @nexwidth_) @nexheight_)_) ~(_let @newnex ~(|style:with-text-in-color ~(|style:with-background-color-of ~(_copy @nex_) @newbgcolor|) @newfgcolor|)_) ~(_cons @newnex ~(_cons @nex @container_)_)|)_) ~(_bind @with-random-x-y &" nex width#% height#%"(|~(_let @x ~(_random-from-to #0 @width_)_) ~(_let @y ~(_random-from-to #0 @height_)_) ~(_style:with-left-padding-of ~(_style:with-top-padding-of @nex @y_) @x_)|)_)|)